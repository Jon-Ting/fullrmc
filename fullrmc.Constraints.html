<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fullrmc.Constraints package &mdash; fullrmc 3.1.0, the Reverse Monte Carlo (RMC) package</title>
    
    <link rel="stylesheet" href="_static/fullrmc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            <link rel="author" title="About these documents" href="about.html" />
            <link rel="top" title="fullrmc 3.1.0, the Reverse Monte Carlo (RMC) package" href="index.html" />
            <link rel="prev" title="fullrmc.Generators package" href="fullrmc.Generators.html" />
    
    <!-- -------------------------------------------------------------------------- -->
    <!-- ----- ADD a Mathjax CONFIGURATION SCRIPT TO EACH HTML FILE PRODUCED ------ -->
    <!-- ----- BY SPHINX. THEREFORE \AA WILL BE RENDERED AS Angstrom SYMBOL. ------ -->
        <script type="text/x-mathjax-config"> MathJax.Hub.Config({
        "TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 100}});
        </script>
    
    </head>
  
    <body>
        <!-- ------------------------------------- -->
        <!-- ----- CREATE A STATIC MENU BAR ------ -->
        <div class="menu"> 
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="versions.html">Versions</a></li>
                <li><a href="QAForum.html">Q&A Forum</a></li>
                <li><a href="fullrmc.Selectors.html">Selectors</a></li>
                <li><a href="fullrmc.Generators.html">Generators</a></li>
                <li><a href="fullrmc.Constraints.html">Constraints</a></li>
                <li><a href="examples.html">Examples</a></li>
                <li><a href="about.html">About</a></li>
                <!-- pypi and github forkme link images table -->
                <li> 
                    <table style="position: absolute; right:0; top:0;">
                        <!-- pypi image -->
                        <td><a href="https://pypi.python.org/pypi/fullrmc">
                            <img height="40";
                                 src="_static/pypi.png"
                                 alt="Download me on PyPI"/>   
                        </a></td> 
                        <!-- github image -->
                        <td><a href="https://github.com/bachiraoun/fullrmc.git">
                            <img height="40";
                                 src="_static/forkme.png"
                                 alt="Fork me on GitHub" />   
                        </a></td>
                    </table>
                </li>
                <!-- ------------------------------------- -->
            </ul>
            <div class="clear"></div>
        </div>
        <!----------  STATIC MENU BAR STYLE --------->    
        <style>
        .menu { height: 42px; background-color:black; margin:0px;  
                z-index: 9999; position:Fixed;
                left: 0; top: 0; width: 100%; }
            .menu ul { list-style: none; }
            .menu ul li{float: left; padding-left: 6px;  padding-right: 6px;  border-right: 1px solid #ACACAC;}
            .menu ul li a { font-size:16px; color:white;}
            .menu ul li a:hover{ text-decoration: underline;}
        </style>
        <!-- ------ ENF OF MENU BAR CREATION ----- -->
        <!-- ------------------------------------- -->
        
        <div style="margin-top:40px"> </div>  
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a>
             |
        
        </li>
        <li class="right" >
          <a href="fullrmc.Generators.html" title="fullrmc.Generators package"
             accesskey="P">previous</a>
             |
        
        </li>
        <li><a href="index.html">fullrmc 3.1.0, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
         
         
        
        
        <div class="document">
        <div class="documentwrapper">
            <div class="bodywrapper">
        <div class="body">
        
  <p>Constraint contains parent classes for all constraints.
A Constraint is used to set certain rules to evolve the configuration.
Therefore it has become possible to fully customize and set any possibly imaginable rule.</p>
<img src="_images/inheritance-b26fffd3b3a3d9adf6096c3a78b27bfcd051fe94.png" alt="Inheritance diagram of fullrmc.Core.Constraint" usemap="#inheritance1864cca696" class="inheritance"/>
<map id="inheritance1864cca696" name="inheritance1864cca696">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,53,235,77"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" target="_top" title="An ExperimentalConstraint is any constraint related to experimental data." alt="" coords="283,5,443,29"/>
<area shape="rect" id="node5" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" target="_top" title="A rigid constraint is a constraint that doesn&#39;t count into the total standardError of the Engine." alt="" coords="306,53,419,77"/>
<area shape="rect" id="node6" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" target="_top" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="297,101,428,125"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,53,104,77"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.QuasiRigidConstraint" target="_top" title="A quasi&#45;rigid constraint is a another rigid constraint but it becomes free above a certain threshold" alt="" coords="491,53,638,77"/>
</map>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">fullrmc.Core.Constraint.</code><code class="descname">Constraint</code></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" title="fullrmc.Core.Collection.ListenerBase"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Collection.ListenerBase</span></code></a></p>
<p>A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one.</p>
<dl class="attribute">
<dt>
<code class="descname">constraintId</code></dt>
<dd><p>Get constraints unique id.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">engine</code></dt>
<dd><p>Get the engine fullrmc instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">computationCost</code></dt>
<dd><p>Get computation cost number.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">state</code></dt>
<dd><p>Get constraint&#8217;s state.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tried</code></dt>
<dd><p>Get constraint&#8217;s number of tried moves.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">accepted</code></dt>
<dd><p>Get constraint&#8217;s number of accepted moves.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">used</code></dt>
<dd><p>Get whether this constraint is used in the engine run time or set inactive.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">varianceSquared</code></dt>
<dd><p>Get constraint&#8217;s varianceSquared used in the engine run time to calculate the total chi square.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">standardError</code></dt>
<dd><p>Get constraint&#8217;s current standard error.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">originalData</code></dt>
<dd><p>Get constraint&#8217;s original calculated data upon initialization.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">data</code></dt>
<dd><p>Get constraint&#8217;s current calculated data.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">activeAtomsDataBeforeMove</code></dt>
<dd><p>Get constraint&#8217;s current calculated data before last move.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">activeAtomsDataAfterMove</code></dt>
<dd><p>Get constraint&#8217;s current calculated data after last move.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">afterMoveStandardError</code></dt>
<dd><p>Get constraint&#8217;s current calculated StandardError after last move.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">amputationData</code></dt>
<dd><p>Get constraint&#8217;s current calculated data after amputation.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">amputationStandardError</code></dt>
<dd><p>Get constraint&#8217;s current calculated StandardError after amputation.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_variance_squared</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s variance squared that is used in the computation of the total engine chi square.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): Any positive non zero number.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_computation_cost</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s computation cost value. This is used at engine runtime 
to minimize computations and enhance performance by computing less costly
constraints first. At every step, constraints will be computed in order 
starting from the less to the most computationally costly. Therefore
upon rejection of a step because of an unsatisfactory rigid constraint, 
the left un-computed constraints at this step are guaranteed to be the        
most costly ones.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): Any number.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_used</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Sets used flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (boolean): True to use this constraint in engine run time.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_state</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s state. 
When constraint&#8217;s state and engine&#8217;s state don&#8217;t match, constraint&#8217;s data must be recalculated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (object): constraint state value</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_tried</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s engine tried moves.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (integer): constraint tried moves value</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">increment_tried</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Increment engine tried moves.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_accepted</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s engine accepted moves.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (integer): constraint accepted moves value</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">increment_accepted</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Increment engine accepted moves.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_standard_error</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s standardError value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): standardError value</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_data</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s data value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): standardError value.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_active_atoms_data_before_move</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s before move happens active atoms data value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): data value</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_active_atoms_data_after_move</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s after move happens active atoms data value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): data value</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_after_move_standard_error</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s standardError value after move happens.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): standardError value.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_amputation_data</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s after amputation data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): data value</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_amputation_standard_error</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span></dt>
<dd><p>Sets constraint&#8217;s standardError after amputation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>value (number): standardError value.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">reset_constraint</code><span class="sig-paren">(</span><em>reinitialize=True</em>, <em>flags=False</em>, <em>data=False</em><span class="sig-paren">)</span></dt>
<dd><p>Resets constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>reinitialize (boolean): If set to True, it will override the rest of the flags 
and will completely reinitialize the constraint.</li>
<li>flags (boolean): Reset the state, tried and accepted flags of the constraint.</li>
<li>data (boolean): Reset the constraints computed data.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_and_set_standard_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Computes and sets the constraint&#8217;s standardError by calling compute_standard_error and passing the constraint&#8217;s data.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">get_constraint_original_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_as_if_amputated</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_as_if_inserted</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">accept_insertion</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">reject_insertion</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">export</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">fullrmc.Core.Constraint.</code><code class="descname">ExperimentalConstraint</code><span class="sig-paren">(</span><em>experimentalData</em>, <em>dataWeights=None</em>, <em>scaleFactor=1.0</em>, <em>adjustScaleFactor=(0</em>, <em>0.8</em>, <em>1.2)</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="fullrmc.Core.Constraint.Constraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.Constraint</span></code></a></p>
<p>An ExperimentalConstraint is any constraint related to experimental data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">engine (None, fullrmc.Engine): The constraint RMC engine.</p>
</li>
<li><p class="first">experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</p>
</li>
<li><p class="first">dataWeights (None, numpy.ndarray): A weights array of the same number of points of experimentalData used in the constraint&#8217;s standard error computation.
Therefore particular fitting emphasis can be put on different data points that might be considered as more or less
important in order to get a reasonable and plausible modal.</p>
<p>If None is given, all data points are considered of the same importance in the computation of the constraint&#8217;s standard error.</p>
<p>If numpy.ndarray is given, all weights must be positive and all zeros weighted data points won&#8217;t contribute to the 
total constraint&#8217;s standard error. At least a single weight point is required to be non-zeros and the weights 
array will be automatically scaled upon setting such as the the sum of all the weights is equal to the number of data points.</p>
</li>
<li><p class="first">scaleFactor (number): A scaling constant multiplying the computed data to normalize to the experimental ones.</p>
</li>
<li><p class="first">adjustScaleFactor (list, tuple): Used to adjust fit or guess the best scale factor during EMC runtime. 
It must be a list of exactly three entries.</p>
<ol class="arabic simple">
<li>The frequency in number of accepted moves of finding the best scale factor. 
If 0 frequency is given, it means that the scale factor is fixed.</li>
<li>The minimum allowed scale factor value.</li>
<li>The maximum allowed scale factor value.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p><strong>NB</strong>: If adjustScaleFactor first item (frequency) is 0, the scale factor will remain 
untouched and the limits minimum and maximum won&#8217;t be checked.</p>
<dl class="attribute">
<dt>
<code class="descname">experimentalData</code></dt>
<dd><p>Gets the experimental data of the constraint.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">dataWeights</code></dt>
<dd><p>Get experimental data points weight</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">scaleFactor</code></dt>
<dd><p>Get the scaleFactor.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">adjustScaleFactor</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">adjustScaleFactorFrequency</code></dt>
<dd><p>Get the scaleFactor adjustment frequency.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">adjustScaleFactorMinimum</code></dt>
<dd><p>Get the scaleFactor adjustment minimum number allowed.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">adjustScaleFactorMaximum</code></dt>
<dd><p>Get the scaleFactor adjustment maximum number allowed.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_scale_factor</code><span class="sig-paren">(</span><em>scaleFactor</em><span class="sig-paren">)</span></dt>
<dd><p>Sets the scale factor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>scaleFactor (number): A normalization scale factor used to normalize the computed data to the experimental ones.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_adjust_scale_factor</code><span class="sig-paren">(</span><em>adjustScaleFactor</em><span class="sig-paren">)</span></dt>
<dd><p>Sets adjust scale factor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>adjustScaleFactor (list, tuple): Used to adjust fit or guess the best scale factor during EMC runtime. 
It must be a list of exactly three entries.<ol class="arabic">
<li>The frequency in number of accepted moves of finding the best scale factor. 
If 0 frequency is given, it means that the scale factor is fixed.</li>
<li>The minimum allowed scale factor value.</li>
<li>The maximum allowed scale factor value.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_experimental_data</code><span class="sig-paren">(</span><em>experimentalData</em><span class="sig-paren">)</span></dt>
<dd><p>Sets the constraint&#8217;s experimental data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_data_weights</code><span class="sig-paren">(</span><em>dataWeights</em><span class="sig-paren">)</span></dt>
<dd><p>Set experimental data points weight.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">dataWeights (None, numpy.ndarray): A weights array of the same number of points of experimentalData used in the constraint&#8217;s standard error computation.
Therefore particular fitting emphasis can be put on different data points that might be considered as more or less
important in order to get a reasonable and plausible modal.</p>
<p>If None is given, all data points are considered of the same importance in the computation of the constraint&#8217;s standard error.</p>
<p>If numpy.ndarray is given, all weights must be positive and all zeros weighted data points won&#8217;t contribute to the 
total constraint&#8217;s standard error. At least a single weight point is required to be non-zeros and the weights 
array will be automatically scaled upon setting such as the the sum of all the weights is equal to the number of data points.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">check_experimental_data</code><span class="sig-paren">(</span><em>experimentalData</em><span class="sig-paren">)</span></dt>
<dd><p>Checks the constraint&#8217;s experimental data
This method must be overloaded in all ExperimentalConstraint sub-classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>experimentalData (numpy.ndarray): the experimental data numpy.ndarray.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">fit_scale_factor</code><span class="sig-paren">(</span><em>experimentalData</em>, <em>modelData</em>, <em>dataWeights</em><span class="sig-paren">)</span></dt>
<dd><p>The best scale factor value is computed by minimizing <span class="math">\(E=sM\)</span>.</p>
<dl class="docutils">
<dt>Where:</dt>
<dd><ol class="first last arabic simple">
<li><span class="math">\(E\)</span> is the experimental data.</li>
<li><span class="math">\(s\)</span> is the scale factor.</li>
<li><span class="math">\(M\)</span> is the model constraint data.</li>
</ol>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>experimentalData (numpy.ndarray): the experimental data.</li>
<li>modelData (numpy.ndarray): the constraint modal data.</li>
<li>dataWeights (None, numpy.ndarray): the data points weights to compute the scale factor.
If None, all data points will be considered as having the same weight.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>scaleFactor (number): The new scale factor fit value.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p><strong>NB</strong>: This method won&#8217;t update the internal scale factor value of the constraint.
It always computes the best scale factor given some experimental and model data</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_adjusted_scale_factor</code><span class="sig-paren">(</span><em>experimentalData</em>, <em>modelData</em>, <em>dataWeights</em><span class="sig-paren">)</span></dt>
<dd><p>Checks if scale factor should be updated according to the given scale factor frequency
and engine&#8217;s accepted steps. If adjustment is due, a new scale factor will be computed  
using fit_scale_factor method, otherwise the the constraint&#8217;s scale factor will be returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>experimentalData (numpy.ndarray): the experimental data.</li>
<li>modelData (numpy.ndarray): the constraint modal data.</li>
<li>dataWeights (None, numpy.ndarray): the data points weights to compute the scale factor.
If None, all data points will be considered as having the same weight.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>scaleFactor (number): The constraint&#8217;s scale factor or the new scale factor fit value.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p><strong>NB</strong>: This method WILL NOT UPDATE the internal scale factor value of the constraint.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>experimentalData</em>, <em>modelData</em><span class="sig-paren">)</span></dt>
<dd><p>Compute the squared deviation between modal computed data and the experimental ones.</p>
<div class="math">
\[SD = \sum \limits_{i}^{N} W_{i}(Y(X_{i})-F(X_{i}))^{2}\]</div>
<p>Where:</p>
<p><span class="math">\(N\)</span> is the total number of experimental data points.</p>
<p><span class="math">\(W_{i}\)</span> is the data point weight. It becomes equivalent to 1 when dataWeights is set to None.</p>
<p><span class="math">\(Y(X_{i})\)</span> is the experimental data point <span class="math">\(X_{i}\)</span>.</p>
<p><span class="math">\(F(X_{i})\)</span> is the computed from the model data  <span class="math">\(X_{i}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>experimentalData (numpy.ndarray): the experimental data.</li>
<li>modelData (numpy.ndarray): The data to compare with the experimental one and compute the squared deviation.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">fullrmc.Core.Constraint.</code><code class="descname">SingularConstraint</code></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="fullrmc.Core.Constraint.Constraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.Constraint</span></code></a></p>
<p>A singular constraint is a constraint that doesn&#8217;t allow multiple instances in the same engine.</p>
<dl class="method">
<dt>
<code class="descname">is_singular</code><span class="sig-paren">(</span><em>engine</em><span class="sig-paren">)</span></dt>
<dd><p>Get whether only one instance of this constraint type is present in the engine.
True for only itself found, False for other instance of the same __class__.__name__</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">assert_singular</code><span class="sig-paren">(</span><em>engine</em><span class="sig-paren">)</span></dt>
<dd><p>Checks whether only one instance of this constraint type is present in the engine.
Raises Exception if multiple instances are present.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">fullrmc.Core.Constraint.</code><code class="descname">RigidConstraint</code><span class="sig-paren">(</span><em>rejectProbability</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="fullrmc.Core.Constraint.Constraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.Constraint</span></code></a></p>
<p>A rigid constraint is a constraint that doesn&#8217;t count into the total standardError of the Engine.
But it&#8217;s internal standardError must monotonously decrease or remain the same from one engine step to another.
If standardError of an RigidConstraint increases the step will be rejected even before engine&#8217;s new standardError get computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>engine (None, fullrmc.Engine): The constraint fullrmc engine.</li>
<li>rejectProbability (Number): Rejecting probability of all steps where standardError increases. 
It must be between 0 and 1 where 1 means rejecting all steps where standardError increases
and 0 means accepting all steps regardless whether standardError increases or not.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<code class="descname">rejectProbability</code></dt>
<dd><p>Get rejection probability.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_reject_probability</code><span class="sig-paren">(</span><em>rejectProbability</em><span class="sig-paren">)</span></dt>
<dd><p>Set the rejection probability.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>rejectProbability (Number): rejecting probability of all steps where standardError increases. 
It must be between 0 and 1 where 1 means rejecting all steps where standardError increases
and 0 means accepting all steps regardless whether standardError increases or not.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">should_step_get_rejected</code><span class="sig-paren">(</span><em>standardError</em><span class="sig-paren">)</span></dt>
<dd><p>Given a standardError, return whether to keep or reject new standardError according to the constraint rejectProbability.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>standardError (number): The standardError to compare with the Constraint standardError</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): True to reject step, False to accept</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">should_step_get_accepted</code><span class="sig-paren">(</span><em>standardError</em><span class="sig-paren">)</span></dt>
<dd><p>Given a standardError, return whether to keep or reject new standardError according to the constraint rejectProbability.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>standardError (number): The standardError to compare with the Constraint standardError</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): True to accept step, False to reject</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">fullrmc.Core.Constraint.</code><code class="descname">QuasiRigidConstraint</code><span class="sig-paren">(</span><em>engine</em>, <em>rejectProbability</em>, <em>thresholdRatio</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></code></a></p>
<p>A quasi-rigid constraint is a another rigid constraint but it becomes free above a certain threshold
ratio of satisfied data. Every quasi-rigid constraint has its own definition of maximum standard 
error. The ratio is computed as between current standard error and maximum standard error.</p>
<blockquote>
<div><div class="math">
\[ratio = 1-\frac{current\ standard\ error}{maximum\ standard\ error} \]</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>engine (None, fullrmc.Engine): The constraint fullrmc engine.</li>
<li>rejectProbability (Number): Rejecting probability of all steps where standardError increases
only before threshold ratio is reached. 
It must be between 0 and 1 where 1 means rejecting all steps where standardError increases
and 0 means accepting all steps regardless whether standardError increases or not.</li>
<li>thresholdRatio(Number): The threshold of satisfied data, above which the constraint become free.
It must be between 0 and 1 where 1 means all data must be satisfied and therefore the constraint
behave like a RigidConstraint and 0 means none of the data must be satisfied and therefore the
constraint becomes always free and useless.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<code class="descname">thresholdRatio</code></dt>
<dd><p>Get threshold ratio.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">currentRatio</code></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">set_threshold_ratio</code><span class="sig-paren">(</span><em>thresholdRatio</em><span class="sig-paren">)</span></dt>
<dd><p>Set the rejection probability function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>thresholdRatio(Number): The threshold of satisfied data, above which the constraint become free.
It must be between 0 and 1 where 1 means all data must be satisfied and therefore the constraint
behave like a RigidConstraint and 0 means none of the data must be satisfied and therefore the
constraint becomes always free and useless.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">should_step_get_rejected</code><span class="sig-paren">(</span><em>standardError</em><span class="sig-paren">)</span></dt>
<dd><p>Given a standardError, return whether to keep or reject new standardError according to the constraint rejectProbability function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>standardError (number): The standardError to compare with the Constraint standardError</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): True to reject step, False to accept</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">fullrmc.Core.Constraint.</code><code class="descname">randfloat</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>random() -&gt; x in the interval [0, 1).</p>
</dd></dl>

<div class="section" id="fullrmc-constraints-package">
<h1>fullrmc.Constraints package<a class="headerlink" href="#fullrmc-constraints-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-fullrmc.Constraints.Collection">
<span id="collection"></span><h2>Collection<a class="headerlink" href="#module-fullrmc.Constraints.Collection" title="Permalink to this headline">¶</a></h2>
<p>Collection of methods and classes definition useful for constraints computation</p>
<dl class="class">
<dt id="fullrmc.Constraints.Collection.ShapeFunction">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.Collection.</code><code class="descname">ShapeFunction</code><span class="sig-paren">(</span><em>engine</em>, <em>weighting='atomicNumber'</em>, <em>qmin=0.001</em>, <em>qmax=1</em>, <em>dq=0.005</em>, <em>rmin=0.0</em>, <em>rmax=100</em>, <em>dr=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.Collection.ShapeFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Shape function used to correct for particle shape. The shape 
function is subtracted from the total G(r) of g(r). It must 
be used when non-periodic boundary conditions are used to take 
into account the atomic density drop and to correct for the 
<span class="math">\(\rho_{0}\)</span> approximation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>engine (Engine): The fitting engine.</li>
<li>weighting (string): The elements weighting.</li>
<li>qmin (number): The minimum reciprocal distance q in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li>qmax (number): The maximum reciprocal distance q in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li>dq (number): The reciprocal distance bin size in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li>rmin (number): The minimum distance in <span class="math">\(\AA\)</span> considered 
upon building the histogram prior to computing the shape function.</li>
<li>rmax (number): The maximum distance in <span class="math">\(\AA\)</span> 
considered upon building the histogram prior to computing the shape function.</li>
<li>dr (number): The bin size in <span class="math">\(\AA\)</span> considered upon 
building the histogram prior to computing the shape function.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p><strong>N.B: tweak qmax as small as possible to reduce the wriggles ...</strong></p>
<dl class="method">
<dt id="fullrmc.Constraints.Collection.ShapeFunction.get_Gr_shape_function">
<code class="descname">get_Gr_shape_function</code><span class="sig-paren">(</span><em>rValues</em>, <em>compute=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.Collection.ShapeFunction.get_Gr_shape_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Get shape function of G(r) used in a PairDistributionConstraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>rValues (numpy.ndarray): The r values array.</li>
<li>compute (boolean): whether to recompute shape 
function reciprocal data.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>shapeFunction (numpy.ndarray): The compute shape function.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.Collection.ShapeFunction.get_gr_shape_function">
<code class="descname">get_gr_shape_function</code><span class="sig-paren">(</span><em>rValues</em>, <em>compute=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.Collection.ShapeFunction.get_gr_shape_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Get shape function of g(r) used in a PairCorrelationConstraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>rValues (numpy.ndarray): The r values array.</li>
<li>compute (boolean): whether to recompute shape 
function reciprocal data.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>shapeFunction (numpy.ndarray): The compute shape function.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.DistanceConstraints">
<span id="distanceconstraints"></span><h2>DistanceConstraints<a class="headerlink" href="#module-fullrmc.Constraints.DistanceConstraints" title="Permalink to this headline">¶</a></h2>
<p>DistanceConstraints contains classes for all constraints related distances between atoms.</p>
<img src="_images/inheritance-b934a8e71fdcf42645e570e8c16b733334543051.png" alt="Inheritance diagram of fullrmc.Constraints.DistanceConstraints" usemap="#inheritancedfc0fe7ea3" class="inheritance"/>
<map id="inheritancedfc0fe7ea3" name="inheritancedfc0fe7ea3">
<area shape="rect" id="node1" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint" target="_top" title="Its controls the inter&#45;molecular distances between atoms." alt="" coords="5,53,224,77"/>
<area shape="rect" id="node2" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint" target="_top" title=".. py:class::IntraMolecularDistanceConstraint" alt="" coords="5,5,224,29"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.DistanceConstraints.</code><code class="descname">InterMolecularDistanceConstraint</code><span class="sig-paren">(</span><em>defaultDistance=1.5</em>, <em>typeDefinition='element'</em>, <em>pairsDistanceDefinition=None</em>, <em>flexible=True</em>, <em>rejectProbability=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">fullrmc.Constraints.DistanceConstraints._MolecularDistanceConstraint</span></code></p>
<p>Its controls the inter-molecular distances between atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">defaultDistance (number): The minimum distance allowed set by default for all 
atoms type.</p>
</li>
<li><p class="first">typeDefinition (string): Can be either &#8216;element&#8217; or &#8216;name&#8217;. It sets the rules 
about how to differentiate between atoms and how to parse pairsLimits.</p>
</li>
<li><p class="first">pairsDistanceDefinition (None, list, set, tuple): The minimum distance set to 
every pair of elements. 
A list of tuples must be given, all missing pairs will get automatically 
assigned the given defaultMinimumDistance value.
First defined elements pair distance will cancel all redundant. 
If None is given all pairs will be automatically generated and assigned the 
given defaultMinimumDistance value .</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">[(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mf">2.015</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span> 
</pre></div>
</div>
</li>
<li><p class="first">flexible (boolean): Whether to allow atoms to break constraint&#8217;s definition 
under the condition of decreasing total standardError of the constraint. 
If flexible is set to False, atoms will never be allowed to cross from above 
to below minimum allowed distance. Even if the later will decrease some other 
unsatisfying atoms distances, and therefore the total standardError of the 
constraint.</p>
</li>
<li><p class="first">rejectProbability (Number): rejecting probability of all steps where 
standardError increases. It must be between 0 and 1 where 1 means 
rejecting all steps where standardError increases and 0 means accepting 
all steps regardless whether standardError increases or not.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.DistanceConstraints</span> <span class="kn">import</span> <span class="n">InterMolecularDistanceConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">EMD</span> <span class="o">=</span> <span class="n">InterMolecularDistanceConstraint</span><span class="p">()</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">EMD</span><span class="p">)</span>

<span class="c1"># create definition</span>
<span class="n">EMD</span><span class="o">.</span><span class="n">set_pairs_distance</span><span class="p">([(</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span><span class="mf">1.75</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="mf">1.10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="mf">1.30</span><span class="p">)])</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.defaultDistance">
<code class="descname">defaultDistance</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.defaultDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances minimum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.pairsDistanceDefinition">
<code class="descname">pairsDistanceDefinition</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.pairsDistanceDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.pairsDistance">
<code class="descname">pairsDistance</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.pairsDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.flexible">
<code class="descname">flexible</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.flexible" title="Permalink to this definition">¶</a></dt>
<dd><p>Get flexible flag</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.lowerLimitArray">
<code class="descname">lowerLimitArray</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.lowerLimitArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lowerLimitArray used in distances calculation.
for InterMolecularDistanceConstraint it&#8217;s always a numpy.zeros array</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.upperLimitArray">
<code class="descname">upperLimitArray</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.upperLimitArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Get upperLimitArray used in distances calculation.
for InterMolecularDistanceConstraint it&#8217;s the minimum distance allowed between pair of intermolecular atoms</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.typePairs">
<code class="descname">typePairs</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.typePairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Atoms type pairs sorted list</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.typeDefinition">
<code class="descname">typeDefinition</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.typeDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>atoms type definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.types">
<code class="descname">types</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.types" title="Permalink to this definition">¶</a></dt>
<dd><p>Defined atom types set.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.allTypes">
<code class="descname">allTypes</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.allTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>All atom types.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.numberOfTypes">
<code class="descname">numberOfTypes</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.numberOfTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of defined atom types in the configuration.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.typeIndexes">
<code class="descname">typeIndexes</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.typeIndexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Type indexes list.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.numberOfAtomsPerType">
<code class="descname">numberOfAtomsPerType</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.numberOfAtomsPerType" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of atoms per type dict.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>listen to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_flexible">
<code class="descname">set_flexible</code><span class="sig-paren">(</span><em>flexible</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_flexible" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets flexible flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>flexible (boolean): Whether to allow atoms to break constraints definition 
under the condition of decreasing total standardError. If flexible is 
set to False, atoms will never be allowed to cross from above to below 
minimum allowed distance. Even if the later will decrease some other 
unsatisfying atoms distances, and therefore the total standardError 
of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_default_distance">
<code class="descname">set_default_distance</code><span class="sig-paren">(</span><em>defaultDistance</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_default_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the default intermolecular minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>defaultDistance (number): The default minimum distance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_type_definition">
<code class="descname">set_type_definition</code><span class="sig-paren">(</span><em>typeDefinition</em>, <em>pairsDistanceDefinition=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_type_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Its an alias to set_pairs_distance used when typeDefinition needs to be re-defined.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>typeDefinition (string): Can be either &#8216;element&#8217; or &#8216;name&#8217;. It sets the rules about how to differentiate between atoms and how to parse pairsLimits.</li>
<li>pairsDistanceDefinition (None, list, set, tuple): The minimum distance set to every pair of elements. 
If None is given the already defined pairsDistanceDefinition will be used and passed to set_pairs_distance method.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_pairs_distance">
<code class="descname">set_pairs_distance</code><span class="sig-paren">(</span><em>pairsDistanceDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_pairs_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the pairs intermolecular minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">pairsDistanceDefinition (None, list, set, tuple): The minimum distance set to every pair of elements. 
A list of tuples must be given, all missing pairs will get automatically assigned the given defaultMinimumDistance value.
First defined elements pair distance will cancel all redundant. 
If None is given all pairs will be automatically generated and assigned the given defaultMinimumDistance value</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">[(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mf">2.015</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span> 
</pre></div>
</div>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.should_step_get_rejected">
<code class="descname">should_step_get_rejected</code><span class="sig-paren">(</span><em>standardError</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.should_step_get_rejected" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a standardError, return whether to keep or reject new standardError 
according to the constraint rejectProbability.
In addition, if flexible flag is set to True, total number of atoms not satisfying 
constraints definition must be decreasing or at least remain the same.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>standardError (number): The standardError to compare with the Constraint standardError</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): True to reject step, False to accept</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (stdErr) of data not satisfying constraint conditions.</p>
<div class="math">
\[stdErr = \sum \limits_{i}^{N} \sum \limits_{i+1}^{N} 
\left| d_{ij}-D_{ij}) \right| 
\int_{0}^{D_{ij}} \delta(x-d_{ij}) dx \]</div>
<p>Where:</p>
<p><span class="math">\(N\)</span> is the total number of atoms in the system.</p>
<p><span class="math">\(D_{ij}\)</span> is the distance constraint set for atoms pair (i,j).</p>
<p><span class="math">\(d_{ij}\)</span> is the distance between atom i and atom j.</p>
<p><span class="math">\(\delta\)</span> is the Dirac delta function.</p>
<p><span class="math">\(\int_{0}^{D_{ij}} \delta(x-d_{ij}) dx\)</span> 
is equal to 1 if <span class="math">\(0 \leqslant d_{ij} \leqslant D_{ij}\)</span> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (dict): The constraint value data returned using 
get_constraint_value.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_as_if_amputated">
<code class="descname">compute_as_if_amputated</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_as_if_amputated" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return constraint&#8217;s data and standard error as if atom given its 
its was amputated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputation of atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputation of atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>width=0.6</em>, <em>correctColor='#0066ff'</em>, <em>erroneousColor='#d62728'</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=1</em>, <em>legendLoc='best'</em>, <em>legendText=('correct'</em>, <em>'erroneous')</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If None is given a new plot figure will be created.</li>
<li>width (number): Bars width, must be &gt;0 and &lt;=1</li>
<li>correctColor (color): correct data bars color.</li>
<li>erroneousColor (color): erroneous data bars color.</li>
<li>xlabel (boolean): Whether to create x label.</li>
<li>xlabelSize (number): The x label font size.</li>
<li>ylabel (boolean): Whether to create y label.</li>
<li>ylabelSize (number): The y label font size.</li>
<li>legend (boolean): Whether to create the legend or not</li>
<li>legendCols (integer): Legend number of columns.</li>
<li>legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</li>
<li>legendText (list): The legend of number of correct pairs satisfying
constraint and number of erroneous pairs unsatisfying constraint
condition.</li>
<li>title (boolean): Whether to create the title or not</li>
<li>titleStdErr (boolean): Whether to show constraint standard error value in title.</li>
<li>titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</li>
<li>titleUsedFrame(boolean): Whether to show used frame name in title.</li>
<li>show (boolean): Whether to render and show figure before returning.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes): matplotlib used axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/molecular_distances_constraint_plot_method.png"><img alt="_images/molecular_distances_constraint_plot_method.png" src="_images/molecular_distances_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>delimiter='     '</em>, <em>comments='# '</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.DistanceConstraints.</code><code class="descname">IntraMolecularDistanceConstraint</code><span class="sig-paren">(</span><em>defaultDistance=1.5</em>, <em>typeDefinition='name'</em>, <em>pairsDistanceDefinition=None</em>, <em>flexible=True</em>, <em>rejectProbability=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">fullrmc.Constraints.DistanceConstraints._MolecularDistanceConstraint</span></code></p>
<p>Its controls the intra-molecular distances between atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">defaultDistance (number): The minimum distance allowed set by default for all 
atoms type.</p>
</li>
<li><p class="first">typeDefinition (string): Can be either &#8216;element&#8217; or &#8216;name&#8217;. It sets the rules 
about how to differentiate between atoms and how to parse pairsLimits.</p>
</li>
<li><p class="first">pairsDistanceDefinition (None, list, set, tuple): The minimum distance set to 
every pair of elements. 
A list of tuples must be given, all missing pairs will get automatically 
assigned the given defaultMinimumDistance value.
First defined elements pair distance will cancel all redundant. 
If None is given all pairs will be automatically generated and assigned the 
given defaultMinimumDistance value .</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">[(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mf">2.015</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span> 
</pre></div>
</div>
</li>
<li><p class="first">flexible (boolean): Whether to allow atoms to break constraint&#8217;s definition 
under the condition of decreasing total standardError of the constraint. 
If flexible is set to False, atoms will never be allowed to cross from above 
to below minimum allowed distance. Even if the later will decrease some other 
unsatisfying atoms distances, and therefore the total standardError of the 
constraint.</p>
</li>
<li><p class="first">rejectProbability (Number): rejecting probability of all steps where 
standardError increases. It must be between 0 and 1 where 1 means 
rejecting all steps where standardError increases and 0 means accepting 
all steps regardless whether standardError increases or not.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.DistanceConstraints</span> <span class="kn">import</span> <span class="n">IntraMolecularDistanceConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">EMD</span> <span class="o">=</span> <span class="n">IntraMolecularDistanceConstraint</span><span class="p">()</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">EMD</span><span class="p">)</span>

<span class="c1"># create definition</span>
<span class="n">EMD</span><span class="o">.</span><span class="n">set_pairs_distance</span><span class="p">([(</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span><span class="mf">1.75</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="mf">1.10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="mf">1.30</span><span class="p">)])</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.defaultDistance">
<code class="descname">defaultDistance</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.defaultDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances minimum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.pairsDistanceDefinition">
<code class="descname">pairsDistanceDefinition</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.pairsDistanceDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.pairsDistance">
<code class="descname">pairsDistance</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.pairsDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.flexible">
<code class="descname">flexible</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.flexible" title="Permalink to this definition">¶</a></dt>
<dd><p>Get flexible flag</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.lowerLimitArray">
<code class="descname">lowerLimitArray</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.lowerLimitArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lowerLimitArray used in distances calculation.
for InterMolecularDistanceConstraint it&#8217;s always a numpy.zeros array</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.upperLimitArray">
<code class="descname">upperLimitArray</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.upperLimitArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Get upperLimitArray used in distances calculation.
for InterMolecularDistanceConstraint it&#8217;s the minimum distance allowed between pair of intermolecular atoms</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typePairs">
<code class="descname">typePairs</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typePairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Atoms type pairs sorted list</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typeDefinition">
<code class="descname">typeDefinition</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typeDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>atoms type definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.types">
<code class="descname">types</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.types" title="Permalink to this definition">¶</a></dt>
<dd><p>Defined atom types set.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.allTypes">
<code class="descname">allTypes</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.allTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>All atom types.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.numberOfTypes">
<code class="descname">numberOfTypes</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.numberOfTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of defined atom types in the configuration.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typeIndexes">
<code class="descname">typeIndexes</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typeIndexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Type indexes list.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.numberOfAtomsPerType">
<code class="descname">numberOfAtomsPerType</code><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.numberOfAtomsPerType" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of atoms per type dict.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>listen to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_flexible">
<code class="descname">set_flexible</code><span class="sig-paren">(</span><em>flexible</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_flexible" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets flexible flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>flexible (boolean): Whether to allow atoms to break constraints definition 
under the condition of decreasing total standardError. If flexible is 
set to False, atoms will never be allowed to cross from above to below 
minimum allowed distance. Even if the later will decrease some other 
unsatisfying atoms distances, and therefore the total standardError 
of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_default_distance">
<code class="descname">set_default_distance</code><span class="sig-paren">(</span><em>defaultDistance</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_default_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the default intermolecular minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>defaultDistance (number): The default minimum distance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_type_definition">
<code class="descname">set_type_definition</code><span class="sig-paren">(</span><em>typeDefinition</em>, <em>pairsDistanceDefinition=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_type_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Its an alias to set_pairs_distance used when typeDefinition needs to be re-defined.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>typeDefinition (string): Can be either &#8216;element&#8217; or &#8216;name&#8217;. It sets the rules about how to differentiate between atoms and how to parse pairsLimits.</li>
<li>pairsDistanceDefinition (None, list, set, tuple): The minimum distance set to every pair of elements. 
If None is given the already defined pairsDistanceDefinition will be used and passed to set_pairs_distance method.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_pairs_distance">
<code class="descname">set_pairs_distance</code><span class="sig-paren">(</span><em>pairsDistanceDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_pairs_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the pairs intermolecular minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">pairsDistanceDefinition (None, list, set, tuple): The minimum distance set to every pair of elements. 
A list of tuples must be given, all missing pairs will get automatically assigned the given defaultMinimumDistance value.
First defined elements pair distance will cancel all redundant. 
If None is given all pairs will be automatically generated and assigned the given defaultMinimumDistance value</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">[(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mf">2.015</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span> 
</pre></div>
</div>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.should_step_get_rejected">
<code class="descname">should_step_get_rejected</code><span class="sig-paren">(</span><em>standardError</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.should_step_get_rejected" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a standardError, return whether to keep or reject new standardError 
according to the constraint rejectProbability.
In addition, if flexible flag is set to True, total number of atoms not satisfying 
constraints definition must be decreasing or at least remain the same.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>standardError (number): The standardError to compare with the Constraint standardError</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): True to reject step, False to accept</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (stdErr) of data not satisfying constraint conditions.</p>
<div class="math">
\[stdErr = \sum \limits_{i}^{N} \sum \limits_{i+1}^{N} 
\left| d_{ij}-D_{ij}) \right| 
\int_{0}^{D_{ij}} \delta(x-d_{ij}) dx \]</div>
<p>Where:</p>
<p><span class="math">\(N\)</span> is the total number of atoms in the system.</p>
<p><span class="math">\(D_{ij}\)</span> is the distance constraint set for atoms pair (i,j).</p>
<p><span class="math">\(d_{ij}\)</span> is the distance between atom i and atom j.</p>
<p><span class="math">\(\delta\)</span> is the Dirac delta function.</p>
<p><span class="math">\(\int_{0}^{D_{ij}} \delta(x-d_{ij}) dx\)</span> 
is equal to 1 if <span class="math">\(0 \leqslant d_{ij} \leqslant D_{ij}\)</span> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (dict): The constraint value data returned using 
get_constraint_value.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_as_if_amputated">
<code class="descname">compute_as_if_amputated</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_as_if_amputated" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return constraint&#8217;s data and standard error as if atom given its 
its was amputated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputation of atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputation of atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>width=0.6</em>, <em>correctColor='#0066ff'</em>, <em>erroneousColor='#d62728'</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=1</em>, <em>legendLoc='best'</em>, <em>legendText=('correct'</em>, <em>'erroneous')</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If None is given a new plot figure will be created.</li>
<li>width (number): Bars width, must be &gt;0 and &lt;=1</li>
<li>correctColor (color): correct data bars color.</li>
<li>erroneousColor (color): erroneous data bars color.</li>
<li>xlabel (boolean): Whether to create x label.</li>
<li>xlabelSize (number): The x label font size.</li>
<li>ylabel (boolean): Whether to create y label.</li>
<li>ylabelSize (number): The y label font size.</li>
<li>legend (boolean): Whether to create the legend or not</li>
<li>legendCols (integer): Legend number of columns.</li>
<li>legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</li>
<li>legendText (list): The legend of number of correct pairs satisfying
constraint and number of erroneous pairs unsatisfying constraint
condition.</li>
<li>title (boolean): Whether to create the title or not</li>
<li>titleStdErr (boolean): Whether to show constraint standard error value in title.</li>
<li>titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</li>
<li>titleUsedFrame(boolean): Whether to show used frame name in title.</li>
<li>show (boolean): Whether to render and show figure before returning.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes): matplotlib used axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/molecular_distances_constraint_plot_method.png"><img alt="_images/molecular_distances_constraint_plot_method.png" src="_images/molecular_distances_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>delimiter='     '</em>, <em>comments='# '</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.AtomicCoordinationConstraints">
<span id="coordinationconstraints"></span><h2>CoordinationConstraints<a class="headerlink" href="#module-fullrmc.Constraints.AtomicCoordinationConstraints" title="Permalink to this headline">¶</a></h2>
<p>AtomicCoordinationConstraints contains classes for all constraints related to coordination numbers in shells around atoms.</p>
<img src="_images/inheritance-5de4a4f95fd80b3f583bc3e1f8841b8300040f09.png" alt="Inheritance diagram of fullrmc.Constraints.AtomicCoordinationConstraints" usemap="#inheritance58c05307aa" class="inheritance"/>
<map id="inheritance58c05307aa" name="inheritance58c05307aa">
<area shape="rect" id="node1" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint" target="_top" title="It&#39;s a rigid constraint that controls the coordination number between atoms. " alt="" coords="462,29,707,53"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" target="_top" title="A rigid constraint is a constraint that doesn&#39;t count into the total standardError of the Engine." alt="" coords="292,5,404,29"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" target="_top" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="283,53,414,77"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,29,235,53"/>
<area shape="rect" id="node5" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,29,104,53"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.AtomicCoordinationConstraints.</code><code class="descname">AtomicCoordinationNumberConstraint</code><span class="sig-paren">(</span><em>coordNumDef=None</em>, <em>rejectProbability=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></code></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></code></a></p>
<p>It&#8217;s a rigid constraint that controls the coordination number between atoms.</p>
<iframe width="560" height="315" 
src="https://www.youtube.com/embed/R8t-_XwizOI?rel=0" 
frameborder="0" allowfullscreen>
</iframe><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>coordNumDef (None, list, tuple): The coordination number definition. 
It must be None or a list or tuple where every element is a list or a
tuple of exactly 6 items and an optional 7th item for weight.<ol class="arabic">
<li>the core atoms: Can be any of the following:<ul>
<li>string: indicating atomic element</li>
<li>dictionary: Key an atomic attribute among (element, name) 
and value is the attribute value.</li>
<li>list, tuple, set, numpy.ndarray: core atoms indexes</li>
</ul>
</li>
<li>the in shell atoms: Can be any of the following:<ul>
<li>string: indicating atomic element</li>
<li>dictionary: Key an atomic attribute among (element, name) 
and value is the attribute value.</li>
<li>list, tuple, set, numpy.ndarray: in shell atoms indexes</li>
</ul>
</li>
<li>the lower distance limit of the coordination shell.</li>
<li>the upper distance limit of the coordination shell.</li>
<li><span class="math">\(N_{min}\)</span> : the minimum number of neighbours in the shell.</li>
<li><span class="math">\(N_{max}\)</span> : the maximum number of neighbours in the shell.</li>
<li><span class="math">\(W_{i}\)</span> : the weight contribution to the standard error, 
this is optional, if not given it is set automatically to 1.0.</li>
</ol>
</li>
<li>rejectProbability (Number): rejecting probability of all steps where standardError increases. 
It must be between 0 and 1 where 1 means rejecting all steps where standardError increases
and 0 means accepting all steps regardless whether standardError increases or not.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.AtomicCoordinationConstraints</span> <span class="kn">import</span> <span class="n">AtomicCoordinationNumberConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">ACNC</span> <span class="o">=</span> <span class="n">AtomicCoordinationNumberConstraint</span><span class="p">()</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">ACNC</span><span class="p">)</span>

<span class="c1"># create definition</span>
<span class="n">ACNC</span><span class="o">.</span><span class="n">set_coordination_number_definition</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                           <span class="p">(</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span> <span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.coordNumDef">
<code class="descname">coordNumDef</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.coordNumDef" title="Permalink to this definition">¶</a></dt>
<dd><p>Get coordination number definition dictionary</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.coresIndexes">
<code class="descname">coresIndexes</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.coresIndexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of coordination number core atoms indexes array as generated 
from  coordination number definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.shellsIndexes">
<code class="descname">shellsIndexes</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.shellsIndexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of coordination number shell atoms indexes array as generated 
from coordination number definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.lowerShells">
<code class="descname">lowerShells</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.lowerShells" title="Permalink to this definition">¶</a></dt>
<dd><p>Get array of lower shells distance as generated from coordination number 
definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.upperShells">
<code class="descname">upperShells</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.upperShells" title="Permalink to this definition">¶</a></dt>
<dd><p>Get array of upper shells distance as generated from coordination number 
definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.minAtoms">
<code class="descname">minAtoms</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.minAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Get array of minimum number of atoms in a shell as generated from 
coordination number definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.maxAtoms">
<code class="descname">maxAtoms</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.maxAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Get array of maximum number of atoms in a shell as generated from 
coordination number definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.weights">
<code class="descname">weights</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Get shells weights which count in the computation of standard error.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.data">
<code class="descname">data</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get coordination number constraint data.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.asCoreDefIdxs">
<code class="descname">asCoreDefIdxs</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.asCoreDefIdxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of arrays where each element is pointing to a coordination 
number definition where the atom is a core.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.inShellDefIdxs">
<code class="descname">inShellDefIdxs</code><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.inShellDefIdxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of arrays where each element is pointing to a coordination 
number definition where the atom is in a shell.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>listen to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.set_coordination_number_definition">
<code class="descname">set_coordination_number_definition</code><span class="sig-paren">(</span><em>coordNumDef</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.set_coordination_number_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the coordination number definition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">coordNumDef (None, list, tuple): The coordination number definition. 
It must be None or a list or tuple where every element is a list or a
tuple of exactly 6 items and an optional 7th item for weight.</p>
<ol class="arabic simple">
<li>the core atoms: Can be any of the following:<ul>
<li>string: indicating atomic element</li>
<li>dictionary: Key an atomic attribute among (element, name) 
and value is the attribute value.</li>
<li>list, tuple, set, numpy.ndarray: core atoms indexes</li>
</ul>
</li>
<li>the in shell atoms: Can be any of the following:<ul>
<li>string: indicating atomic element</li>
<li>dictionary: Key an atomic attribute among (element, name) 
and value is the attribute value.</li>
<li>list, tuple, set, numpy.ndarray: in shell atoms indexes</li>
</ul>
</li>
<li>the lower distance limit of the coordination shell.</li>
<li>the upper distance limit of the coordination shell.</li>
<li><span class="math">\(N_{min}\)</span> : the minimum number of neighbours in the shell.</li>
<li><span class="math">\(N_{max}\)</span> : the maximum number of neighbours in the shell.</li>
<li><span class="math">\(W_{i}\)</span> : the weight contribution to the standard error, 
this is optional, if not given it is set automatically to 1.0.</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;Ti&#39;</span><span class="p">,</span><span class="s1">&#39;Ti&#39;</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">7.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Ni&#39;</span><span class="p">,</span><span class="s1">&#39;Ti&#39;</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">,</span> <span class="mf">9.7</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>
     <span class="p">[</span> <span class="p">({</span><span class="s1">&#39;element&#39;</span><span class="p">:</span><span class="s1">&#39;Ti&#39;</span><span class="p">},</span><span class="s1">&#39;Ti&#39;</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">7.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>  
     <span class="p">[</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;au&#39;</span><span class="p">},</span><span class="s1">&#39;Au&#39;</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>  
     <span class="p">[</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Ni&#39;</span><span class="p">},{</span><span class="s1">&#39;element&#39;</span><span class="p">:</span><span class="s1">&#39;Ti&#39;</span><span class="p">},</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>   
     <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;Ti&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>   
     <span class="p">[</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">1000</span><span class="p">],{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Ti&#39;</span><span class="p">},</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>   
</pre></div>
</div>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (StdErr) of data not satisfying constraint conditions.</p>
<div class="math">
\[StdErr = \sum \limits_{i}^{S} Dev_{i}\]</div>
<div class="math">
\[\begin{split}Dev_{i}=\begin{cases}
  W_{i}*( N_{min,i}-\overline{CN_{i}} ), &amp; \text{if $\overline{CN_{i}}&lt;N_{min,i}$}.\\
  W_{i}*( \overline{CN_{i}}-N_{max,i} ), &amp; \text{if $\overline{CN_{i}}&gt;N_{max,i}$}.\\
  0                  , &amp; \text{if $N_{min,i}&lt;=\overline{CN_{i}}&lt;=N_{max,i}$}
\end{cases}\end{split}\]</div>
<p>Where:</p>
<p><span class="math">\(S\)</span>                  is the total number of defined coordination number shells.</p>
<p><span class="math">\(W_{i}\)</span>              is the defined weight of coordination number shell i.</p>
<p><span class="math">\(Dev_{i}\)</span>            is the standard deviation of the coordination number in shell definition i.</p>
<p><span class="math">\(\overline{CN_{i}}\)</span> is the mean coordination number value in shell definition i.</p>
<p><span class="math">\(N_{min,i}\)</span>          is the defined minimum number of neighbours in shell definition i.</p>
<p><span class="math">\(N_{max,i}\)</span>          is the defined maximum number of neighbours in shell definition i.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute standardError.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets squared deviation per shell definition</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_as_if_amputated">
<code class="descname">compute_as_if_amputated</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.compute_as_if_amputated" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return constraint&#8217;s data and standard error as if atom given its 
its was amputated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputation of atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputation of atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>width=0.6</em>, <em>barColor='#99ccff'</em>, <em>cnColor='#ffcc00'</em>, <em>cnPtSize=20</em>, <em>stdErrors=True</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=1</em>, <em>legendLoc='best'</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If ax is given, the figure won&#8217;t be rendered and drawn.
If None is given a new plot figure will be created and the figue will be rendered and drawn.</li>
<li>width (number): Bars width, must be &gt;0 and &lt;=1</li>
<li>barColor (color): boundaries bar color.</li>
<li>cnColor (color): coordination number data points color.</li>
<li>cnPtSize (number): coordination number data points size.</li>
<li>stdErrors (boolean): Whether to show bars standard error.</li>
<li>xlabel (boolean): Whether to create x label.</li>
<li>xlabelSize (number): The x label font size.</li>
<li>ylabel (boolean): Whether to create y label.</li>
<li>ylabelSize (number): The y label font size.</li>
<li>legend (boolean): Whether to create the legend or not</li>
<li>legendCols (integer): Legend number of columns.</li>
<li>legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</li>
<li>title (boolean): Whether to create the title or not</li>
<li>titleStdErr (boolean): Whether to show constraint standard error value in title.</li>
<li>titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</li>
<li>titleUsedFrame(boolean): Whether to show used frame name in title.</li>
<li>show (boolean): Whether to render and show figure before returning.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes): matplotlib used axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/atomic_coordination_number_constraint_plot_method.png"><img alt="_images/atomic_coordination_number_constraint_plot_method.png" src="_images/atomic_coordination_number_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>delimiter='     '</em>, <em>comments='# '</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AtomicCoordinationConstraints.AtomicCoordinationNumberConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.BondConstraints">
<span id="bondconstraints"></span><h2>BondConstraints<a class="headerlink" href="#module-fullrmc.Constraints.BondConstraints" title="Permalink to this headline">¶</a></h2>
<p>BondConstraints contains classes for all constraints related bonds between atoms.</p>
<img src="_images/inheritance-1c1b79a2c60b4aa3370fe35788cb5057fb152225.png" alt="Inheritance diagram of fullrmc.Constraints.BondConstraints" usemap="#inheritance8a1175d00c" class="inheritance"/>
<map id="inheritance8a1175d00c" name="inheritance8a1175d00c">
<area shape="rect" id="node1" href="#fullrmc.Constraints.BondConstraints.BondConstraint" target="_top" title="Controls the bond length defined between 2 defined atoms." alt="" coords="462,29,575,53"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" target="_top" title="A rigid constraint is a constraint that doesn&#39;t count into the total standardError of the Engine." alt="" coords="292,5,404,29"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" target="_top" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="283,53,414,77"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,29,235,53"/>
<area shape="rect" id="node5" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,29,104,53"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.BondConstraints.</code><code class="descname">BondConstraint</code><span class="sig-paren">(</span><em>rejectProbability=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></code></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></code></a></p>
<p>Controls the bond length defined between 2 defined atoms.</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/bondSketch.png"><img alt="_images/bondSketch.png" src="_images/bondSketch.png" style="width: 237px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Bond sketch defined between two atoms.</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<iframe width="560" height="315" 
src="https://www.youtube.com/embed/GxmJae9h78E" 
frameborder="0" allowfullscreen>
</iframe><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>rejectProbability (Number): rejecting probability of all steps where standardError increases. 
It must be between 0 and 1 where 1 means rejecting all steps where standardError increases
and 0 means accepting all steps regardless whether standardError increases or not.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">## Water (H2O) molecule sketch</span>
<span class="c1">## </span>
<span class="c1">##              O</span>
<span class="c1">##            /   \      </span>
<span class="c1">##         /   H2O   \  </span>
<span class="c1">##       H1           H2 </span>

<span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.BondConstraints</span> <span class="kn">import</span> <span class="n">BondConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">BC</span> <span class="o">=</span> <span class="n">BondConstraint</span><span class="p">()</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">BC</span><span class="p">)</span>

<span class="c1"># define intra-molecular bonds </span>
<span class="n">BC</span><span class="o">.</span><span class="n">create_bonds_by_definition</span><span class="p">(</span> <span class="n">bondsDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">),</span>
                                                         <span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">)</span> <span class="p">]}</span> <span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.bondsList">
<code class="descname">bondsList</code><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.bondsList" title="Permalink to this definition">¶</a></dt>
<dd><p>List of defined bonds</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.bonds">
<code class="descname">bonds</code><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get bonds dictionary map of every and each atom</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.set_bonds">
<code class="descname">set_bonds</code><span class="sig-paren">(</span><em>bondsList</em>, <em>tform=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.set_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets bonds dictionary by parsing the bondsList list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">bondsList (None, list): The bonds map definition. If None is given no
bonds are defined. Otherwise it can be of any of the following two forms:</p>
<blockquote>
<div><p>tuples format: every item must be a list or tuple of four items.</p>
<ol class="arabic simple">
<li>First item:  the first atom index.</li>
<li>Second item: the second atom index forming the bond.</li>
<li>Third item: The lower limit or the minimum bond length allowed.</li>
<li>Fourth item: The upper limit or the maximum bond length allowed.</li>
</ol>
<p>four vectors format: List of exaclty four lists or numpy.arrays or vectors of the same length.</p>
<ol class="arabic simple">
<li>First item: list contains the first atom indexes.</li>
<li>Second item: list contains the second atom indexes forming the bond.</li>
<li>Third item: list containing the lower limit or the minimum bond length allowed.</li>
<li>Fourth item: list containing the upper limit or the maximum bond length allowed.</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">tform (boolean): set whether given bondsList follows tuples format, If not 
then it must follow the four vectors one.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.add_bond">
<code class="descname">add_bond</code><span class="sig-paren">(</span><em>bond</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a single bond to the list of constraint bonds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>bond (list): The bond list of four items.<ol class="arabic">
<li>First item: the first atom index.</li>
<li>Second item: the second atom index forming the bond.</li>
<li>Third item: The lower limit or the minimum bond length allowed.</li>
<li>Fourth item: The upper limit or the maximum bond length allowed.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.create_bonds_by_definition">
<code class="descname">create_bonds_by_definition</code><span class="sig-paren">(</span><em>bondsDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.create_bonds_by_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates bondsList using bonds definition.
Calls set_bonds(bondsList) and generates bonds attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><blockquote class="first">
<div><ol class="arabic simple">
<li>bondsDefinition (dict): The bonds definition. 
Every key must be a molecule name (residue name in pdb file). 
Every key value must be a list of bonds definitions. 
Every bond definition is a list of four items where:<ol class="arabic">
<li>First item: The name of the first atom forming the bond.</li>
<li>Second item: The name of the second atom forming the bond.</li>
<li>Third item: The lower limit or the minimum bond length allowed.</li>
<li>Fourth item: The upper limit or the maximum bond length allowed.</li>
</ol>
</li>
</ol>
</div></blockquote>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">(</span><span class="n">Carbon</span> <span class="n">tetrachloride</span><span class="p">):</span>  <span class="n">bondsDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;CCL4&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;CL1&#39;</span> <span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">),</span>
                                                        <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;CL2&#39;</span> <span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">),</span>
                                                        <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;CL3&#39;</span> <span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">),</span>                                       
                                                        <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;CL4&#39;</span> <span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">)</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (StdErr) of data not satisfying constraint conditions.</p>
<div class="math">
\[StdErr = \sum \limits_{i}^{C} 
( \beta_{i} - \beta_{i}^{min} ) ^{2} 
\int_{0}^{\beta_{i}^{min}} \delta(\beta-\beta_{i}) d \beta
+
( \beta_{i} - \beta_{i}^{max} ) ^{2} 
\int_{\beta_{i}^{max}}^{\infty} \delta(\beta-\beta_{i}) d \beta\]</div>
<p>Where:</p>
<p><span class="math">\(C\)</span> is the total number of defined bonds constraints.</p>
<p><span class="math">\(\beta_{i}^{min}\)</span> is the bond constraint lower limit set for constraint i.</p>
<p><span class="math">\(\beta_{i}^{max}\)</span> is the bond constraint upper limit set for constraint i.</p>
<p><span class="math">\(\beta_{i}\)</span> is the bond length computed for constraint i.</p>
<p><span class="math">\(\delta\)</span> is the Dirac delta function.</p>
<p><span class="math">\(\int_{0}^{\beta_{i}^{min}} \delta(\beta-\beta_{i}) d \beta\)</span> 
is equal to 1 if <span class="math">\(0 \leqslant \beta_{i} \leqslant \beta_{i}^{min}\)</span> and 0 elsewhere.</p>
<p><span class="math">\(\int_{\beta_{i}^{max}}^{\pi} \delta(\beta-\beta_{i}) d \beta\)</span> 
is equal to 1 if <span class="math">\(\beta_{i}^{max} \leqslant \beta_{i} \leqslant \infty\)</span> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (object): The constraint value data to compute standardError.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_as_if_amputated">
<code class="descname">compute_as_if_amputated</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_as_if_amputated" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return constraint&#8217;s data and standard error as if atom given its 
its was amputated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputation of atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputation of atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>nbins=25</em>, <em>subplots=True</em>, <em>split=None</em>, <em>wspace=0.3</em>, <em>hspace=0.3</em>, <em>histtype='bar'</em>, <em>lineWidth=None</em>, <em>lineColor=None</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=1</em>, <em>legendLoc='best'</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot bonds constraint distribution histogram.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic">
<li><p class="first">ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If ax is given,  subplots parameters will be omitted. 
If None is given a new plot figure will be created.</p>
</li>
<li><p class="first">nbins (int): number of bins in histogram.</p>
</li>
<li><p class="first">subplots (boolean): Whether to add plot constraint on multiple axes.</p>
</li>
<li><p class="first">split (None, &#8216;name&#8217;, &#8216;element&#8217;): To split plots into histogram per atom 
names, elements in addition to lower and upper bounds. If None histograms 
will be built from lower and upper bounds only.</p>
</li>
<li><p class="first">wspace (float): The amount of width reserved for blank space between 
subplots, expressed as a fraction of the average axis width.</p>
</li>
<li><p class="first">hspace (float): The amount of height reserved for white space between 
subplots, expressed as a fraction of the average axis height.</p>
</li>
<li><dl class="first docutils">
<dt>histtype (string): the histogram type. optional among</dt>
<dd><p class="first last">[&#8216;bar&#8217;, &#8216;barstacked&#8217;, &#8216;step&#8217;, &#8216;stepfilled&#8217;]</p>
</dd>
</dl>
</li>
<li><p class="first">lineWidth (None, integer): bars contour line width. If None then default
value will be given.</p>
</li>
<li><p class="first">lineColor (None, integer): bars contour line color. If None then default
value will be given.</p>
</li>
<li><p class="first">xlabel (boolean): Whether to create x label.</p>
</li>
<li><p class="first">xlabelSize (number): The x label font size.</p>
</li>
<li><p class="first">ylabel (boolean): Whether to create y label.</p>
</li>
<li><p class="first">ylabelSize (number): The y label font size.</p>
</li>
<li><p class="first">legend (boolean): Whether to create the legend or not</p>
</li>
<li><p class="first">legendCols (integer): Legend number of columns.</p>
</li>
<li><p class="first">legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</p>
</li>
<li><p class="first">title (boolean): Whether to create the title or not.</p>
</li>
<li><p class="first">titleStdErr (boolean): Whether to show constraint standard error value in title.</p>
</li>
<li><p class="first">titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</p>
</li>
<li><p class="first">titleUsedFrame(boolean): Whether to show used frame name in title.</p>
</li>
<li><p class="first">show (boolean): Whether to render and show figure before returning.</p>
</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes, List): matplotlib axes or a list of axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/bond_constraint_plot_method.png"><img alt="_images/bond_constraint_plot_method.png" src="_images/bond_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>delimiter='     '</em>, <em>comments='# '</em>, <em>split=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
<li>split (None, &#8216;name&#8217;, &#8216;element&#8217;): To split output into per atom names,
elements in addition to lower and upper bounds. If None output 
will be built from lower and upper bounds only.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.AngleConstraints">
<span id="angleconstraints"></span><h2>AngleConstraints<a class="headerlink" href="#module-fullrmc.Constraints.AngleConstraints" title="Permalink to this headline">¶</a></h2>
<p>AngleConstraints contains classes for all constraints related angles between atoms.</p>
<img src="_images/inheritance-cb42445eba3d56d2a44898c2310ad22e114ba38e.png" alt="Inheritance diagram of fullrmc.Constraints.AngleConstraints" usemap="#inheritancebcea9c8ad8" class="inheritance"/>
<map id="inheritancebcea9c8ad8" name="inheritancebcea9c8ad8">
<area shape="rect" id="node1" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint" target="_top" title="Controls the angle defined between 3 defined atoms, a first atom called central" alt="" coords="462,29,616,53"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" target="_top" title="A rigid constraint is a constraint that doesn&#39;t count into the total standardError of the Engine." alt="" coords="292,5,404,29"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" target="_top" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="283,53,414,77"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,29,235,53"/>
<area shape="rect" id="node5" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,29,104,53"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.AngleConstraints.</code><code class="descname">BondsAngleConstraint</code><span class="sig-paren">(</span><em>anglesMap=None</em>, <em>rejectProbability=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></code></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></code></a></p>
<p>Controls the angle defined between 3 defined atoms, a first atom called central
and the remain two called left and right.</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/angleSketch.png"><img alt="_images/angleSketch.png" src="_images/angleSketch.png" style="width: 308px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Angle sketch defined between three atoms.</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<iframe width="560" height="315" 
src="https://www.youtube.com/embed/ezBbbO9IVig" 
frameborder="0" allowfullscreen>
</iframe><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>rejectProbability (Number): rejecting probability of all steps where standardError increases. 
It must be between 0 and 1 where 1 means rejecting all steps where standardError increases
and 0 means accepting all steps regardless whether standardError increases or not.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">## Methane (CH4) molecule sketch</span>
<span class="c1">## </span>
<span class="c1">##              H4</span>
<span class="c1">##              |</span>
<span class="c1">##              |</span>
<span class="c1">##           _- C -_</span>
<span class="c1">##        H1-  /    -_</span>
<span class="c1">##            /       H3</span>
<span class="c1">##           H2</span>

<span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.AngleConstraints</span> <span class="kn">import</span> <span class="n">BondsAngleConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">BAC</span> <span class="o">=</span> <span class="n">BondsAngleConstraint</span><span class="p">()</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">BAC</span><span class="p">)</span>

<span class="c1"># define intra-molecular angles </span>
<span class="n">BAC</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;CH4&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                            <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span><span class="s1">&#39;H3&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                            <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;H3&#39;</span><span class="p">,</span><span class="s1">&#39;H4&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                            <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;H4&#39;</span><span class="p">,</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span> <span class="p">]}</span> <span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.anglesList">
<code class="descname">anglesList</code><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.anglesList" title="Permalink to this definition">¶</a></dt>
<dd><p>Get defined angles list.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.angles">
<code class="descname">angles</code><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get angles dictionary for every and each atom.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.set_angles">
<code class="descname">set_angles</code><span class="sig-paren">(</span><em>anglesList</em>, <em>tform=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.set_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angles dictionary by parsing the anglesMap list. All angles are in 
degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><blockquote class="first">
<div><ol class="arabic">
<li><p class="first">anglesList (list): The angles list definition.</p>
<p>tuples format:  every item must be a list of five items.</p>
<ol class="arabic simple">
<li>First item: The central atom index.</li>
<li>Second item: The index of the left atom forming the angle (interchangeable with the right atom).</li>
<li>Third item: The index of the right atom forming the angle (interchangeable with the left atom).</li>
<li>Fourth item: The minimum lower limit or the minimum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Fifth item: The maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
</ol>
<p>five vectors format:  List of exaclty five lists or numpy.arrays or vectors of the same length.</p>
<ol class="arabic simple">
<li>First item: List containing central atom indexes.</li>
<li>Second item: List containing the index of the left atom forming the angle (interchangeable with the right atom).</li>
<li>Third item: List containing the index of the right atom forming the angle (interchangeable with the left atom).</li>
<li>Fourth item: List containing the minimum lower limit or the minimum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Fifth item: List containing the maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
</ol>
</li>
</ol>
</div></blockquote>
<ol class="last arabic simple">
<li>tform (boolean): set whether given anglesList follows tuples format, If not 
then it must follow the four vectors one.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.add_angle">
<code class="descname">add_angle</code><span class="sig-paren">(</span><em>angle</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.add_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a single angle to the list of constraint angles. All angles are in degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>angle (list): The bond list of five items.<ol class="arabic">
<li>First item: The central atom index.</li>
<li>Second item: The index of the left atom forming the angle (interchangeable with the right atom).</li>
<li>Third item: The index of the right atom forming the angle (interchangeable with the left atom).</li>
<li>Fourth item: The minimum lower limit or the minimum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Fifth item: The maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.create_angles_by_definition">
<code class="descname">create_angles_by_definition</code><span class="sig-paren">(</span><em>anglesDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.create_angles_by_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates anglesList using angles definition.
Calls set_angles(anglesList) and generates angles attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>anglesDefinition (dict): The angles definition. 
Every key must be a molecule name (residue name in pdb file). 
Every key value must be a list of angles definitions. 
Every angle definition is a list of five items where:<ol class="arabic">
<li>First item: The name of the central atom forming the angle.</li>
<li>Second item: The name of the left atom forming the angle (interchangeable with the right atom).</li>
<li>Third item: The name of the right atom forming the angle (interchangeable with the left atom).</li>
<li>Fourth item: The minimum lower limit or the minimum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Fifth item: The maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">(</span><span class="n">Carbon</span> <span class="n">tetrachloride</span><span class="p">):</span>  <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;CCL4&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;CL1&#39;</span><span class="p">,</span><span class="s1">&#39;CL2&#39;</span> <span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
                                                         <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;CL2&#39;</span><span class="p">,</span><span class="s1">&#39;CL3&#39;</span> <span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
                                                         <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;CL3&#39;</span><span class="p">,</span><span class="s1">&#39;CL4&#39;</span> <span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">115</span><span class="p">),</span>                                      
                                                         <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;CL4&#39;</span><span class="p">,</span><span class="s1">&#39;CL1&#39;</span> <span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">115</span><span class="p">)</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (StdErr) of data not satisfying constraint conditions.</p>
<div class="math">
\[StdErr = \sum \limits_{i}^{C} 
( \theta_{i} - \theta_{i}^{min} ) ^{2} 
\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta
+
( \theta_{i} - \theta_{i}^{max} ) ^{2} 
\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta\]</div>
<p>Where:</p>
<p><span class="math">\(C\)</span> is the total number of defined angles constraints.</p>
<p><span class="math">\(\theta_{i}^{min}\)</span> is the angle constraint lower limit set for constraint i.</p>
<p><span class="math">\(\theta_{i}^{max}\)</span> is the angle constraint upper limit set for constraint i.</p>
<p><span class="math">\(\theta_{i}\)</span> is the angle computed for constraint i.</p>
<p><span class="math">\(\delta\)</span> is the Dirac delta function.</p>
<p><span class="math">\(\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta\)</span> 
is equal to 1 if <span class="math">\(0 \leqslant \theta_{i} \leqslant \theta_{i}^{min}\)</span> and 0 elsewhere.</p>
<p><span class="math">\(\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta\)</span> 
is equal to 1 if <span class="math">\(\theta_{i}^{max} \leqslant \theta_{i} \leqslant \pi\)</span> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute standardError.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputation of atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputation of atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>nbins=25</em>, <em>subplots=True</em>, <em>split=None</em>, <em>wspace=0.3</em>, <em>hspace=0.3</em>, <em>histtype='bar'</em>, <em>lineWidth=None</em>, <em>lineColor=None</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=1</em>, <em>legendLoc='best'</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot angles constraint distribution histogram.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic">
<li><p class="first">ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If ax is given,  subplots parameters will be omitted. 
If None is given a new plot figure will be created.</p>
</li>
<li><p class="first">nbins (int): number of bins in histogram.</p>
</li>
<li><p class="first">subplots (boolean): Whether to add plot constraint on multiple axes.</p>
</li>
<li><p class="first">split (None, &#8216;name&#8217;, &#8216;element&#8217;): To split plots into histogram per atom 
names, elements in addition to lower and upper bounds. If None histograms 
will be built from lower and upper bounds only.</p>
</li>
<li><p class="first">wspace (float): The amount of width reserved for blank space between 
subplots, expressed as a fraction of the average axis width.</p>
</li>
<li><p class="first">hspace (float): The amount of height reserved for white space between 
subplots, expressed as a fraction of the average axis height.</p>
</li>
<li><dl class="first docutils">
<dt>histtype (string): the histogram type. optional among</dt>
<dd><p class="first last">[&#8216;bar&#8217;, &#8216;barstacked&#8217;, &#8216;step&#8217;, &#8216;stepfilled&#8217;]</p>
</dd>
</dl>
</li>
<li><p class="first">lineWidth (None, integer): bars contour line width. If None then default
value will be given.</p>
</li>
<li><p class="first">lineColor (None, integer): bars contour line color. If None then default
value will be given.</p>
</li>
<li><p class="first">xlabel (boolean): Whether to create x label.</p>
</li>
<li><p class="first">xlabelSize (number): The x label font size.</p>
</li>
<li><p class="first">ylabel (boolean): Whether to create y label.</p>
</li>
<li><p class="first">ylabelSize (number): The y label font size.</p>
</li>
<li><p class="first">legend (boolean): Whether to create the legend or not</p>
</li>
<li><p class="first">legendCols (integer): Legend number of columns.</p>
</li>
<li><p class="first">legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</p>
</li>
<li><p class="first">title (boolean): Whether to create the title or not.</p>
</li>
<li><p class="first">titleStdErr (boolean): Whether to show constraint standard error value in title.</p>
</li>
<li><p class="first">titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</p>
</li>
<li><p class="first">titleUsedFrame(boolean): Whether to show used frame name in title.</p>
</li>
<li><p class="first">show (boolean): Whether to render and show figure before returning.</p>
</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes, List): matplotlib axes or a list of axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/bonds_angle_constraint_plot_method.png"><img alt="_images/bonds_angle_constraint_plot_method.png" src="_images/bonds_angle_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>delimiter='     '</em>, <em>comments='# '</em>, <em>split=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
<li>split (None, &#8216;name&#8217;, &#8216;element&#8217;): To split output into per atom names,
elements in addition to lower and upper bounds. If None output 
will be built from lower and upper bounds only.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.DihedralAngleConstraints">
<span id="dihedralangleconstraints"></span><h2>DihedralAngleConstraints<a class="headerlink" href="#module-fullrmc.Constraints.DihedralAngleConstraints" title="Permalink to this headline">¶</a></h2>
<p>ImproperAngleConstraints contains classes for all constraints related improper angles between atoms.</p>
<img src="_images/inheritance-81203c8e65508cabd7feeaf39dd30e1d09fef97a.png" alt="Inheritance diagram of fullrmc.Constraints.ImproperAngleConstraints" usemap="#inheritance2ec5cb74e8" class="inheritance"/>
<map id="inheritance2ec5cb74e8" name="inheritance2ec5cb74e8">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,29,235,53"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" target="_top" title="A rigid constraint is a constraint that doesn&#39;t count into the total standardError of the Engine." alt="" coords="292,5,404,29"/>
<area shape="rect" id="node5" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" target="_top" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="283,53,414,77"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,29,104,53"/>
<area shape="rect" id="node3" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint" target="_top" title="Controls the improper angle formed with 4 defined atoms. It&#39;s mainly used to " alt="" coords="462,29,631,53"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.DihedralAngleConstraints.</code><code class="descname">DihedralAngleConstraint</code><span class="sig-paren">(</span><em>rejectProbability=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></code></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></code></a></p>
<p>Dihedral angle is defined between two intersecting planes formed with four defined 
atoms. Dihedral angle constraint can control 3 angle shells at the same times.</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/dihedralSketch.png"><img alt="_images/dihedralSketch.png" src="_images/dihedralSketch.png" style="width: 312px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Dihedral angle sketch defined between two planes formed with four atoms.</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>rejectProbability (Number): rejecting probability of all steps where standardError increases. 
It must be between 0 and 1 where 1 means rejecting all steps where standardError increases
and 0 means accepting all steps regardless whether standardError increases or not.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">## Butane (BUT) molecule sketch</span>
<span class="c1">##         </span>
<span class="c1">##       H13  H22  H32  H43</span>
<span class="c1">##        |    |    |    |</span>
<span class="c1">## H11---C1---C2---C3---C4---H41</span>
<span class="c1">##        |    |    |    |</span>
<span class="c1">##       H12  H21  H31  H42</span>
<span class="c1">##</span>

<span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.DihedralAngleConstraints</span> <span class="kn">import</span> <span class="n">DihedralAngleConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">DAC</span> <span class="o">=</span> <span class="n">DihedralAngleConstraint</span><span class="p">()</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">DAC</span><span class="p">)</span>

<span class="c1"># define intra-molecular dihedral angles </span>
<span class="n">DAC</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;BUT&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span> <span class="mi">290</span><span class="p">,</span><span class="mi">330</span><span class="p">),</span> <span class="p">]</span> <span class="p">})</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.anglesList">
<code class="descname">anglesList</code><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.anglesList" title="Permalink to this definition">¶</a></dt>
<dd><p>Get improper angles list.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.angles">
<code class="descname">angles</code><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get angles dictionary for every and each atom.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.set_angles">
<code class="descname">set_angles</code><span class="sig-paren">(</span><em>anglesList</em>, <em>tform=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.set_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angles dictionary by parsing the anglesList list. All angles are in 
degrees. Dihedral angle can control 3 angle shells at the same times defined using 
three different lower and upper angle bounds simulating three different dihedral 
potential energy minimums. Dihedral angles are defined from 0 to 360 degrees. 
Shell&#8217;s lower and  upper bound defines a dihedral angle clockwise. Therefore in 
order to take into considerations the limits at 0 and 360 degrees, lower bound 
is allowed to be higher than the higher bound.</p>
<p>e.g. (50, 100) is a dihedral shell defined in the angle range between 50 and 
100 degrees. But (100, 50) dihedral shell is defined between 100 to 360 degrees
and wraps the range from 0 to 100. (50, 100) and (100, 50) are complementary 
and cover the whole range from 0 to 360 deg.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><blockquote class="first">
<div><ol class="arabic">
<li><p class="first">anglesList (list): The angles list definition.</p>
<p>tuples format: every item must be a list of ten items.</p>
<ol class="arabic simple">
<li>First item: The first atom index of the first plane.</li>
<li>Second item: The second atom index of the first plane and the first 
atom index of the second plane.</li>
<li>Third item: The third atom index of the first plane and the second 
atom index of the second plane.</li>
<li>Fourth item: The fourth atom index of the second plane.</li>
<li>Fifth item: The minimum lower limit of the first shell or the minimum 
angle allowed in degrees.</li>
<li>Sixth item: The maximum upper limit of the first shell or the minimum 
angle allowed in degrees.</li>
<li>Seventh item: The minimum lower limit of the second shell or the minimum 
angle allowed in degrees.</li>
<li>Eights item: The maximum upper limit of the second shell or the minimum 
angle allowed in degrees.</li>
<li>Nineth item: The minimum lower limit of the third shell or the minimum 
angle allowed in degrees.</li>
<li>Tenth item: The maximum upper limit of the third shell or the minimum 
angle allowed in degrees.</li>
</ol>
<p>ten vectors format: every item must be a list of five items.</p>
<ol class="arabic simple">
<li>First item: List containing the first atom indexes of the first plane.</li>
<li>Second item: List containing indexes of the second atom index of the 
first plane and the first atom index of the second plane.</li>
<li>Third item: List containing indexes of the third atom index of the 
first plane and the second atom index of the second plane.</li>
<li>Fourth item: List containing indexes of the fourth atom index of the 
second plane.</li>
<li>Fifth item: List containing the minimum lower limit of the first shell 
or the minimum angle allowed in degrees which later will be converted 
to rad.</li>
<li>Sixth item: List containing the maximum upper limit of the first shell 
or the minimum angle allowed in degrees which later will be converted 
to rad.</li>
<li>Seventh item: List containing the minimum lower limit of the second 
shell or the minimum angle allowed in degrees which later will be 
converted to rad.</li>
<li>Eights item: List containing the maximum upper limit of the second 
shell or the minimum angle allowed in degrees which later will be 
converted to rad.</li>
<li>Nineth item: List containing the minimum lower limit of the third 
shell or the minimum angle allowed in degrees which later will be 
converted to rad.</li>
<li>Tenth item: List containing the maximum upper limit of the third shell 
or the minimum angle allowed in degrees which later will be converted 
to rad.</li>
</ol>
</li>
</ol>
</div></blockquote>
<ol class="last arabic simple">
<li>tform (boolean): set whether given anglesList follows tuples format, If not 
then it must follow the ten vectors one.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p><strong>N.B.</strong> Defining three shells boundaries is mandatory. In case fewer than three
shells is needed, it suffices to repeat one of the shells boundaries.</p>
<p>e.g. (&#8216;C1&#8217;,&#8217;C2&#8217;,&#8217;C3&#8217;,&#8217;C4&#8217;, 40,80, 100,140, 40,80), in the herein definition the 
last shell is a repetition of the first which means only two shells are defined.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.add_angle">
<code class="descname">add_angle</code><span class="sig-paren">(</span><em>angle</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.add_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a single angle to the list of constraint angles. All angles are in degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>angle (list): The angle list of ten items.<ol class="arabic">
<li>First item: The first atom index of the first plane.</li>
<li>Second item: The second atom index of the first plane and the first 
atom index of the second plane.</li>
<li>Third item: The third atom index of the first plane and the second 
atom index of the second plane.</li>
<li>Fourth item: The fourth atom index of the second plane.</li>
<li>Fifth item: The minimum lower limit of the first shell or the minimum 
angle allowed in degrees.</li>
<li>Sixth item: The maximum upper limit of the first shell or the minimum 
angle allowed in degrees.</li>
<li>seventh item: The minimum lower limit of the second shell or the minimum 
angle allowed in degrees.</li>
<li>eights item: The maximum upper limit of the second shell or the minimum 
angle allowed in degrees.</li>
<li>nineth item: The minimum lower limit of the third shell or the minimum 
angle allowed in degrees.</li>
<li>tenth item: The maximum upper limit of the third shell or the minimum 
angle allowed in degrees.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.create_angles_by_definition">
<code class="descname">create_angles_by_definition</code><span class="sig-paren">(</span><em>anglesDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.create_angles_by_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates anglesList using angles definition.
Calls set_angles(anglesMap) and generates angles attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>anglesDefinition (dict): The angles definition. 
Every key must be a molecule name (residue name in pdb file). 
Every key value must be a list of angles definitions. 
Every angle definition is a list of ten items where:<ol class="arabic">
<li>First item: The name of the first dihedral atom.</li>
<li>Second item: The name of the second dihedral atom of the first plane 
and the first atom of the second plane.</li>
<li>Third item: The name of the third dihedral atom of the first plane 
and the second  atom of the second plane.</li>
<li>Fourth item: The name of the fourth dihderal atom of the second plane.</li>
<li>Fifth item: The minimum lower limit of the first shell or the minimum 
angle allowed in degrees.</li>
<li>Sixth item: The maximum upper limit of the first or the maximum 
angle allowed in degrees.</li>
<li>Seventh item: The minimum lower limit of the second shell or the minimum 
angle allowed in degrees.</li>
<li>Eightth item: The maximum upper limit of the second or the maximum 
angle allowed in degrees.</li>
<li>Nineth item: The minimum lower limit of the third shell or the minimum 
angle allowed in degrees.</li>
<li>Tenth item: The maximum upper limit of the third or the maximum 
angle allowed in degrees.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">(</span><span class="n">Butane</span><span class="p">):</span>  <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;BUT&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span> <span class="mi">290</span><span class="p">,</span><span class="mi">330</span><span class="p">),</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (StdErr) of data not satisfying constraint conditions.</p>
<div class="math">
\[StdErr = \sum \limits_{i}^{C} 
( \theta_{i} - \theta_{i}^{min} ) ^{2} 
\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta
+
( \theta_{i} - \theta_{i}^{max} ) ^{2} 
\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta\]</div>
<p>Where:</p>
<p><span class="math">\(C\)</span> is the total number of defined improper angles constraints.</p>
<p><span class="math">\(\theta_{i}^{min}\)</span> is the improper angle constraint lower limit set for constraint i.</p>
<p><span class="math">\(\theta_{i}^{max}\)</span> is the improper angle constraint upper limit set for constraint i.</p>
<p><span class="math">\(\theta_{i}\)</span> is the improper angle computed for constraint i.</p>
<p><span class="math">\(\delta\)</span> is the Dirac delta function.</p>
<p><span class="math">\(\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta\)</span> 
is equal to 1 if <span class="math">\(0 \leqslant \theta_{i} \leqslant \theta_{i}^{min}\)</span> and 0 elsewhere.</p>
<p><span class="math">\(\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta\)</span> 
is equal to 1 if <span class="math">\(\theta_{i}^{max} \leqslant \theta_{i} \leqslant \pi\)</span> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute standardError.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputation of atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputation of atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>nbins=20</em>, <em>subplots=True</em>, <em>split=None</em>, <em>wspace=0.3</em>, <em>hspace=0.3</em>, <em>histtype='bar'</em>, <em>lineWidth=None</em>, <em>lineColor=None</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=1</em>, <em>legendLoc='best'</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot dihedral angles constraint distribution histogram.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic">
<li><p class="first">ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If ax is given,  subplots parameters will be omitted. 
If None is given a new plot figure will be created.</p>
</li>
<li><p class="first">nbins (int): number of bins in histogram.</p>
</li>
<li><p class="first">subplots (boolean): Whether to add plot constraint on multiple axes.</p>
</li>
<li><p class="first">split (None, &#8216;name&#8217;, &#8216;element&#8217;): To split plots into histogram per atom 
names, elements in addition to lower and upper bounds. If None histograms 
will be built from lower and upper bounds only.</p>
</li>
<li><p class="first">wspace (float): The amount of width reserved for blank space between 
subplots, expressed as a fraction of the average axis width.</p>
</li>
<li><p class="first">hspace (float): The amount of height reserved for white space between 
subplots, expressed as a fraction of the average axis height.</p>
</li>
<li><dl class="first docutils">
<dt>histtype (string): the histogram type. optional among</dt>
<dd><p class="first last">[&#8216;bar&#8217;, &#8216;barstacked&#8217;, &#8216;step&#8217;, &#8216;stepfilled&#8217;]</p>
</dd>
</dl>
</li>
<li><p class="first">lineWidth (None, integer): bars contour line width. If None then default
value will be given.</p>
</li>
<li><p class="first">lineColor (None, integer): bars contour line color. If None then default
value will be given.</p>
</li>
<li><p class="first">xlabel (boolean): Whether to create x label.</p>
</li>
<li><p class="first">xlabelSize (number): The x label font size.</p>
</li>
<li><p class="first">ylabel (boolean): Whether to create y label.</p>
</li>
<li><p class="first">ylabelSize (number): The y label font size.</p>
</li>
<li><p class="first">legend (boolean): Whether to create the legend or not</p>
</li>
<li><p class="first">legendCols (integer): Legend number of columns.</p>
</li>
<li><p class="first">legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</p>
</li>
<li><p class="first">title (boolean): Whether to create the title or not.</p>
</li>
<li><p class="first">titleStdErr (boolean): Whether to show constraint standard error value in title.</p>
</li>
<li><p class="first">titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</p>
</li>
<li><p class="first">titleUsedFrame(boolean): Whether to show used frame name in title.</p>
</li>
<li><p class="first">show (boolean): Whether to render and show figure before returning.</p>
</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes, List): matplotlib axes or a list of axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>delimiter='     '</em>, <em>comments='# '</em>, <em>split=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.DihedralAngleConstraints.DihedralAngleConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
<li>split (None, &#8216;name&#8217;, &#8216;element&#8217;): To split output into per atom names,
elements in addition to lower and upper bounds. If None output 
will be built from lower and upper bounds only.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.ImproperAngleConstraints">
<span id="improperangleconstraints"></span><h2>ImproperAngleConstraints<a class="headerlink" href="#module-fullrmc.Constraints.ImproperAngleConstraints" title="Permalink to this headline">¶</a></h2>
<p>ImproperAngleConstraints contains classes for all constraints related improper angles between atoms.</p>
<img src="_images/inheritance-81203c8e65508cabd7feeaf39dd30e1d09fef97a.png" alt="Inheritance diagram of fullrmc.Constraints.ImproperAngleConstraints" usemap="#inheritance2ec5cb74e8" class="inheritance"/>
<map id="inheritance2ec5cb74e8" name="inheritance2ec5cb74e8">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,29,235,53"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" target="_top" title="A rigid constraint is a constraint that doesn&#39;t count into the total standardError of the Engine." alt="" coords="292,5,404,29"/>
<area shape="rect" id="node5" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" target="_top" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="283,53,414,77"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,29,104,53"/>
<area shape="rect" id="node3" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint" target="_top" title="Controls the improper angle formed with 4 defined atoms. It&#39;s mainly used to " alt="" coords="462,29,631,53"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.ImproperAngleConstraints.</code><code class="descname">ImproperAngleConstraint</code><span class="sig-paren">(</span><em>rejectProbability=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></code></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></code></a></p>
<p>Controls the improper angle formed with 4 defined atoms. It&#8217;s mainly used to 
keep the improper atom in the plane defined with three other atoms. 
The improper vector is defined as the vector from the first atom of the plane to
the improper atom. Therefore the improper angle is defined between the improper
vector and the plane.</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/improperSketch.png"><img alt="_images/improperSketch.png" src="_images/improperSketch.png" style="width: 269px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Improper angle sketch defined between four atoms.</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<blockquote>
<div><iframe width="560" height="315" 
src="https://www.youtube.com/embed/qVATE-9cIBg" 
frameborder="0" allowfullscreen>
</iframe> </div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>rejectProbability (Number): rejecting probability of all steps where standardError increases. 
It must be between 0 and 1 where 1 means rejecting all steps where standardError increases
and 0 means accepting all steps regardless whether standardError increases or not.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">## Tetrahydrofuran (THF) molecule sketch</span>
<span class="c1">## </span>
<span class="c1">##              O</span>
<span class="c1">##   H41      /   \      H11</span>
<span class="c1">##      \  /         \  /</span>
<span class="c1">## H42-- C4    THF    C1 --H12</span>
<span class="c1">##        \  MOLECULE /</span>
<span class="c1">##         \         /</span>
<span class="c1">##   H31-- C3-------C2 --H21</span>
<span class="c1">##        /         \</span>
<span class="c1">##     H32            H22 </span>
<span class="c1">##</span>

<span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.ImproperAngleConstraints</span> <span class="kn">import</span> <span class="n">ImproperAngleConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">IAC</span> <span class="o">=</span> <span class="n">ImproperAngleConstraint</span><span class="p">()</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">IAC</span><span class="p">)</span>

<span class="c1"># define intra-molecular improper angles </span>
<span class="n">IAC</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
                                                            <span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="p">]</span> <span class="p">})</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.anglesList">
<code class="descname">anglesList</code><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.anglesList" title="Permalink to this definition">¶</a></dt>
<dd><p>Get improper angles list.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.angles">
<code class="descname">angles</code><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get angles dictionary for every and each atom.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.set_angles">
<code class="descname">set_angles</code><span class="sig-paren">(</span><em>anglesList</em>, <em>tform=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.set_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angles dictionary by parsing the anglesList list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><blockquote class="first">
<div><ol class="arabic">
<li><p class="first">anglesList (list): The angles list definition.</p>
<p>tuples format: every item must be a list of five items.</p>
<ol class="arabic simple">
<li>First item: The improper atom index that must be in the plane.</li>
<li>Second item: The index of the atom &#8216;O&#8217; considered the origin of the plane.</li>
<li>Third item: The index of the atom &#8216;x&#8217; used to calculated &#8216;Ox&#8217; vector.</li>
<li>Fourth item: The index of the atom &#8216;y&#8217; used to calculated &#8216;Oy&#8217; vector.</li>
<li>Fifth item: The minimum lower limit or the minimum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Sixth item: The maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
</ol>
<p>six vectors format: every item must be a list of five items.</p>
<ol class="arabic simple">
<li>First item: List containing improper atom indexes that must be in the plane.</li>
<li>Second item: List containing indexes of the atom &#8216;O&#8217; considered the origin of the plane.</li>
<li>Third item: List containing indexes of the atom &#8216;x&#8217; used to calculated &#8216;Ox&#8217; vector.</li>
<li>Fourth item: List containing indexes of the atom &#8216;y&#8217; used to calculated &#8216;Oy&#8217; vector.</li>
<li>Fifth item: List containing the minimum lower limit or the minimum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Sixth item: List containing the maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
</ol>
</li>
</ol>
</div></blockquote>
<ol class="last arabic simple">
<li>tform (boolean): set whether given anglesList follows tuples format, If not 
then it must follow the six vectors one.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.add_angle">
<code class="descname">add_angle</code><span class="sig-paren">(</span><em>angle</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.add_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a single angle to the list of constraint angles. All angles are in degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>angle (list): The angle list of five items.<ol class="arabic">
<li>First item: The central atom index.</li>
<li>Second item: The index of the left atom forming the angle (interchangeable with the right atom).</li>
<li>Third item: The index of the right atom forming the angle (interchangeable with the left atom).</li>
<li>Fourth item: The minimum lower limit or the minimum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Fifth item: The maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Sixth item: The maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.create_angles_by_definition">
<code class="descname">create_angles_by_definition</code><span class="sig-paren">(</span><em>anglesDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.create_angles_by_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates anglesList using angles definition. This calls set_angles(anglesMap) 
and generates angles attribute. All angles are in degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>anglesDefinition (dict): The angles definition. 
Every key must be a molecule name (residue name in pdb file). 
Every key value must be a list of angles definitions. 
Every angle definition is a list of five items where:<ol class="arabic">
<li>First item: The name of the improper atom that must be in the plane.</li>
<li>Second item: The name of the atom &#8216;O&#8217; considered the origin of the plane.</li>
<li>Third item: The name of the atom &#8216;x&#8217; used to calculated &#8216;Ox&#8217; vector.</li>
<li>Fourth item: The name of the atom &#8216;y&#8217; used to calculated &#8216;Oy&#8217; vector.</li>
<li>Fifth item: The minimum lower limit or the minimum angle allowed 
in degrees which later will be converted to rad.</li>
<li>Sixth item: The maximum upper limit or the maximum angle allowed 
in degrees which later will be converted to rad.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="p">(</span><span class="n">Benzene</span><span class="p">):</span>  <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;BENZ&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;C5&#39;</span><span class="p">,</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (StdErr) of data not satisfying constraint conditions.</p>
<div class="math">
\[StdErr = \sum \limits_{i}^{C} 
( \theta_{i} - \theta_{i}^{min} ) ^{2} 
\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta
+
( \theta_{i} - \theta_{i}^{max} ) ^{2} 
\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta\]</div>
<p>Where:</p>
<p><span class="math">\(C\)</span> is the total number of defined improper angles constraints.</p>
<p><span class="math">\(\theta_{i}^{min}\)</span> is the improper angle constraint lower limit set for constraint i.</p>
<p><span class="math">\(\theta_{i}^{max}\)</span> is the improper angle constraint upper limit set for constraint i.</p>
<p><span class="math">\(\theta_{i}\)</span> is the improper angle computed for constraint i.</p>
<p><span class="math">\(\delta\)</span> is the Dirac delta function.</p>
<p><span class="math">\(\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta\)</span> 
is equal to 1 if <span class="math">\(0 \leqslant \theta_{i} \leqslant \theta_{i}^{min}\)</span> and 0 elsewhere.</p>
<p><span class="math">\(\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta\)</span> 
is equal to 1 if <span class="math">\(\theta_{i}^{max} \leqslant \theta_{i} \leqslant \pi\)</span> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute standardError.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms relative indexes the move 
will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputation of atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputation of atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): atom index as a numpy array of a single 
element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>nbins=50</em>, <em>subplots=True</em>, <em>split=None</em>, <em>wspace=0.3</em>, <em>hspace=0.3</em>, <em>histtype='bar'</em>, <em>lineWidth=None</em>, <em>lineColor=None</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=1</em>, <em>legendLoc='best'</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot improper angles constraint distribution histogram.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic">
<li><p class="first">ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If ax is given,  subplots parameters will be omitted. 
If None is given a new plot figure will be created.</p>
</li>
<li><p class="first">nbins (int): number of bins in histogram.</p>
</li>
<li><p class="first">subplots (boolean): Whether to add plot constraint on multiple axes.</p>
</li>
<li><p class="first">split (None, &#8216;name&#8217;, &#8216;element&#8217;): To split plots into histogram per atom 
names, elements in addition to lower and upper bounds. If None histograms 
will be built from lower and upper bounds only.</p>
</li>
<li><p class="first">wspace (float): The amount of width reserved for blank space between 
subplots, expressed as a fraction of the average axis width.</p>
</li>
<li><p class="first">hspace (float): The amount of height reserved for white space between 
subplots, expressed as a fraction of the average axis height.</p>
</li>
<li><dl class="first docutils">
<dt>histtype (string): the histogram type. optional among</dt>
<dd><p class="first last">[&#8216;bar&#8217;, &#8216;barstacked&#8217;, &#8216;step&#8217;, &#8216;stepfilled&#8217;]</p>
</dd>
</dl>
</li>
<li><p class="first">lineWidth (None, integer): bars contour line width. If None then default
value will be given.</p>
</li>
<li><p class="first">lineColor (None, integer): bars contour line color. If None then default
value will be given.</p>
</li>
<li><p class="first">xlabel (boolean): Whether to create x label.</p>
</li>
<li><p class="first">xlabelSize (number): The x label font size.</p>
</li>
<li><p class="first">ylabel (boolean): Whether to create y label.</p>
</li>
<li><p class="first">ylabelSize (number): The y label font size.</p>
</li>
<li><p class="first">legend (boolean): Whether to create the legend or not</p>
</li>
<li><p class="first">legendCols (integer): Legend number of columns.</p>
</li>
<li><p class="first">legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</p>
</li>
<li><p class="first">title (boolean): Whether to create the title or not.</p>
</li>
<li><p class="first">titleStdErr (boolean): Whether to show constraint standard error value in title.</p>
</li>
<li><p class="first">titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</p>
</li>
<li><p class="first">titleUsedFrame(boolean): Whether to show used frame name in title.</p>
</li>
<li><p class="first">show (boolean): Whether to render and show figure before returning.</p>
</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes, List): matplotlib axes or a list of axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/improper_angle_constraint_plot_method.png"><img alt="_images/improper_angle_constraint_plot_method.png" src="_images/improper_angle_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>delimiter='     '</em>, <em>comments='# '</em>, <em>split=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
<li>split (None, &#8216;name&#8217;, &#8216;element&#8217;): To split output into per atom names,
elements in addition to lower and upper bounds. If None output 
will be built from lower and upper bounds only.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.PairDistributionConstraints">
<span id="pairdistributionconstraints"></span><h2>PairDistributionConstraints<a class="headerlink" href="#module-fullrmc.Constraints.PairDistributionConstraints" title="Permalink to this headline">¶</a></h2>
<p>PairDistributionConstraints contains classes for all constraints related experimental pair distribution functions.</p>
<img src="_images/inheritance-42bccfa94513975196da65609377896a366ffef7.png" alt="Inheritance diagram of fullrmc.Constraints.PairDistributionConstraints" usemap="#inheritance6fb2cdd31b" class="inheritance"/>
<map id="inheritance6fb2cdd31b" name="inheritance6fb2cdd31b">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,5,235,29"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" target="_top" title="An ExperimentalConstraint is any constraint related to experimental data." alt="" coords="283,5,443,29"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,5,104,29"/>
<area shape="rect" id="node4" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" target="_top" title="It controls the total reduced pair distribution function (pdf) of the system noted as G(r). " alt="" coords="491,5,663,29"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.PairDistributionConstraints.</code><code class="descname">PairDistributionConstraint</code><span class="sig-paren">(</span><em>experimentalData</em>, <em>dataWeights=None</em>, <em>weighting='atomicNumber'</em>, <em>atomsWeight=None</em>, <em>scaleFactor=1.0</em>, <em>adjustScaleFactor=(0</em>, <em>0.8</em>, <em>1.2)</em>, <em>shapeFuncParams=None</em>, <em>windowFunction=None</em>, <em>limits=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" title="fullrmc.Core.Constraint.ExperimentalConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.ExperimentalConstraint</span></code></a></p>
<p>It controls the total reduced pair distribution function (pdf) of the system noted as G(r). 
The pair distribution function is directly calculated from powder diffraction experimental
data. It is obtained from the experimentally determined total-scattering structure 
function S(Q), by a Sine Fourier transform according to.</p>
<div class="math">
\[ \begin{align}\begin{aligned}G(r) = \frac{2}{\pi} \int_{0}^{\infty} Q [S(Q)-1]sin(Qr)dQ \\S(Q) = 1+ \frac{1}{Q} \int_{0}^{\infty} G(r) sin(Qr) dr\end{aligned}\end{align} \]</div>
<p>Theoretically G(r) oscillates around zero. Also <span class="math">\(G(r) \rightarrow 0\)</span> when <span class="math">\(r \rightarrow \infty\)</span>
and <span class="math">\(G(r) \rightarrow 0\)</span> when <span class="math">\(r \rightarrow 0\)</span> with a slope of <span class="math">\(-4\pi\rho_{0}\)</span> 
where <span class="math">\(\rho_{0}\)</span> is the number density of the material.</p>
<p>Model wise, G(r) is computed after calculating the so called Pair Correlation Function 
noted as g(r). The relation between G(r) and g(r) is given by</p>
<div class="math">
\[G(r) = 4 \pi r (\rho_{r} - \rho_{0})
     = 4 \pi \rho_{0} r (g(r)-1) 
     = \frac{R(r)}{r} - 4 \pi r \rho_{0}\]</div>
<p><span class="math">\(\rho_{r}\)</span> is the number density fluctuation at distance <span class="math">\(r\)</span>. 
The computation of g(r) is straightforward from an atomistic model and it is given
by <span class="math">\(g(r)=\rho_{r} / \rho_{0}\)</span>.</p>
<p><span class="math">\(R(r)\)</span> is called the radial distribution function. <span class="math">\(R(r)\)</span> is a very 
important function because it describes directly the system&#8217;s structure since
<span class="math">\(R(r)dr\)</span> gives the number of atoms in an annulus of thickness dr at distance 
r from another atom. Therefore, the coordination number, or the number 
of neighbors within the distances interval <span class="math">\([a,b]\)</span>
is given by <span class="math">\(\int_{a}^{b} R(r) dr\)</span></p>
<p>Finally, g(r) is calculated after binning all pair atomic distances into a weighted
histograms of values <span class="math">\(n(r)\)</span> from which local number densities are computed as in the following.</p>
<div class="math">
\[g(r) = \sum \limits_{i,j}^{N} w_{i,j} \frac{\rho_{i,j}(r)}{\rho_{0}} 
     = \sum \limits_{i,j}^{N} w_{i,j} \frac{n_{i,j}(r) / v(r)}{N_{i,j} / V} \]</div>
<p>Where:</p>
<p><span class="math">\(Q\)</span> is the momentum transfer.</p>
<p><span class="math">\(r\)</span> is the distance between two atoms.</p>
<p><span class="math">\(\rho_{i,j}(r)\)</span> is the pair density function of atoms i and j.</p>
<p><span class="math">\(\rho_{0}\)</span> is the  average number density of the system.</p>
<p><span class="math">\(w_{i,j}\)</span> is the relative weighting of atom types i and j.</p>
<p><span class="math">\(R(r)\)</span> is the radial distribution function (rdf).</p>
<p><span class="math">\(N\)</span> is the total number of atoms.</p>
<p><span class="math">\(V\)</span> is the volume of the system.</p>
<p><span class="math">\(n_{i,j}(r)\)</span> is the number of atoms i neighbouring j at a distance r.</p>
<p><span class="math">\(v(r)\)</span> is the annulus volume at distance r and of thickness dr.</p>
<p><span class="math">\(N_{i,j}\)</span> is the total number of atoms i and j in the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</p>
</li>
<li><p class="first">dataWeights (None, numpy.ndarray): A weights array of the same number of points of experimentalData used in the constraint&#8217;s standard error computation.
Therefore particular fitting emphasis can be put on different data points that might be considered as more or less
important in order to get a reasonable and plausible modal.</p>
<p>If None is given, all data points are considered of the same importance in the computation of the constraint&#8217;s standard error.</p>
<p>If numpy.ndarray is given, all weights must be positive and all zeros weighted data points won&#8217;t contribute to the 
total constraint&#8217;s standard error. At least a single weight point is required to be non-zeros and the weights 
array will be automatically scaled upon setting such as the the sum of all the weights is equal to the number of data points.</p>
</li>
<li><p class="first">weighting (string): The elements weighting.</p>
</li>
<li><p class="first">atomsWeight (None, dict): Atoms weight dictionary where keys are atoms 
element and values are custom weights. If None, elements weighting will be
fully set given weighting. If partially given, remaining non specified 
atom weights will be set using given weighting.</p>
</li>
<li><p class="first">scaleFactor (number): A normalization scale factor used to normalize the computed data to the experimental ones.</p>
</li>
<li><p class="first">adjustScaleFactor (list, tuple): Used to adjust fit or guess the best scale factor during EMC runtime. 
It must be a list of exactly three entries.</p>
<ol class="arabic simple">
<li>The frequency in number of generated moves of finding the best scale factor. 
If 0 frequency is given, it means that the scale factor is fixed.</li>
<li>The minimum allowed scale factor value.</li>
<li>The maximum allowed scale factor value.</li>
</ol>
</li>
<li><p class="first">shapeFuncParams (None, numpy.ndarray, dict): The shape function is subtracted from the total G(r). 
It must be used when non-periodic boundary conditions are used to take into account the atomic 
density drop and to correct for the <span class="math">\(\rho_{0}\)</span> approximation. The shape function can be 
set to None which means unsused, or set as a constant shape given by a numpy.ndarray or computed 
from all atoms and updated every &#8216;updateFreq&#8217; accepted moves. 
If dict is given the following keywords can be given, otherwise default 
values will be automatically set.</p>
<ul class="simple">
<li><strong>rmin (number) default (0.00) :</strong> The minimum distance in <span class="math">\(\AA\)</span> considered 
upon building the histogram prior to computing the shape function.</li>
<li><strong>rmax (None, number) default (None) :</strong> The maximum distance in <span class="math">\(\AA\)</span> 
considered upon building the histogram prior to computing the shape function.
If None is  given, rmax will be set at automatically to
<span class="math">\(maximum\ box\ length + 10\AA\)</span> at engine runtime.</li>
<li><strong>dr (number) default (0.5) :</strong> The bin size in <span class="math">\(\AA\)</span> considered upon 
building the histogram prior to computing the shape function.</li>
<li><strong>qmin (number) default (0.001) :</strong> The minimum reciprocal distance q in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li><strong>qmax (number) default (0.75) :</strong> The maximum reciprocal distance q in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li><strong>dq (number) default (0.005) :</strong> The reciprocal distance bin size in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li><strong>updateFreq (integer) default (1000) :</strong> The frequency of recomputing
the shape function in number of accpeted moves.</li>
</ul>
</li>
<li><p class="first">windowFunction (None, numpy.ndarray): The window function to convolute with the computed pair distribution function
of the system prior to comparing it with the experimental data. In general, the experimental pair
distribution function G(r) shows artificial wrinkles, among others the main reason is because G(r) is computed
by applying a sine Fourier transform to the experimental structure factor S(q). Therefore window function is
used to best imitate the numerical artefacts in the experimental data.</p>
</li>
<li><p class="first">limits (None, tuple, list): The distance limits to compute the histograms.
If None, the limits will be automatically set the the min and max distance of the experimental data.
If not None, a tuple of exactly two items where the first is the minimum distance or None 
and the second is the maximum distance or None.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p><strong>NB</strong>: If adjustScaleFactor first item (frequency) is 0, the scale factor will remain 
untouched and the limits minimum and maximum won&#8217;t be checked.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.PairDistributionConstraints</span> <span class="kn">import</span> <span class="n">PairDistributionConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">PDC</span> <span class="o">=</span> <span class="n">PairDistributionConstraint</span><span class="p">(</span><span class="n">experimentalData</span><span class="o">=</span><span class="s2">&quot;pdf.dat&quot;</span><span class="p">,</span> <span class="n">weighting</span><span class="o">=</span><span class="s2">&quot;atomicNumber&quot;</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">PDC</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.bin">
<code class="descname">bin</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances bin.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.minimumDistance">
<code class="descname">minimumDistance</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.minimumDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances minimum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.maximumDistance">
<code class="descname">maximumDistance</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.maximumDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances maximum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.histogramSize">
<code class="descname">histogramSize</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.histogramSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the histogram size.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.experimentalDistances">
<code class="descname">experimentalDistances</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.experimentalDistances" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the experimental distances array.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shellCenters">
<code class="descname">shellCenters</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shellCenters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the shells center array.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shellVolumes">
<code class="descname">shellVolumes</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shellVolumes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the shells volume array.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.experimentalPDF">
<code class="descname">experimentalPDF</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.experimentalPDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the experimental pdf.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.elementsPairs">
<code class="descname">elementsPairs</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.elementsPairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.weighting">
<code class="descname">weighting</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.weighting" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements weighting definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.atomsWeight">
<code class="descname">atomsWeight</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.atomsWeight" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom atoms weight</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.weightingScheme">
<code class="descname">weightingScheme</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.weightingScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements weighting scheme.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.windowFunction">
<code class="descname">windowFunction</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.windowFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the window function.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.limits">
<code class="descname">limits</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.limits" title="Permalink to this definition">¶</a></dt>
<dd><p>The histogram computation limits.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shapeArray">
<code class="descname">shapeArray</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shapeArray" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape array.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shapeUpdateFreq">
<code class="descname">shapeUpdateFreq</code><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shapeUpdateFreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Get shape function update frequency.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_shape_function_parameters">
<code class="descname">set_shape_function_parameters</code><span class="sig-paren">(</span><em>shapeFuncParams</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_shape_function_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the shape function. The shape function can be set to None which means
unsused, or set as a constant shape given by a numpy.ndarray or computed 
from all atoms and updated every &#8216;updateFreq&#8217; accepted moves. The 
shape function is subtracted from the total G(r). It must be used
when non-periodic boundary conditions are used to take into account
the atomic density drop and to correct for the <span class="math">\(\rho_{0}\)</span> 
approximation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">shapeFuncParams (None, numpy.ndarray, dict): The shape function parameters.</p>
<p>In case None is given, no shape function is given nor will be calculated .</p>
<p>If numpy.ndarray is given, shape function will be set as fixed. 
Normally this can be the case when the model shape is known beforehand 
(e.g. small angle experimental data).</p>
<p>If dict is given the following keywords can be given, otherwise default 
values will be automatically set.</p>
<ul class="simple">
<li><strong>rmin (number) default (0.00) :</strong> The minimum distance in <span class="math">\(\AA\)</span> considered 
upon building the histogram prior to computing the shape function.</li>
<li><strong>rmax (None, number) default (None) :</strong> The maximum distance in <span class="math">\(\AA\)</span> 
considered upon building the histogram prior to computing the shape function.
If None is  given, rmax will be set at automatically to
<span class="math">\(maximum\ box\ length + 10\AA\)</span> at engine runtime.</li>
<li><strong>dr (number) default (0.5) :</strong> The bin size in <span class="math">\(\AA\)</span> considered upon 
building the histogram prior to computing the shape function.</li>
<li><strong>qmin (number) default (0.001) :</strong> The minimum reciprocal distance q in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li><strong>qmax (number) default (0.75) :</strong> The maximum reciprocal distance q in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li><strong>dq (number) default (0.005) :</strong> The reciprocal distance bin size in 
<span class="math">\(\AA^{-1}\)</span> considered to compute the shape function.</li>
<li><strong>updateFreq (integer) default (1000) :</strong> The frequency of recomputing
the shape function in number of accpeted moves.</li>
</ul>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_weighting">
<code class="descname">set_weighting</code><span class="sig-paren">(</span><em>weighting</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_weighting" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets elements weighting. It must a valid entry of pdbParser atoms database</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>weighting (string): The elements weighting.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_atoms_weight">
<code class="descname">set_atoms_weight</code><span class="sig-paren">(</span><em>atomsWeight</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_atoms_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom set atoms weight. This is the way to setting a weightingScheme different
than the given weighting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>atomsWeight (None, dict): Atoms weight dictionary where keys are atoms 
element and values are custom weights. If None, elements weighting will be
fully set given weighting. If partially given, remaining non specified 
atom weights will be set using given weighting.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_window_function">
<code class="descname">set_window_function</code><span class="sig-paren">(</span><em>windowFunction</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_window_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the window function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>windowFunction (None, numpy.ndarray): The window function to convolute with the computed pair distribution function
of the system prior to comparing it with the experimental data. In general, the experimental pair
distribution function G(r) shows artificial wrinkles, among others the main reason is because G(r) is computed
by applying a sine Fourier transform to the experimental structure factor S(q). Therefore window function is
used to best imitate the numerical artefacts in the experimental data.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_experimental_data">
<code class="descname">set_experimental_data</code><span class="sig-paren">(</span><em>experimentalData</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_experimental_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the constraint&#8217;s experimental data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_data_weights">
<code class="descname">set_data_weights</code><span class="sig-paren">(</span><em>dataWeights</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_data_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Set experimental data points weight.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">dataWeights (None, numpy.ndarray): A weights array of the same number of points of experimentalData used in the constraint&#8217;s standard error computation.
Therefore particular fitting emphasis can be put on different data points that might be considered as more or less
important in order to get a reasonable and plausible modal.</p>
<p>If None is given, all data points are considered of the same importance in the computation of the constraint&#8217;s standard error.</p>
<p>If numpy.ndarray is given, all weights must be positive and all zeros weighted data points won&#8217;t contribute to the 
total constraint&#8217;s standard error. At least a single weight point is required to be non-zeros and the weights 
array will be automatically scaled upon setting such as the the sum of all the weights is equal to the number of data points.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_and_set_standard_error">
<code class="descname">compute_and_set_standard_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_and_set_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes and sets the constraint&#8217;s standardError.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_limits">
<code class="descname">set_limits</code><span class="sig-paren">(</span><em>limits</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the histogram computation limits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>limits (None, tuple, list): The distance limits to compute the histograms and compute with the experimental data.
If None, the limits will be automatically set the the min and max distance recorded in the experimental data.
If not None, a tuple of minimum distance or None and maximum distance or None should be given.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.check_experimental_data">
<code class="descname">check_experimental_data</code><span class="sig-paren">(</span><em>experimentalData</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.check_experimental_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether experimental data is correct.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>experimentalData (object): The experimental data to check.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): Whether it is correct or not.</li>
<li>message (str): Checking message that explains whats&#8217;s wrong with the given data</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>modelData</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (StdErr) as squared deviations 
between model computed data and the experimental ones.</p>
<div class="math">
\[StdErr = \sum \limits_{i}^{N} W_{i}(Y(X_{i})-F(X_{i}))^{2}\]</div>
<p>Where:</p>
<p><span class="math">\(N\)</span> is the total number of experimental data points.</p>
<p><span class="math">\(W_{i}\)</span> is the data point weight. It becomes equivalent to 1 when dataWeights is set to None.</p>
<p><span class="math">\(Y(X_{i})\)</span> is the experimental data point <span class="math">\(X_{i}\)</span>.</p>
<p><span class="math">\(F(X_{i})\)</span> is the computed from the model data  <span class="math">\(X_{i}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>modelData (numpy.ndarray): The data to compare with the experimental one and compute the squared deviation.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Pair Distribution Functions (PDFs).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>PDFs (dictionary): The PDFs dictionnary, where keys are the element wise intra and inter molecular PDFs and values are the computed PDFs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.get_constraint_original_value">
<code class="descname">get_constraint_original_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.get_constraint_original_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Pair Distribution Functions (PDFs).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>PDFs (dictionary): The PDFs dictionnary, where keys are the element wise intra and inter molecular PDFs and values are the computed PDFs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_as_if_amputated">
<code class="descname">compute_as_if_amputated</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_as_if_amputated" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return constraint&#8217;s data and standard error as if atom given its 
its was amputated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputated atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputated atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>intra=True</em>, <em>inter=True</em>, <em>shapeFunc=True</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=2</em>, <em>legendLoc='best'</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleScaleFactor=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If None is given a new plot figure will be created.</li>
<li>intra (boolean): Whether to add intra-molecular pair distribution function features to the plot.</li>
<li>inter (boolean): Whether to add inter-molecular pair distribution function features to the plot.</li>
<li>shapeFunc (boolean): Whether to add shape function to the plot only when exists.</li>
<li>xlabel (boolean): Whether to create x label.</li>
<li>xlabelSize (number): The x label font size.</li>
<li>ylabel (boolean): Whether to create y label.</li>
<li>ylabelSize (number): The y label font size.</li>
<li>legend (boolean): Whether to create the legend or not</li>
<li>legendCols (integer): Legend number of columns.</li>
<li>legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</li>
<li>title (boolean): Whether to create the title or not.</li>
<li>titleStdErr (boolean): Whether to show constraint standard error value in title.</li>
<li>titleScaleFactor (boolean): Whether to show contraint&#8217;s scale factor value in title.</li>
<li>titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</li>
<li>titleUsedFrame(boolean): Whether to show used frame name in title.</li>
<li>show (boolean): Whether to render and show figure before returning.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes): matplotlib used axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/pair_distribution_constraint_plot_method.png"><img alt="_images/pair_distribution_constraint_plot_method.png" src="_images/pair_distribution_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>format='%12.5f'</em>, <em>delimiter=' '</em>, <em>comments='# '</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>format (string): string format to export the data.
format is as follows (%[flag]width[.precision]specifier)</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.PairCorrelationConstraints">
<span id="paircorrelationconstraints"></span><h2>PairCorrelationConstraints<a class="headerlink" href="#module-fullrmc.Constraints.PairCorrelationConstraints" title="Permalink to this headline">¶</a></h2>
<p>PairCorrelationConstraint contains classes for all constraints related experimental pair correlation functions.</p>
<img src="_images/inheritance-9cad5138c0b70bd060430afe7d2815761d556d3a.png" alt="Inheritance diagram of fullrmc.Constraints.PairCorrelationConstraints" usemap="#inheritance225f361433" class="inheritance"/>
<map id="inheritance225f361433" name="inheritance225f361433">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,5,235,29"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" target="_top" title="An ExperimentalConstraint is any constraint related to experimental data." alt="" coords="283,5,443,29"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,5,104,29"/>
<area shape="rect" id="node5" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" target="_top" title="It controls the total reduced pair distribution function (pdf) of the system noted as G(r). " alt="" coords="491,5,663,29"/>
<area shape="rect" id="node4" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint" target="_top" title="It controls the total pair correlation function (pcf) of the system noted as g(r)." alt="" coords="711,5,882,29"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.PairCorrelationConstraints.</code><code class="descname">PairCorrelationConstraint</code><span class="sig-paren">(</span><em>experimentalData</em>, <em>dataWeights=None</em>, <em>weighting='atomicNumber'</em>, <em>atomsWeight=None</em>, <em>scaleFactor=1.0</em>, <em>adjustScaleFactor=(0</em>, <em>0.8</em>, <em>1.2)</em>, <em>shapeFuncParams=None</em>, <em>windowFunction=None</em>, <em>limits=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" title="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint</span></code></a></p>
<p>It controls the total pair correlation function (pcf) of the system noted as g(r).
pcf tells the probability of finding atomic pairs separated by the real space distance r.
Theoretically g(r) oscillates around 1. Also <span class="math">\(g(r) \rightarrow 1\)</span> when <span class="math">\(r \rightarrow \infty\)</span> 
and it takes the exact value of zero for <span class="math">\(r\)</span> shorter than the distance of the closest possible 
approach of pairs of atoms.</p>
<p>The pair correlation function g(r) and pair distribution function G(r) are directly 
related as in the following <span class="math">\(g(r)=1+(\frac{G(r)}{4 \pi \rho_{0} r})\)</span>.</p>
<p>g(r) is calculated after binning all pair atomic distances into a weighted
histograms of values <span class="math">\(n(r)\)</span> from which local number densities are computed as in the following.</p>
<div class="math">
\[g(r) = \sum \limits_{i,j}^{N} w_{i,j} \frac{\rho_{i,j}(r)}{\rho_{0}} 
     = \sum \limits_{i,j}^{N} w_{i,j} \frac{n_{i,j}(r) / v(r)}{N_{i,j} / V} \]</div>
<p>Where:</p>
<p><span class="math">\(r\)</span> is the distance between two atoms.</p>
<p><span class="math">\(\rho_{i,j}(r)\)</span> is the pair density function of atoms i and j.</p>
<p><span class="math">\(\rho_{0}\)</span> is the  average number density of the system.</p>
<p><span class="math">\(w_{i,j}\)</span> is the relative weighting of atom types i and j.</p>
<p><span class="math">\(N\)</span> is the total number of atoms.</p>
<p><span class="math">\(V\)</span> is the volume of the system.</p>
<p><span class="math">\(n_{i,j}(r)\)</span> is the number of atoms i neighbouring j at a distance r.</p>
<p><span class="math">\(v(r)\)</span> is the annulus volume at distance r and of thickness dr.</p>
<p><span class="math">\(N_{i,j}\)</span> is the total number of atoms i and j in the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body">Refer to <a class="reference internal" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" title="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint"><code class="xref py py-class docutils literal"><span class="pre">PairDistributionConstraint</span></code></a></td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.PairCorrelationConstraints</span> <span class="kn">import</span> <span class="n">PairCorrelationConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">PCC</span> <span class="o">=</span> <span class="n">PairCorrelationConstraint</span><span class="p">(</span><span class="n">experimentalData</span><span class="o">=</span><span class="s2">&quot;pcf.dat&quot;</span><span class="p">,</span> <span class="n">weighting</span><span class="o">=</span><span class="s2">&quot;atomicNumber&quot;</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">PCC</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Pair Distribution Functions (PDFs).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>PDFs (dictionary): The PDFs dictionnary, where keys are the element wise intra and inter molecular PDFs and values are the computed PDFs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_as_if_amputated">
<code class="descname">compute_as_if_amputated</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_as_if_amputated" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return constraint&#8217;s data and standard error as if atom given its 
its was amputated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>intra=True</em>, <em>inter=True</em>, <em>shapeFunc=True</em>, <em>legend=True</em>, <em>legendCols=2</em>, <em>legendLoc='best'</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleScaleFactor=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot pair correlation constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If None is given a new plot figure will be created.</li>
<li>intra (boolean): Whether to add intra-molecular pair distribution function features to the plot.</li>
<li>inter (boolean): Whether to add inter-molecular pair distribution function features to the plot.</li>
<li>shapeFunc (boolean): Whether to add shape function to the plot only when exists.</li>
<li>legend (boolean): Whether to create the legend or not</li>
<li>legendCols (integer): Legend number of columns.</li>
<li>legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</li>
<li>title (boolean): Whether to create the title or not.</li>
<li>titleStdErr (boolean): Whether to show constraint standard error value in title.</li>
<li>titleScaleFactor (boolean): Whether to show contraint&#8217;s scale factor value in title.</li>
<li>titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</li>
<li>titleUsedFrame(boolean): Whether to show used frame name in title.</li>
<li>show (boolean): Whether to render and show figure before returning.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes): matplotlib used axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/pair_correlation_constraint_plot_method.png"><img alt="_images/pair_correlation_constraint_plot_method.png" src="_images/pair_correlation_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>format='%12.5f'</em>, <em>delimiter=' '</em>, <em>comments='# '</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>format (string): string format to export the data.
format is as follows (%[flag]width[.precision]specifier)</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.StructureFactorConstraints">
<span id="structurefactorconstraints"></span><h2>StructureFactorConstraints<a class="headerlink" href="#module-fullrmc.Constraints.StructureFactorConstraints" title="Permalink to this headline">¶</a></h2>
<p>StructureFactorConstraints contains classes for all constraints related experimental static structure factor functions.</p>
<img src="_images/inheritance-49db69425ce8501dcc38e54407fa04fc8c15d50d.png" alt="Inheritance diagram of fullrmc.Constraints.StructureFactorConstraints" usemap="#inheritancecc47322566" class="inheritance"/>
<map id="inheritancecc47322566" name="inheritancecc47322566">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" target="_top" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="152,5,235,29"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" target="_top" title="An ExperimentalConstraint is any constraint related to experimental data." alt="" coords="283,5,443,29"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Collection.ListenerBase" target="_top" title="All listeners base class." alt="" coords="5,5,104,29"/>
<area shape="rect" id="node5" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint" target="_top" title="It controls the Structure Factor noted as S(Q) and also called" alt="" coords="491,5,664,29"/>
<area shape="rect" id="node4" href="#fullrmc.Constraints.StructureFactorConstraints.ReducedStructureFactorConstraint" target="_top" title="The Reduced Structure Factor that we will also note S(Q) " alt="" coords="712,5,940,29"/>
</map>
<dl class="class">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.StructureFactorConstraints.</code><code class="descname">StructureFactorConstraint</code><span class="sig-paren">(</span><em>experimentalData</em>, <em>dataWeights=None</em>, <em>weighting='atomicNumber'</em>, <em>atomsWeight=None</em>, <em>rmin=None</em>, <em>rmax=None</em>, <em>dr=None</em>, <em>scaleFactor=1.0</em>, <em>adjustScaleFactor=(0</em>, <em>0.8</em>, <em>1.2)</em>, <em>windowFunction=None</em>, <em>limits=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" title="fullrmc.Core.Constraint.ExperimentalConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.ExperimentalConstraint</span></code></a></p>
<p>It controls the Structure Factor noted as S(Q) and also called
total-scattering structure function or Static Structure Factor. 
S(Q) is a dimensionless quantity and the normalization is such 
that the average value, <span class="math">\(&lt;S(Q)&gt;=1\)</span>.</p>
<p>It is worth mentioning that S(Q) is nothing other than the normalized and 
corrected diffraction pattern from all experimental artefacts powder.</p>
<p>The computation of S(Q) is done through an inverse Sine Fourier transform  
of the computed pair distribution function noted as G(r).</p>
<div class="math">
\[S(Q) = 1+ \frac{1}{Q} \int_{0}^{\infty} G(r) sin(Qr) dr\]</div>
<p>From an atomistic model and histogram point of view, G(r) is computed as
the following:</p>
<div class="math">
\[G(r) = 4 \pi r (\rho_{r} - \rho_{0})
     = 4 \pi \rho_{0} r (g(r)-1) 
     = \frac{R(r)}{r} - 4 \pi \rho_{0}\]</div>
<p>g(r) is calculated after binning all pair atomic distances into a 
weighted histograms as the following:</p>
<div class="math">
\[g(r) = \sum \limits_{i,j}^{N} w_{i,j} \frac{\rho_{i,j}(r)}{\rho_{0}} 
     = \sum \limits_{i,j}^{N} w_{i,j} \frac{n_{i,j}(r) / v(r)}{N_{i,j} / V} \]</div>
<p>Where:</p>
<p><span class="math">\(Q\)</span> is the momentum transfer.</p>
<p><span class="math">\(r\)</span> is the distance between two atoms.</p>
<p><span class="math">\(\rho_{i,j}(r)\)</span> is the pair density function of atoms i and j.</p>
<p><span class="math">\(\rho_{0}\)</span> is the  average number density of the system.</p>
<p><span class="math">\(w_{i,j}\)</span> is the relative weighting of atom types i and j.</p>
<p><span class="math">\(R(r)\)</span> is the radial distribution function (rdf).</p>
<p><span class="math">\(N\)</span> is the total number of atoms.</p>
<p><span class="math">\(V\)</span> is the volume of the system.</p>
<p><span class="math">\(n_{i,j}(r)\)</span> is the number of atoms i neighbouring j at a distance r.</p>
<p><span class="math">\(v(r)\)</span> is the annulus volume at distance r and of thickness dr.</p>
<p><span class="math">\(N_{i,j}\)</span> is the total number of atoms i and j in the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</p>
</li>
<li><p class="first">dataWeights (None, numpy.ndarray): A weights array of the same number of points of experimentalData used in the constraint&#8217;s standard error computation.
Therefore particular fitting emphasis can be put on different data points that might be considered as more or less
important in order to get a reasonable and plausible modal.</p>
<p>If None is given, all data points are considered of the same importance in the computation of the constraint&#8217;s standard error.</p>
<p>If numpy.ndarray is given, all weights must be positive and all zeros weighted data points won&#8217;t contribute to the 
total constraint&#8217;s standard error. At least a single weight point is required to be non-zeros and the weights 
array will be automatically scaled upon setting such as the the sum of all the weights is equal to the number of data points.</p>
</li>
<li><p class="first">weighting (string): The elements weighting.</p>
</li>
<li><p class="first">atomsWeight (None, dict): Atoms weight dictionary where keys are atoms 
element and values are custom weights. If None, elements weighting will be
fully set given weighting. If partially given, remaining non specified 
atom weights will be set using given weighting.</p>
</li>
<li><p class="first">rmin (None, number): The minimum distance value to compute G(r) histogram.
If None is given, rmin is computed as <span class="math">\(2 \pi / Q_{max}\)</span>.</p>
</li>
<li><p class="first">rmax (None, number): The maximum distance value to compute G(r) histogram.
If None is given, rmax is computed as <span class="math">\(2 \pi / dQ\)</span>.</p>
</li>
<li><p class="first">dr (None, number): The distance bin value to compute G(r) histogram.
If None is given, bin is computed as <span class="math">\(2 \pi / (Q_{max}-Q_{min})\)</span>.</p>
</li>
<li><p class="first">scaleFactor (number): A normalization scale factor used to normalize the computed data to the experimental ones.</p>
</li>
<li><p class="first">adjustScaleFactor (list, tuple): Used to adjust fit or guess the best scale factor during EMC runtime. 
It must be a list of exactly three entries.</p>
<ol class="arabic simple">
<li>The frequency in number of generated moves of finding the best scale factor. 
If 0 frequency is given, it means that the scale factor is fixed.</li>
<li>The minimum allowed scale factor value.</li>
<li>The maximum allowed scale factor value.</li>
</ol>
</li>
<li><p class="first">windowFunction (None, numpy.ndarray): The window function to convolute with the computed pair distribution function
of the system prior to comparing it with the experimental data. In general, the experimental pair
distribution function G(r) shows artificial wrinkles, among others the main reason is because G(r) is computed
by applying a sine Fourier transform to the experimental structure factor S(q). Therefore window function is
used to best imitate the numerical artefacts in the experimental data.</p>
</li>
<li><p class="first">limits (None, tuple, list): The distance limits to compute the histograms.
If None, the limits will be automatically set the the min and max distance of the experimental data.
If not None, a tuple of exactly two items where the first is the minimum distance or None 
and the second is the maximum distance or None.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p><strong>NB</strong>: If adjustScaleFactor first item (frequency) is 0, the scale factor will remain 
untouched and the limits minimum and maximum won&#8217;t be checked.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># import fullrmc modules</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.StructureFactorConstraints</span> <span class="kn">import</span> <span class="n">StructureFactorConstraint</span>

<span class="c1"># create engine </span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;my_engine.rmc&#39;</span><span class="p">)</span>

<span class="c1"># set pdb file</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_pdb</span><span class="p">(</span><span class="s1">&#39;system.pdb&#39;</span><span class="p">)</span>

<span class="c1"># create and add constraint</span>
<span class="n">SFC</span> <span class="o">=</span> <span class="n">StructureFactorConstraint</span><span class="p">(</span><span class="n">experimentalData</span><span class="o">=</span><span class="s2">&quot;sq.dat&quot;</span><span class="p">,</span> <span class="n">weighting</span><span class="o">=</span><span class="s2">&quot;atomicNumber&quot;</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">(</span><span class="n">SFC</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.rmin">
<code class="descname">rmin</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.rmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the given histogram minimum distance.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.rmax">
<code class="descname">rmax</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.rmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the given histogram maximum distance.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.dr">
<code class="descname">dr</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.dr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the given histogram bin size.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.bin">
<code class="descname">bin</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the computed histogram distance bin size.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.minimumDistance">
<code class="descname">minimumDistance</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.minimumDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the computed histogram minimum distance.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.maximumDistance">
<code class="descname">maximumDistance</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.maximumDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the computed histogram maximum distance.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.qmin">
<code class="descname">qmin</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.qmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the experimental data reciprocal distances minimum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.qmax">
<code class="descname">qmax</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.qmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the experimental data reciprocal distances maximum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.dq">
<code class="descname">dq</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.dq" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the experimental data reciprocal distances bin size.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.experimentalQValues">
<code class="descname">experimentalQValues</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.experimentalQValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data used q values.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.histogramSize">
<code class="descname">histogramSize</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.histogramSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the histogram size</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.shellCenters">
<code class="descname">shellCenters</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.shellCenters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the shells center array</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.shellVolumes">
<code class="descname">shellVolumes</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.shellVolumes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the shells volume array</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.experimentalSF">
<code class="descname">experimentalSF</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.experimentalSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the experimental Structure Factor or S(q)</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.elementsPairs">
<code class="descname">elementsPairs</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.elementsPairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.atomsWeight">
<code class="descname">atomsWeight</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.atomsWeight" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom atoms weight</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.weightingScheme">
<code class="descname">weightingScheme</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.weightingScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements weighting scheme.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.windowFunction">
<code class="descname">windowFunction</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.windowFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the window function.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.limits">
<code class="descname">limits</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.limits" title="Permalink to this definition">¶</a></dt>
<dd><p>The histogram computation limits.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.Gr2SqMatrix">
<code class="descname">Gr2SqMatrix</code><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.Gr2SqMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get G(r) to S(q) transformation matrix.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>message</em>, <em>argument=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_rmin">
<code class="descname">set_rmin</code><span class="sig-paren">(</span><em>rmin</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_rmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Set rmin value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>rmin (None, number): The minimum distance value to compute G(r) histogram.
If None is given, rmin is computed as <span class="math">\(2 \pi / Q_{max}\)</span>.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_rmax">
<code class="descname">set_rmax</code><span class="sig-paren">(</span><em>rmax</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_rmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Set rmax value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>rmax (None, number): The maximum distance value to compute G(r) histogram.
If None is given, rmax is computed as <span class="math">\(2 \pi / dQ\)</span>.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_dr">
<code class="descname">set_dr</code><span class="sig-paren">(</span><em>dr</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_dr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set dr value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>dr (None, number): The distance bin value to compute G(r) histogram.
If None is given, bin is computed as <span class="math">\(2 \pi / (Q_{max}-Q_{min})\)</span>.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_weighting">
<code class="descname">set_weighting</code><span class="sig-paren">(</span><em>weighting</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_weighting" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets elements weighting. It must a valid entry of pdbParser atoms database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>weighting (string): The elements weighting.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_atoms_weight">
<code class="descname">set_atoms_weight</code><span class="sig-paren">(</span><em>atomsWeight</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_atoms_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom set atoms weight. This is the way to setting a weightingScheme different
than the given weighting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>atomsWeight (None, dict): Atoms weight dictionary where keys are atoms 
element and values are custom weights. If None, elements weighting will be
fully set given weighting. If partially given, remaining non specified 
atom weights will be set using given weighting.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_window_function">
<code class="descname">set_window_function</code><span class="sig-paren">(</span><em>windowFunction</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_window_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the window function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>windowFunction (None, numpy.ndarray): The window function to convolute with the computed pair distribution function
of the system prior to comparing it with the experimental data. In general, the experimental pair
distribution function G(r) shows artificial wrinkles, among others the main reason is because G(r) is computed
by applying a sine Fourier transform to the experimental structure factor S(q). Therefore window function is
used to best imitate the numerical artefacts in the experimental data.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_experimental_data">
<code class="descname">set_experimental_data</code><span class="sig-paren">(</span><em>experimentalData</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_experimental_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the constraint&#8217;s experimental data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_limits">
<code class="descname">set_limits</code><span class="sig-paren">(</span><em>limits</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the reciprocal distance limits (qmin, qmax).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>limits (None, tuple, list): The distance limits to compute the histograms and compute with the experimental data.
If None, the limits will be automatically set the the min and max reciprocal distance recorded in the experimental data.
If not None, a tuple of minimum reciprocal distance (qmin) or None and maximum reciprocal distance (qmax) or None should be given.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_data_weights">
<code class="descname">set_data_weights</code><span class="sig-paren">(</span><em>dataWeights</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.set_data_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Set experimental data points weight.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">dataWeights (None, numpy.ndarray): A weights array of the same number of points of experimentalData used in the constraint&#8217;s standard error computation.
Therefore particular fitting emphasis can be put on different data points that might be considered as more or less
important in order to get a reasonable and plausible modal.</p>
<p>If None is given, all data points are considered of the same importance in the computation of the constraint&#8217;s standard error.</p>
<p>If numpy.ndarray is given, all weights must be positive and all zeros weighted data points won&#8217;t contribute to the 
total constraint&#8217;s standard error. At least a single weight point is required to be non-zeros and the weights 
array will be automatically scaled upon setting such as the the sum of all the weights is equal to the number of data points.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_and_set_standard_error">
<code class="descname">compute_and_set_standard_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_and_set_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes and sets the constraint&#8217;s standardError.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.check_experimental_data">
<code class="descname">check_experimental_data</code><span class="sig-paren">(</span><em>experimentalData</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.check_experimental_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether experimental data is correct.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>experimentalData (object): The experimental data to check.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): Whether it is correct or not.</li>
<li>message (str): Checking message that explains whats&#8217;s wrong with the given data</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_standard_error">
<code class="descname">compute_standard_error</code><span class="sig-paren">(</span><em>modelData</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_standard_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the standard error (StdErr) as squared deviations
between model computed data and the experimental ones.</p>
<div class="math">
\[StdErr = \sum \limits_{i}^{N} W_{i}(Y(X_{i})-F(X_{i}))^{2}\]</div>
<p>Where:</p>
<p><span class="math">\(N\)</span> is the total number of experimental data points.</p>
<p><span class="math">\(W_{i}\)</span> is the data point weight. It becomes equivalent to 1 when dataWeights is set to None.</p>
<p><span class="math">\(Y(X_{i})\)</span> is the experimental data point <span class="math">\(X_{i}\)</span>.</p>
<p><span class="math">\(F(X_{i})\)</span> is the computed from the model data  <span class="math">\(X_{i}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>modelData (numpy.ndarray): The data to compare with the experimental one and compute the standard error.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>standardError (number): The calculated standardError of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.get_constraint_value">
<code class="descname">get_constraint_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Pair Distribution Functions (PDFs).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>PDFs (dictionary): The PDFs dictionnary, where keys are the element wise intra and inter molecular PDFs and values are the computed PDFs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.get_constraint_original_value">
<code class="descname">get_constraint_original_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.get_constraint_original_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Pair Distribution Functions (PDFs).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>PDFs (dictionary): The PDFs dictionnary, where keys are the element wise intra and inter molecular PDFs and values are the computed PDFs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_data">
<code class="descname">compute_data</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_before_move">
<code class="descname">compute_before_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_after_move">
<code class="descname">compute_after_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em>, <em>movedBoxCoordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.accept_move">
<code class="descname">accept_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.reject_move">
<code class="descname">reject_move</code><span class="sig-paren">(</span><em>realIndexes</em>, <em>relativeIndexes</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_as_if_amputated">
<code class="descname">compute_as_if_amputated</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.compute_as_if_amputated" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return constraint&#8217;s data and standard error as if atom given its 
its was amputated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>realIndex (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.accept_amputation">
<code class="descname">accept_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.accept_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept amputated atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.reject_amputation">
<code class="descname">reject_amputation</code><span class="sig-paren">(</span><em>realIndex</em>, <em>relativeIndex</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.reject_amputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject amputated atom and sets constraints data and standard error accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>index (numpy.ndarray): atom index as a numpy array of a single element.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax=None</em>, <em>intra=True</em>, <em>inter=True</em>, <em>xlabel=True</em>, <em>xlabelSize=16</em>, <em>ylabel=True</em>, <em>ylabelSize=16</em>, <em>legend=True</em>, <em>legendCols=2</em>, <em>legendLoc='best'</em>, <em>title=True</em>, <em>titleStdErr=True</em>, <em>titleScaleFactor=True</em>, <em>titleAtRem=True</em>, <em>titleUsedFrame=True</em>, <em>show=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot structure factor constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>ax (None, matplotlib Axes): matplotlib Axes instance to plot in.
If None is given a new plot figure will be created.</li>
<li>intra (boolean): Whether to add intra-molecular pair distribution 
function features to the plot.</li>
<li>inter (boolean): Whether to add inter-molecular pair distribution 
function features to the plot.</li>
<li>xlabel (boolean): Whether to create x label.</li>
<li>xlabelSize (number): The x label font size.</li>
<li>ylabel (boolean): Whether to create y label.</li>
<li>ylabelSize (number): The y label font size.</li>
<li>legend (boolean): Whether to create the legend or not</li>
<li>legendCols (integer): Legend number of columns.</li>
<li>legendLoc (string): The legend location. Anything among
&#8216;right&#8217;, &#8216;center left&#8217;, &#8216;upper right&#8217;, &#8216;lower right&#8217;, &#8216;best&#8217;, &#8216;center&#8217;, 
&#8216;lower left&#8217;, &#8216;center right&#8217;, &#8216;upper left&#8217;, &#8216;upper center&#8217;, &#8216;lower center&#8217;
is accepted.</li>
<li>title (boolean): Whether to create the title or not.</li>
<li>titleStdErr (boolean): Whether to show constraint standard error value in title.</li>
<li>titleScaleFactor (boolean): Whether to show contraint&#8217;s scale factor value in title.</li>
<li>titleAtRem (boolean): Whether to show engine&#8217;s number of removed atoms.</li>
<li>titleUsedFrame(boolean): Whether to show used frame name in title.</li>
<li>show (boolean): Whether to render and show figure before returning.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>figure (matplotlib Figure): matplotlib used figure.</li>
<li>axes (matplotlib Axes): matplotlib used axes.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/structure_factor_constraint_plot_method.png"><img alt="_images/structure_factor_constraint_plot_method.png" src="_images/structure_factor_constraint_plot_method.png" style="width: 530px; height: 400px;" /></a>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>fname</em>, <em>format='%12.5f'</em>, <em>delimiter=' '</em>, <em>comments='# '</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export pair distribution constraint.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>fname (path): full file name and path.</li>
<li>format (string): string format to export the data.
format is as follows (%[flag]width[.precision]specifier)</li>
<li>delimiter (string): String or character separating columns.</li>
<li>comments (string): String that will be prepended to the header.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fullrmc.Constraints.StructureFactorConstraints.ReducedStructureFactorConstraint">
<em class="property">class </em><code class="descclassname">fullrmc.Constraints.StructureFactorConstraints.</code><code class="descname">ReducedStructureFactorConstraint</code><span class="sig-paren">(</span><em>experimentalData</em>, <em>dataWeights=None</em>, <em>weighting='atomicNumber'</em>, <em>atomsWeight=None</em>, <em>rmin=None</em>, <em>rmax=None</em>, <em>dr=None</em>, <em>scaleFactor=1.0</em>, <em>adjustScaleFactor=(0</em>, <em>0.8</em>, <em>1.2)</em>, <em>windowFunction=None</em>, <em>limits=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullrmc.Constraints.StructureFactorConstraints.ReducedStructureFactorConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint" title="fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint"><code class="xref py py-class docutils literal"><span class="pre">fullrmc.Constraints.StructureFactorConstraints.StructureFactorConstraint</span></code></a></p>
<p>The Reduced Structure Factor that we will also note S(Q) 
is exactly the same quantity as the Structure Factor but with 
the slight difference that it is normalized to 0 rather than 1 
and therefore <span class="math">\(&lt;S(Q)&gt;=0\)</span>.</p>
<p>The computation of S(Q) is done through a Sine inverse Fourier transform  
of the computed pair distribution function noted as G(r).</p>
<div class="math">
\[S(Q) = \frac{1}{Q} \int_{0}^{\infty} G(r) sin(Qr) dr\]</div>
<p>The only reason why the Reduced Structure Factor is implemented, is because
many experimental data are treated in this form. And it is just convenient not
to manipulate the experimental data every time.</p>
</dd></dl>

</div>
</div>


        </div>
            </div>
        </div>
        
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">fullrmc.Constraints package</a><ul>
<li><a class="reference internal" href="#module-fullrmc.Constraints.Collection">Collection</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.DistanceConstraints">DistanceConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.AtomicCoordinationConstraints">CoordinationConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.BondConstraints">BondConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.AngleConstraints">AngleConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.DihedralAngleConstraints">DihedralAngleConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.ImproperAngleConstraints">ImproperAngleConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.PairDistributionConstraints">PairDistributionConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.PairCorrelationConstraints">PairCorrelationConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.StructureFactorConstraints">StructureFactorConstraints</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fullrmc.Generators.html"
                        title="previous chapter">fullrmc.Generators package</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        
        <div class="clearer"></div>
        </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a>
        </li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a>
             |
        
        </li>
        <li class="right" >
          <a href="fullrmc.Generators.html" title="fullrmc.Generators package"
             >previous</a>
             |
        
        </li>
        <li><a href="index.html">fullrmc 3.1.0, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
            <div class="footer">
                    &copy; Copyright 2015, Bachir Aoun.
            </div>
    </body>
</html>