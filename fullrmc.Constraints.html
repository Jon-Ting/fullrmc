<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fullrmc.Constraints package &mdash; fullrmc, the Reverse Monte Carlo (RMC) package</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="fullrmc, the Reverse Monte Carlo (RMC) package" href="index.html" />
    <link rel="prev" title="fullrmc.Generators package" href="fullrmc.Generators.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fullrmc.Generators.html" title="fullrmc.Generators package"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">fullrmc, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">fullrmc.Constraints package</a><ul>
<li><a class="reference internal" href="#module-fullrmc.Constraints.AngleConstraints">AngleConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.BondConstraints">BondConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.DistanceConstraints">DistanceConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.ImproperAngleConstraints">ImproperAngleConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.PairCorrelationConstraints">PairCorrelationConstraints</a></li>
<li><a class="reference internal" href="#module-fullrmc.Constraints.PairDistributionConstraints">PairDistributionConstraints</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fullrmc.Generators.html"
                        title="previous chapter">fullrmc.Generators package</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="fullrmc-constraints-package">
<h1>fullrmc.Constraints package<a class="headerlink" href="#fullrmc-constraints-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-fullrmc.Constraints.AngleConstraints">
<span id="angleconstraints"></span><h2>AngleConstraints<a class="headerlink" href="#module-fullrmc.Constraints.AngleConstraints" title="Permalink to this headline">¶</a></h2>
<p>AngleConstraints contains classes for all constraints related angles between atoms.</p>
<p class="graphviz">
<img src="_images/inheritance-2f135e7564e493aef9c2e733f73f00a652fa3912.png" alt="Inheritance diagram of fullrmc.Constraints.AngleConstraints" usemap="#inheritancebcea9c8ad8" class="inheritance"/>
<map id="inheritancebcea9c8ad8" name="inheritancebcea9c8ad8">
<area shape="rect" id="node1" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint" title="Its controls the angle between 3 defined atoms." alt="" coords="311,31,461,56"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="A rigid constraint is a constraint that doesn&#39;t count into the total squaredDeviations of the Engine." alt="" coords="143,5,254,31"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="135,55,263,80"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="5,31,87,56"/>
</map>
</p>
<dl class="class">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint">
<em class="property">class </em><tt class="descclassname">fullrmc.Constraints.AngleConstraints.</tt><tt class="descname">BondsAngleConstraint</tt><big>(</big><em>engine</em>, <em>anglesMap=None</em>, <em>rejectProbability=1</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></tt></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></tt></a></p>
<p>Its controls the angle between 3 defined atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">engine (None, fullrmc.Engine): The constraint RMC engine.</p>
</li>
<li><p class="first">anglesMap (list): The angles map definition.
Every item must be a list of five items.</p>
<blockquote>
<div><ol class="arabic simple">
<li>First item: The central atom index.</li>
<li>Second item: The index of the left atom forming the angle (interchangeable with the right atom).</li>
<li>Third item: The index of the right atom forming the angle (interchangeable with the left atom).</li>
<li>Fourth item: The minimum lower limit or the minimum angle allowed in rad.</li>
<li>Fifth item: The maximum upper limit or the maximum angle allowed in rad.</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">rejectProbability (Number): rejecting probability of all steps where squaredDeviations increases. 
It must be between 0 and 1 where 1 means rejecting all steps where squaredDeviations increases
and 0 means accepting all steps regardless whether squaredDeviations increases or not.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.accept_move">
<tt class="descname">accept_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.angles">
<tt class="descname">angles</tt><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get angles dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.anglesMap">
<tt class="descname">anglesMap</tt><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.anglesMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get angles map.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.atomsLUAD">
<tt class="descname">atomsLUAD</tt><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.atomsLUAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Get look up angles dictionary, connecting every atom&#8217;s index to a central atom angles definition of angles attribute.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_after_move">
<tt class="descname">compute_after_move</tt><big>(</big><em>indexes</em>, <em>movedBoxCoordinates</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_before_move">
<tt class="descname">compute_before_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_data">
<tt class="descname">compute_data</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_squared_deviations">
<tt class="descname">compute_squared_deviations</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.compute_squared_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the squared deviation of data not satisfying constraint conditions.</p>
<div class="math">
<p><img src="_images/math/3d9ee86fa78b31b38f9d6d4946554721724a8b84.png" alt="SD = \sum \limits_{i}^{C} 
( \theta_{i} - \theta_{i}^{min} ) ^{2} 
\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta
+
( \theta_{i} - \theta_{i}^{max} ) ^{2} 
\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta"/></p>
</div><p>Where:</p>
<p><img class="math" src="_images/math/2bcc65482aa8e15cd4c9e9f2542451fb4e971a91.png" alt="C"/> is the total number of defined angles constraints.</p>
<p><img class="math" src="_images/math/bde279daf7524455009b39a7741f8792f7a01b1d.png" alt="\theta_{i}^{min}"/> is the angle constraint lower limit set for constraint i.</p>
<p><img class="math" src="_images/math/0607887c23a5a929fc38e8c5da757f91cfc16017.png" alt="\theta_{i}^{max}"/> is the angle constraint upper limit set for constraint i.</p>
<p><img class="math" src="_images/math/208de4ca8bf1471b4286caaa7a4f0b132c947fb3.png" alt="\theta_{i}"/> is the angle computed for constraint i.</p>
<p><img class="math" src="_images/math/b35a9439ad8c8657b1b1d792ad5c2d77a52c0aef.png" alt="\delta"/> is the Dirac delta function.</p>
<p><img class="math" src="_images/math/9cf907cb8ae049fbfa35ff8062d4eac508fac782.png" alt="\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta"/> 
is equal to 1 if <img class="math" src="_images/math/c2ed2d5d68171b4e8adc27069443c9af7650757f.png" alt="0 \leqslant \theta_{i} \leqslant \theta_{i}^{min}"/> and 0 elsewhere.</p>
<p><img class="math" src="_images/math/a2ddb32bbf75f8e61796659c5477437e6c9f5c33.png" alt="\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta"/> 
is equal to 1 if <img class="math" src="_images/math/88c0f30ecb97403ce5beb84056dd7acb0b14cddc.png" alt="\theta_{i}^{max} \leqslant \theta_{i} \leqslant \pi"/> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute squaredDeviations.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>squaredDeviations (number): The calculated squaredDeviations of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.create_angles_by_definition">
<tt class="descname">create_angles_by_definition</tt><big>(</big><em>anglesDefinition</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.create_angles_by_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates anglesMap using angles definition.
Calls set_angles(anglesMap) and generates angles attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>anglesDefinition (dict): The angles definition. 
Every key must be a molecule name (residue name in pdb file). 
Every key value must be a list of angles definitions. 
Every angle definition is a list of five items where:<ol class="arabic">
<li>First item: The name of the central atom forming the angle.</li>
<li>Second item: The name of the left atom forming the angle (interchangeable with the right atom).</li>
<li>Third item: The name of the right atom forming the angle (interchangeable with the left atom).</li>
<li>Fourth item: The minimum lower limit or the minimum angle allowed in degrees.</li>
<li>Fifth item: The maximum upper limit or the maximum angle allowed in degrees.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre>e.g. (Carbon tetrachloride):  anglesDefinition={&quot;CCL4&quot;: [(&#39;C&#39;,&#39;CL1&#39;,&#39;CL2&#39; , 105, 115),
                                                         (&#39;C&#39;,&#39;CL2&#39;,&#39;CL3&#39; , 105, 115),
                                                         (&#39;C&#39;,&#39;CL3&#39;,&#39;CL4&#39; , 105, 115),                                      
                                                         (&#39;C&#39;,&#39;CL4&#39;,&#39;CL1&#39; , 105, 115) ] }
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.get_constraint_value">
<tt class="descname">get_constraint_value</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.listen">
<tt class="descname">listen</tt><big>(</big><em>message</em>, <em>argument=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.reject_move">
<tt class="descname">reject_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.set_angles">
<tt class="descname">set_angles</tt><big>(</big><em>anglesMap</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.set_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angles dictionary by parsing the anglesMap list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>anglesMap (list): The angles map definition.
Every item must be a list of five items.<ol class="arabic">
<li>First item: The central atom index.</li>
<li>Second item: The index of the left atom forming the angle (interchangeable with the right atom).</li>
<li>Third item: The index of the right atom forming the angle (interchangeable with the left atom).</li>
<li>Fourth item: The minimum lower limit or the minimum angle allowed in rad.</li>
<li>Fifth item: The maximum upper limit or the maximum angle allowed in rad.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.should_step_get_rejected">
<tt class="descname">should_step_get_rejected</tt><big>(</big><em>squaredDeviations</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.should_step_get_rejected" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloads &#8216;RigidConstraint&#8217; should_step_get_rejected method.
It computes whether to accept or reject a move based on before and after move calculation and not squaredDeviations.
If any of activeAtomsDataBeforeMove or activeAtomsDataAfterMove is None an Exception will get raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>squaredDeviations (number): not used in this case</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): True to reject step, False to accept</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.squaredDeviations">
<tt class="descname">squaredDeviations</tt><a class="headerlink" href="#fullrmc.Constraints.AngleConstraints.BondsAngleConstraint.squaredDeviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Get constraint&#8217;s current deviations square.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.BondConstraints">
<span id="bondconstraints"></span><h2>BondConstraints<a class="headerlink" href="#module-fullrmc.Constraints.BondConstraints" title="Permalink to this headline">¶</a></h2>
<p>BondConstraints contains classes for all constraints related bonds between atoms.</p>
<p class="graphviz">
<img src="_images/inheritance-5355870e0a3746e3c0e38b625c01e53a444f3c75.png" alt="Inheritance diagram of fullrmc.Constraints.BondConstraints" usemap="#inheritance8a1175d00c" class="inheritance"/>
<map id="inheritance8a1175d00c" name="inheritance8a1175d00c">
<area shape="rect" id="node1" href="#fullrmc.Constraints.BondConstraints.BondConstraint" title="Its controls the bond between 2 defined atoms." alt="" coords="311,31,421,56"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="A rigid constraint is a constraint that doesn&#39;t count into the total squaredDeviations of the Engine." alt="" coords="143,5,254,31"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="135,55,263,80"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="5,31,87,56"/>
</map>
</p>
<dl class="class">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint">
<em class="property">class </em><tt class="descclassname">fullrmc.Constraints.BondConstraints.</tt><tt class="descname">BondConstraint</tt><big>(</big><em>engine</em>, <em>bondsMap=None</em>, <em>rejectProbability=1</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></tt></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></tt></a></p>
<p>Its controls the bond between 2 defined atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">engine (None, fullrmc.Engine): The constraint RMC engine.</p>
</li>
<li><dl class="first docutils">
<dt>bondsMap (list): The bonds map definition.</dt>
<dd><p class="first">Every item must be a list of four items.</p>
<ol class="last arabic simple">
<li>First item is the first atom index.</li>
<li>Second item the second atom index forming the bond,</li>
<li>Third item: The lower limit or the minimum bond length allowed.</li>
<li>Fourth item: The upper limit or the maximum bond length allowed.</li>
</ol>
</dd>
</dl>
</li>
<li><p class="first">rejectProbability (Number): rejecting probability of all steps where squaredDeviations increases. 
It must be between 0 and 1 where 1 means rejecting all steps where squaredDeviations increases
and 0 means accepting all steps regardless whether squaredDeviations increases or not.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.accept_move">
<tt class="descname">accept_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.bonds">
<tt class="descname">bonds</tt><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get bonds dictionary</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.bondsMap">
<tt class="descname">bondsMap</tt><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.bondsMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get bonds map</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_after_move">
<tt class="descname">compute_after_move</tt><big>(</big><em>indexes</em>, <em>movedBoxCoordinates</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_before_move">
<tt class="descname">compute_before_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_data">
<tt class="descname">compute_data</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.compute_squared_deviations">
<tt class="descname">compute_squared_deviations</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.compute_squared_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the squared deviation of data not satisfying constraint conditions.</p>
<div class="math">
<p><img src="_images/math/d67e6c4d46fa450ad23f184e0295362c86996c1e.png" alt="SD = \sum \limits_{i}^{C} 
( \beta_{i} - \beta_{i}^{min} ) ^{2} 
\int_{0}^{\beta_{i}^{min}} \delta(\beta-\beta_{i}) d \beta
+
( \beta_{i} - \beta_{i}^{max} ) ^{2} 
\int_{\beta_{i}^{max}}^{\infty} \delta(\beta-\beta_{i}) d \beta"/></p>
</div><p>Where:</p>
<p><img class="math" src="_images/math/2bcc65482aa8e15cd4c9e9f2542451fb4e971a91.png" alt="C"/> is the total number of defined bonds constraints.</p>
<p><img class="math" src="_images/math/43997e4da990e3ca3088dfea78dd0167a0153ca1.png" alt="\beta_{i}^{min}"/> is the bond constraint lower limit set for constraint i.</p>
<p><img class="math" src="_images/math/4b6cd4fc93429c87ee4b4568b9fc4986eb2b9777.png" alt="\beta_{i}^{max}"/> is the bond constraint upper limit set for constraint i.</p>
<p><img class="math" src="_images/math/eef3e44d86ea5d84ed2324caddaf3f29312ad715.png" alt="\beta_{i}"/> is the bond length computed for constraint i.</p>
<p><img class="math" src="_images/math/b35a9439ad8c8657b1b1d792ad5c2d77a52c0aef.png" alt="\delta"/> is the Dirac delta function.</p>
<p><img class="math" src="_images/math/538abae3a1abe5a8f1152eed7ac7218033b5e050.png" alt="\int_{0}^{\beta_{i}^{min}} \delta(\beta-\beta_{i}) d \beta"/> 
is equal to 1 if <img class="math" src="_images/math/e7e6e3228af08171a33c2bcdd500987d93821c60.png" alt="0 \leqslant \beta_{i} \leqslant \beta_{i}^{min}"/> and 0 elsewhere.</p>
<p><img class="math" src="_images/math/5fd5df46b16f614e5dd8454385b072f94e1dc5a9.png" alt="\int_{\beta_{i}^{max}}^{\pi} \delta(\beta-\beta_{i}) d \beta"/> 
is equal to 1 if <img class="math" src="_images/math/8c41b24a2cb5275bcc2bcb26674fdc26e422a769.png" alt="\beta_{i}^{max} \leqslant \beta_{i} \leqslant \infty"/> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute squaredDeviations.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>squaredDeviations (number): The calculated squaredDeviations of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.create_bonds_by_definition">
<tt class="descname">create_bonds_by_definition</tt><big>(</big><em>bondsDefinition</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.create_bonds_by_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates bondsMap using bonds definition.
Calls set_bonds(bondsMap) and generates bonds attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><blockquote class="first">
<div><ol class="arabic simple">
<li>bondsDefinition (dict): The bonds definition. 
Every key must be a molecule name (residue name in pdb file). 
Every key value must be a list of bonds definitions. 
Every bond definition is a list of four items where:<ol class="arabic">
<li>First item: The name of the first atom forming the bond.</li>
<li>Second item: The name of the second atom forming the bond.</li>
<li>Third item: The lower limit or the minimum bond length allowed.</li>
<li>Fourth item: The upper limit or the maximum bond length allowed.</li>
</ol>
</li>
</ol>
</div></blockquote>
<div class="last highlight-python"><div class="highlight"><pre>e.g. (Carbon tetrachloride):  bondsDefinition={&quot;CCL4&quot;: [(&#39;C&#39;,&#39;CL1&#39; , 1.55, 1.95),
                                                        (&#39;C&#39;,&#39;CL2&#39; , 1.55, 1.95),
                                                        (&#39;C&#39;,&#39;CL3&#39; , 1.55, 1.95),                                       
                                                        (&#39;C&#39;,&#39;CL4&#39; , 1.55, 1.95) ] }
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.get_constraint_value">
<tt class="descname">get_constraint_value</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.listen">
<tt class="descname">listen</tt><big>(</big><em>message</em>, <em>argument=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.reject_move">
<tt class="descname">reject_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.set_bonds">
<tt class="descname">set_bonds</tt><big>(</big><em>bondsMap</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.set_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the bonds dictionary by parsing the bondsMap list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>bondsMap (list): The bonds map definition.
Every item must be a list of four items.<ol class="arabic">
<li>First item is the first atom index.</li>
<li>Second item the second atom index forming the bond,</li>
<li>Third item: The lower limit or the minimum bond length allowed.</li>
<li>Fourth item: The upper limit or the maximum bond length allowed.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.should_step_get_rejected">
<tt class="descname">should_step_get_rejected</tt><big>(</big><em>squaredDeviations</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.should_step_get_rejected" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloads &#8216;RigidConstraint&#8217; should_step_get_rejected method.
It computes whether to accept or reject a move based on before and after move calculation and not squaredDeviations.
If any of activeAtomsDataBeforeMove or activeAtomsDataAfterMove is None an Exception will get raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>squaredDeviations (number): not used in this case</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): True to reject step, False to accept</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.BondConstraints.BondConstraint.squaredDeviations">
<tt class="descname">squaredDeviations</tt><a class="headerlink" href="#fullrmc.Constraints.BondConstraints.BondConstraint.squaredDeviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Get constraint&#8217;s current squared deviation.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.DistanceConstraints">
<span id="distanceconstraints"></span><h2>DistanceConstraints<a class="headerlink" href="#module-fullrmc.Constraints.DistanceConstraints" title="Permalink to this headline">¶</a></h2>
<p>DistanceConstraints contains classes for all constraints related distances between atoms.</p>
<p class="graphviz">
<img src="_images/inheritance-c1278a8d430e387bfe20be084826cfea09bec855.png" alt="Inheritance diagram of fullrmc.Constraints.DistanceConstraints" usemap="#inheritancedfc0fe7ea3" class="inheritance"/>
<map id="inheritancedfc0fe7ea3" name="inheritancedfc0fe7ea3">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="5,31,87,56"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="A rigid constraint is a constraint that doesn&#39;t count into the total squaredDeviations of the Engine." alt="" coords="143,5,254,31"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="135,55,263,80"/>
<area shape="rect" id="node2" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint" title="Its controls the inter&#45;molecular distances between atoms." alt="" coords="311,5,524,31"/>
<area shape="rect" id="node5" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint" title="Its controls the intra&#45;molecular distances between atoms." alt="" coords="311,55,524,80"/>
</map>
</p>
<dl class="class">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint">
<em class="property">class </em><tt class="descclassname">fullrmc.Constraints.DistanceConstraints.</tt><tt class="descname">InterMolecularDistanceConstraint</tt><big>(</big><em>engine</em>, <em>defaultDistance=1.5</em>, <em>pairsDistance=None</em>, <em>rejectProbability=1</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></tt></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></tt></a></p>
<p>Its controls the inter-molecular distances between atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">engine (None, fullrmc.Engine): The constraint RMC engine.</p>
</li>
<li><p class="first">defaultDistance (number): The minimum distance allowed set by default for all atoms type.</p>
</li>
<li><p class="first">pairsDistance (None, list, set, tuple): The minimum distance set to every pair of elements. 
A list of tuples must be given, all missing pairs will get automatically assigned the given defaultMinimumDistance value.
First defined elements pair distance will cancel all redundant. 
If None is given all pairs will be automatically generated and assigned the given defaultMinimumDistance value</p>
<div class="highlight-python"><div class="highlight"><pre>e.g. [(&#39;h&#39;,&#39;h&#39;,1.5), (&#39;h&#39;,&#39;c&#39;,2.015), ...] 
</pre></div>
</div>
</li>
<li><p class="first">rejectProbability (Number): rejecting probability of all steps where squaredDeviations increases. 
It must be between 0 and 1 where 1 means rejecting all steps where squaredDeviations increases
and 0 means accepting all steps regardless whether squaredDeviations increases or not.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.accept_move">
<tt class="descname">accept_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_after_move">
<tt class="descname">compute_after_move</tt><big>(</big><em>indexes</em>, <em>movedBoxCoordinates</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_before_move">
<tt class="descname">compute_before_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_data">
<tt class="descname">compute_data</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_squared_deviations">
<tt class="descname">compute_squared_deviations</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.compute_squared_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the squared deviations (SD) of data not satisfying constraint conditions.</p>
<div class="math">
<p><img src="_images/math/696301d6fece54ff64069e9be5e998d199b47a7a.png" alt="SD = \sum \limits_{i}^{N} \sum \limits_{i+1}^{N} 
(d_{ij}-D_{ij})^{2} 
\int_{0}^{D_{ij}} \delta(x-d_{ij}) dx"/></p>
</div><p>Where:</p>
<p><img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> is the total number of atoms in the system.</p>
<p><img class="math" src="_images/math/389f5f02d38aef536e20d1df510ea84a95631691.png" alt="D_{ij}"/> is the distance constraint set for atoms pair (i,j).</p>
<p><img class="math" src="_images/math/a645d3806f9b2ede11f714ac9fd34fd142bb30d8.png" alt="d_{ij}"/> is the distance between atom i and atom j.</p>
<p><img class="math" src="_images/math/b35a9439ad8c8657b1b1d792ad5c2d77a52c0aef.png" alt="\delta"/> is the Dirac delta function.</p>
<p><img class="math" src="_images/math/bda2187b97ae22c4b4f7facbba8c48600c5ccaab.png" alt="\int_{0}^{D_{ij}} \delta(x-d_{ij}) dx"/> 
is equal to 1 if <img class="math" src="_images/math/29537596814506172bec41853e4439c209eb319a.png" alt="0 \leqslant d_{ij} \leqslant D_{ij}"/> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute squaredDeviations.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>squaredDeviations (number): The calculated squaredDeviations of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.defaultDistance">
<tt class="descname">defaultDistance</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.defaultDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances minimum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.elementsPairs">
<tt class="descname">elementsPairs</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.elementsPairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.get_constraint_value">
<tt class="descname">get_constraint_value</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.listen">
<tt class="descname">listen</tt><big>(</big><em>message</em>, <em>argument=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>listen to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.lowerLimitArray">
<tt class="descname">lowerLimitArray</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.lowerLimitArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lowerLimitArray used in distances calculation.
for InterMolecularDistanceConstraint it&#8217;s always a numpy.zeros array</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.pairsDistance">
<tt class="descname">pairsDistance</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.pairsDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.pairsDistanceDefinition">
<tt class="descname">pairsDistanceDefinition</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.pairsDistanceDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.reject_move">
<tt class="descname">reject_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_default_distance">
<tt class="descname">set_default_distance</tt><big>(</big><em>defaultDistance</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_default_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the default intermolecular minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>defaultDistance (number): The default minimum distance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_pairs_distance">
<tt class="descname">set_pairs_distance</tt><big>(</big><em>pairsDistance</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.set_pairs_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the pairs intermolecular minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">pairsDistance (None, list, set, tuple): The minimum distance set to every pair of elements. 
A list of tuples must be given, all missing pairs will get automatically assigned the given defaultMinimumDistance value.
First defined elements pair distance will cancel all redundant. 
If None is given all pairs will be automatically generated and assigned the given defaultMinimumDistance value</p>
<div class="highlight-python"><div class="highlight"><pre>e.g. [(&#39;h&#39;,&#39;h&#39;,1.5), (&#39;h&#39;,&#39;c&#39;,2.015), ...] 
</pre></div>
</div>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.upperLimitArray">
<tt class="descname">upperLimitArray</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.InterMolecularDistanceConstraint.upperLimitArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Get upperLimitArray used in distances calculation.
for InterMolecularDistanceConstraint it&#8217;s the minimum distance allowed between pair of intermolecular atoms</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint">
<em class="property">class </em><tt class="descclassname">fullrmc.Constraints.DistanceConstraints.</tt><tt class="descname">IntraMolecularDistanceConstraint</tt><big>(</big><em>engine</em>, <em>defaultMinDistance=0.67</em>, <em>typeDefinition='name'</em>, <em>pairsLimitsDefinition=None</em>, <em>rejectProbability=1</em>, <em>mode='distance'</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></tt></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></tt></a></p>
<p>Its controls the intra-molecular distances between atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">engine (None, fullrmc.Engine): The constraint RMC engine.</p>
</li>
<li><p class="first">defaultMinDistance (number): The minimum distance allowed set by default for all atoms type.</p>
</li>
<li><p class="first">typeDefinition (string): Can be either &#8216;element&#8217; or &#8216;name&#8217;. It sets the rules about how to differentiate between atoms and how to parse pairsLimits</p>
</li>
<li><p class="first">pairsLimitsDefinition (None, list, set, tuple): The lower and upper limits distance set to every pair of elements. 
A list of tuples must be given, all missing pairs will get automatically assigned the given defaultMinDistance to infinity value.
First defined elements pair distance will cancel all redundant. 
If None is given all pairs will be automatically generated and assigned the given defaultMinDistance to infinity value</p>
<div class="highlight-python"><div class="highlight"><pre>e.g. [(&#39;c&#39;,&#39;h&#39;,0.9, 1.2), ...] 
</pre></div>
</div>
</li>
<li><p class="first">rejectProbability (Number): rejecting probability of all steps where squaredDeviations increases. 
It must be between 0 and 1 where 1 means rejecting all steps where squaredDeviations increases
and 0 means accepting all steps regardless whether squaredDeviations increases or not.</p>
</li>
<li><p class="first">mode (string): Defines the way squaredDeviations is calculated. In such constraints the definition of squaredDeviations
can be confusing because many parameters play different roles in this type of calculation. The number of
unsatisfied constraint conditions is an important parameter and the reduced unsatisfied distances is another one.
Choosing a mode of calculation puts more weight and importance on a parameter. Allowed modes are:</p>
<blockquote>
<div><ol class="arabic simple">
<li>distance (Default): squaredDeviations is simply calculated as the square summation of the reduced out of limits distances.
This mode ensures minimizing the global unsatisfied distance of the constraint while additional atom-pairs unsatisfying constraint conditions can be created.</li>
<li>number: squaredDeviations is calculated such as the number of non-satisfied constraints must decrease 
from one step to another while the square summation of the reduced out of limits distances might increase.</li>
</ol>
</div></blockquote>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.accept_move">
<tt class="descname">accept_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.allTypes">
<tt class="descname">allTypes</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.allTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all atoms types.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_after_move">
<tt class="descname">compute_after_move</tt><big>(</big><em>indexes</em>, <em>movedBoxCoordinates</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_before_move">
<tt class="descname">compute_before_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_data">
<tt class="descname">compute_data</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_squared_deviations">
<tt class="descname">compute_squared_deviations</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.compute_squared_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the squared deviation of data not satisfying constraint conditions.</p>
<div class="math">
<p><img src="_images/math/67f124ff7064fb2533599b95b347d06d7985a236.png" alt="SD = \sum \limits_{i}^{N} \sum \limits_{i+1}^{N} (d_{ij}-D_{ij})^{2} \bigg( 1-\int_{0}^{d_{ij}} \delta(x-D_{ij}) dx \bigg)"/></p>
</div><p>Where:</p>
<p><img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> is the total number of atoms in the system.</p>
<p><img class="math" src="_images/math/389f5f02d38aef536e20d1df510ea84a95631691.png" alt="D_{ij}"/> is the distance constraint set for atoms pair (i,j).</p>
<p><img class="math" src="_images/math/a645d3806f9b2ede11f714ac9fd34fd142bb30d8.png" alt="d_{ij}"/> is the distance between atom i and atom j.</p>
<p><img class="math" src="_images/math/b35a9439ad8c8657b1b1d792ad5c2d77a52c0aef.png" alt="\delta"/> is the Dirac delta function.</p>
<p><img class="math" src="_images/math/1ac41033de14e1ba4409250718945eb519adba4b.png" alt="\int_{0}^{d_{ij}}\delta(x-D_{ij})dx"/> is equal to 0 if <img class="math" src="_images/math/d33b4284f389757446ff5644ec39b68d60b7ac21.png" alt="d_{ij}&lt;D_{ij}"/> and 1 when <img class="math" src="_images/math/94fd1a289d40db956de96447735557157db0d883.png" alt="d_{ij} \geqslant D_{ij}"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute squaredDeviations.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>squaredDeviations (number): The calculated squaredDeviations of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.defaultMinDistance">
<tt class="descname">defaultMinDistance</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.defaultMinDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances minimum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.existingSquaredDeviationsModes">
<tt class="descname">existingSquaredDeviationsModes</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.existingSquaredDeviationsModes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of defined squaredDeviations modes of calculation</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.get_constraint_value">
<tt class="descname">get_constraint_value</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.listen">
<tt class="descname">listen</tt><big>(</big><em>message</em>, <em>argument=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>listen to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>arguments (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.lowerLimitArray">
<tt class="descname">lowerLimitArray</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.lowerLimitArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lowerLimitArray used in distances calculation.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.mode">
<tt class="descname">mode</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mode of squaredDeviations calculation.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.numberOfAtomsPerType">
<tt class="descname">numberOfAtomsPerType</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.numberOfAtomsPerType" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of atoms per type dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.numberOfTypes">
<tt class="descname">numberOfTypes</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.numberOfTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of defined types in the configuration.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.pairsLimits">
<tt class="descname">pairsLimits</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.pairsLimits" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the normalized pairs limits definition</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.pairsLimitsDefinition">
<tt class="descname">pairsLimitsDefinition</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.pairsLimitsDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pairs limits definition as defined by user</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.reject_move">
<tt class="descname">reject_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_default_minimum_distance">
<tt class="descname">set_default_minimum_distance</tt><big>(</big><em>defaultMinDistance</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_default_minimum_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the default intermolecular minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>defaultMinDistance (number): The default minimum distance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_mode">
<tt class="descname">set_mode</tt><big>(</big><em>mode</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the squaredDeviations mode of calculation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>mode (object): The mode of calculation</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_pairs_limits">
<tt class="descname">set_pairs_limits</tt><big>(</big><em>pairsLimitsDefinition</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_pairs_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the pairs intermolecular minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">pairsLimitsDefinition (None, list, set, tuple): The lower and upper limits distance set to every pair of elements. 
A list of tuples must be given, all missing pairs will get automatically assigned the given defaultMinDistance to infinity value.
First defined elements pair distance will cancel all redundant. 
If None is given all pairs will be automatically generated and assigned the given defaultMinDistance to infinity value.</p>
<div class="highlight-python"><div class="highlight"><pre>e.g. [(&#39;c&#39;,&#39;h&#39;,0.9, 1.2), ...] 
</pre></div>
</div>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_type_definition">
<tt class="descname">set_type_definition</tt><big>(</big><em>typeDefinition</em>, <em>pairsLimitsDefinition=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.set_type_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Its an alias to set_pairs_limits with pairsLimits argument passed as the already defined pairsLimitsDefinitions</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typeDefinition">
<tt class="descname">typeDefinition</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typeDefinition" title="Permalink to this definition">¶</a></dt>
<dd><p>Get types definition.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.types">
<tt class="descname">types</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.types" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the defined types set.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typesIndexes">
<tt class="descname">typesIndexes</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typesIndexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get defined types indexes</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typesPairs">
<tt class="descname">typesPairs</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.typesPairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of pairs of types</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.upperLimitArray">
<tt class="descname">upperLimitArray</tt><a class="headerlink" href="#fullrmc.Constraints.DistanceConstraints.IntraMolecularDistanceConstraint.upperLimitArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Get upperLimitArray used in distances calculation.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.ImproperAngleConstraints">
<span id="improperangleconstraints"></span><h2>ImproperAngleConstraints<a class="headerlink" href="#module-fullrmc.Constraints.ImproperAngleConstraints" title="Permalink to this headline">¶</a></h2>
<p>ImproperAngleConstraints contains classes for all constraints related improper angles between atoms.</p>
<p class="graphviz">
<img src="_images/inheritance-b4f47bf87fb4293214ead7940df32dfbbc4e2a60.png" alt="Inheritance diagram of fullrmc.Constraints.ImproperAngleConstraints" usemap="#inheritance2ec5cb74e8" class="inheritance"/>
<map id="inheritance2ec5cb74e8" name="inheritance2ec5cb74e8">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="5,31,87,56"/>
<area shape="rect" id="node3" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="A rigid constraint is a constraint that doesn&#39;t count into the total squaredDeviations of the Engine." alt="" coords="143,5,254,31"/>
<area shape="rect" id="node4" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="A singular constraint is a constraint that doesn&#39;t allow multiple instances in the same engine." alt="" coords="135,55,263,80"/>
<area shape="rect" id="node2" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint" title="Its controls the improper angle between 4 defined atoms. It is mainly used to keep atoms in the plane." alt="" coords="311,31,475,56"/>
</map>
</p>
<dl class="class">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint">
<em class="property">class </em><tt class="descclassname">fullrmc.Constraints.ImproperAngleConstraints.</tt><tt class="descname">ImproperAngleConstraint</tt><big>(</big><em>engine</em>, <em>anglesMap=None</em>, <em>rejectProbability=1</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.RigidConstraint" title="fullrmc.Core.Constraint.RigidConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.RigidConstraint</span></tt></a>, <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.SingularConstraint" title="fullrmc.Core.Constraint.SingularConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.SingularConstraint</span></tt></a></p>
<p>Its controls the improper angle between 4 defined atoms. It is mainly used to keep atoms in the plane.
The improper angle is the defined between a first improper atom and the plane formed of the three other atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic">
<li><p class="first">engine (None, fullrmc.Engine): The constraint RMC engine.</p>
</li>
<li><dl class="first docutils">
<dt>anglesMap (list): The angles map definition.</dt>
<dd><p class="first">Every item must be a list of five items.</p>
<ol class="last arabic simple">
<li>First item: The improper atom index that must be in the plane.</li>
<li>Second item: The index of the atom &#8216;O&#8217; considered the origin of the plane.</li>
<li>Third item: The index of the atom &#8216;x&#8217; used to calculated &#8216;Ox&#8217; vector.</li>
<li>Fourth item: The index of the atom &#8216;y&#8217; used to calculated &#8216;Oy&#8217; vector.</li>
<li>Fifth item: The minimum lower limit or the minimum angle allowed in rad.</li>
<li>Sixth item: The maximum upper limit or the maximum angle allowed in rad.</li>
</ol>
</dd>
</dl>
</li>
<li><p class="first">rejectProbability (Number): rejecting probability of all steps where squaredDeviations increases. 
It must be between 0 and 1 where 1 means rejecting all steps where squaredDeviations increases
and 0 means accepting all steps regardless whether squaredDeviations increases or not.</p>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.accept_move">
<tt class="descname">accept_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.angles">
<tt class="descname">angles</tt><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get angles dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.anglesMap">
<tt class="descname">anglesMap</tt><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.anglesMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get angles map.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.atomsLUAD">
<tt class="descname">atomsLUAD</tt><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.atomsLUAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Get look up angles dictionary, connecting every atom&#8217;s index to a central atom angles definition of angles attribute.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_after_move">
<tt class="descname">compute_after_move</tt><big>(</big><em>indexes</em>, <em>movedBoxCoordinates</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_before_move">
<tt class="descname">compute_before_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_data">
<tt class="descname">compute_data</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_squared_deviations">
<tt class="descname">compute_squared_deviations</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.compute_squared_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the squared deviation of data not satisfying constraint conditions.</p>
<div class="math">
<p><img src="_images/math/3d9ee86fa78b31b38f9d6d4946554721724a8b84.png" alt="SD = \sum \limits_{i}^{C} 
( \theta_{i} - \theta_{i}^{min} ) ^{2} 
\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta
+
( \theta_{i} - \theta_{i}^{max} ) ^{2} 
\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta"/></p>
</div><p>Where:</p>
<p><img class="math" src="_images/math/2bcc65482aa8e15cd4c9e9f2542451fb4e971a91.png" alt="C"/> is the total number of defined improper angles constraints.</p>
<p><img class="math" src="_images/math/bde279daf7524455009b39a7741f8792f7a01b1d.png" alt="\theta_{i}^{min}"/> is the improper angle constraint lower limit set for constraint i.</p>
<p><img class="math" src="_images/math/0607887c23a5a929fc38e8c5da757f91cfc16017.png" alt="\theta_{i}^{max}"/> is the improper angle constraint upper limit set for constraint i.</p>
<p><img class="math" src="_images/math/208de4ca8bf1471b4286caaa7a4f0b132c947fb3.png" alt="\theta_{i}"/> is the improper angle computed for constraint i.</p>
<p><img class="math" src="_images/math/b35a9439ad8c8657b1b1d792ad5c2d77a52c0aef.png" alt="\delta"/> is the Dirac delta function.</p>
<p><img class="math" src="_images/math/9cf907cb8ae049fbfa35ff8062d4eac508fac782.png" alt="\int_{0}^{\theta_{i}^{min}} \delta(\theta-\theta_{i}) d \theta"/> 
is equal to 1 if <img class="math" src="_images/math/c2ed2d5d68171b4e8adc27069443c9af7650757f.png" alt="0 \leqslant \theta_{i} \leqslant \theta_{i}^{min}"/> and 0 elsewhere.</p>
<p><img class="math" src="_images/math/a2ddb32bbf75f8e61796659c5477437e6c9f5c33.png" alt="\int_{\theta_{i}^{max}}^{\pi} \delta(\theta-\theta_{i}) d \theta"/> 
is equal to 1 if <img class="math" src="_images/math/88c0f30ecb97403ce5beb84056dd7acb0b14cddc.png" alt="\theta_{i}^{max} \leqslant \theta_{i} \leqslant \pi"/> and 0 elsewhere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The constraint value data to compute squaredDeviations.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>squaredDeviations (number): The calculated squaredDeviations of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.create_angles_by_definition">
<tt class="descname">create_angles_by_definition</tt><big>(</big><em>anglesDefinition</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.create_angles_by_definition" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates anglesMap using angles definition.
Calls set_angles(anglesMap) and generates angles attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>anglesDefinition (dict): The angles definition. 
Every key must be a molecule name (residue name in pdb file). 
Every key value must be a list of angles definitions. 
Every angle definition is a list of five items where:<ol class="arabic">
<li>First item: The name of the improper atom that must be in the plane.</li>
<li>Second item: The name of the atom &#8216;O&#8217; considered the origin of the plane.</li>
<li>Third item: The name of the atom &#8216;x&#8217; used to calculated &#8216;Ox&#8217; vector.</li>
<li>Fourth item: The name of the atom &#8216;y&#8217; used to calculated &#8216;Oy&#8217; vector.</li>
<li>Fifth item: The minimum lower limit or the minimum angle allowed in degrees.</li>
<li>Sixth item: The maximum upper limit or the maximum angle allowed in degrees.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre>e.g. (Benzene):  anglesDefinition={&quot;BENZ&quot;: [(&#39;C3&#39;,&#39;C1&#39;,&#39;C2&#39;,&#39;C6&#39;, -10, 10),
                                            (&#39;C4&#39;,&#39;C1&#39;,&#39;C2&#39;,&#39;C6&#39;, -10, 10),
                                            (&#39;C5&#39;,&#39;C1&#39;,&#39;C2&#39;,&#39;C6&#39;, -10, 10) ] }
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.get_constraint_value">
<tt class="descname">get_constraint_value</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Mean Pair Distances (MPD) below the defined minimum distance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>MPD (dictionary): The MPD dictionary, where keys are the element wise intra and inter molecular MPDs and values are the computed MPDs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.listen">
<tt class="descname">listen</tt><big>(</big><em>message</em>, <em>argument=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.reject_move">
<tt class="descname">reject_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.set_angles">
<tt class="descname">set_angles</tt><big>(</big><em>anglesMap</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.set_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angles dictionary by parsing the anglesMap list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>anglesMap (list): The angles map definition.
Every item must be a list of five items.<ol class="arabic">
<li>First item: The improper atom index that must be in the plane.</li>
<li>Second item: The index of the atom &#8216;O&#8217; considered the origin of the plane.</li>
<li>Third item: The index of the atom &#8216;x&#8217; used to calculated &#8216;Ox&#8217; vector.</li>
<li>Fourth item: The index of the atom &#8216;y&#8217; used to calculated &#8216;Oy&#8217; vector.</li>
<li>Fifth item: The minimum lower limit or the minimum angle allowed in rad.</li>
<li>Sixth item: The maximum upper limit or the maximum angle allowed in rad.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.should_step_get_rejected">
<tt class="descname">should_step_get_rejected</tt><big>(</big><em>squaredDeviations</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.should_step_get_rejected" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloads &#8216;RigidConstraint&#8217; should_step_get_rejected method.
It computes whether to accept or reject a move based on before and after move calculation and not squaredDeviations.
If any of activeAtomsDataBeforeMove or activeAtomsDataAfterMove is None an Exception will get raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>squaredDeviations (number): not used in this case</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): True to reject step, False to accept</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.squaredDeviations">
<tt class="descname">squaredDeviations</tt><a class="headerlink" href="#fullrmc.Constraints.ImproperAngleConstraints.ImproperAngleConstraint.squaredDeviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Get constraint&#8217;s current squared deviation.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.PairCorrelationConstraints">
<span id="paircorrelationconstraints"></span><h2>PairCorrelationConstraints<a class="headerlink" href="#module-fullrmc.Constraints.PairCorrelationConstraints" title="Permalink to this headline">¶</a></h2>
<p>PairCorrelationConstraint contains classes for all constraints related experimental pair correlation functions.</p>
<p class="graphviz">
<img src="_images/inheritance-4644b332d55d6367c377632069e18ef2d53f3c45.png" alt="Inheritance diagram of fullrmc.Constraints.PairCorrelationConstraints" usemap="#inheritance225f361433" class="inheritance"/>
<map id="inheritance225f361433" name="inheritance225f361433">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="5,5,87,31"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" title="An ExperimentalConstraint is any constraint related to experimental data." alt="" coords="135,5,292,31"/>
<area shape="rect" id="node4" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" title="It controls the total pair distribution function (pdf) of the system noted as G(r). " alt="" coords="340,5,509,31"/>
<area shape="rect" id="node3" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint" title="It controls the total pair correlation function (pcf) of the system noted as g(r)." alt="" coords="557,5,724,31"/>
</map>
</p>
<dl class="class">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint">
<em class="property">class </em><tt class="descclassname">fullrmc.Constraints.PairCorrelationConstraints.</tt><tt class="descname">PairCorrelationConstraint</tt><big>(</big><em>engine</em>, <em>experimentalData</em>, <em>weighting='atomicNumber'</em>, <em>scaleFactor=1.0</em>, <em>windowFunction=None</em>, <em>limits=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" title="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint</span></tt></a></p>
<p>It controls the total pair correlation function (pcf) of the system noted as g(r).
The pair correlation function g(r) and pair distribution function G(r) are directly 
related as in the following <img class="math" src="_images/math/50c5f422da753e96fa75f4cffc802d60db98b3f2.png" alt="g(r)=1+(\frac{G(r)}{r})"/></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>engine (None, fullrmc.Engine): The constraint RMC engine.</li>
<li>experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</li>
<li>weighting (string): The elements weighting.</li>
<li>scaleFactor (string): A normalization scale factor used to normalize the computed data to the experimental ones.</li>
<li>windowFunction (None, numpy.ndarray): The window function to convolute with the computed pair distribution function
of the system prior to comparing it with the experimental data. In general, the experimental pair
distribution function G(r) shows artificial wrinkles, among others the main reason is because G(r) is computed
by applying a sine Fourier transform to the experimental structure factor S(q). Therefore window function is
used to best imitate the numerical artefacts in the experimental data.</li>
<li>limits (None, tuple, list): The distance limits to compute the histograms.
If None, the limits will be automatically set the the min and max distance recorded in the experimental data.
If not None, a tuple of exactly two items where the first is of minimum distance or None 
and the second is the maximum distance or None.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.check_experimental_data">
<tt class="descname">check_experimental_data</tt><big>(</big><em>experimentalData</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.check_experimental_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_after_move">
<tt class="descname">compute_after_move</tt><big>(</big><em>indexes</em>, <em>movedBoxCoordinates</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_before_move">
<tt class="descname">compute_before_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_data">
<tt class="descname">compute_data</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairCorrelationConstraints.PairCorrelationConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fullrmc.Constraints.PairDistributionConstraints">
<span id="pairdistributionconstraints"></span><h2>PairDistributionConstraints<a class="headerlink" href="#module-fullrmc.Constraints.PairDistributionConstraints" title="Permalink to this headline">¶</a></h2>
<p>PairDistributionConstraints contains classes for all constraints related experimental pair distribution functions.</p>
<p class="graphviz">
<img src="_images/inheritance-2ff2222f157f3504c336589cc2405200ebf0aa8a.png" alt="Inheritance diagram of fullrmc.Constraints.PairDistributionConstraints" usemap="#inheritance6fb2cdd31b" class="inheritance"/>
<map id="inheritance6fb2cdd31b" name="inheritance6fb2cdd31b">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Constraint.Constraint" title="A constraint is used to direct the evolution of the configuration towards the desired and most meaningful one." alt="" coords="5,5,87,31"/>
<area shape="rect" id="node2" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" title="An ExperimentalConstraint is any constraint related to experimental data." alt="" coords="135,5,292,31"/>
<area shape="rect" id="node3" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" title="It controls the total pair distribution function (pdf) of the system noted as G(r). " alt="" coords="340,5,509,31"/>
</map>
</p>
<dl class="class">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint">
<em class="property">class </em><tt class="descclassname">fullrmc.Constraints.PairDistributionConstraints.</tt><tt class="descname">PairDistributionConstraint</tt><big>(</big><em>engine</em>, <em>experimentalData</em>, <em>weighting='atomicNumber'</em>, <em>scaleFactor=1.0</em>, <em>windowFunction=None</em>, <em>limits=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fullrmc.Core.html#fullrmc.Core.Constraint.ExperimentalConstraint" title="fullrmc.Core.Constraint.ExperimentalConstraint"><tt class="xref py py-class docutils literal"><span class="pre">fullrmc.Core.Constraint.ExperimentalConstraint</span></tt></a></p>
<p>It controls the total pair distribution function (pdf) of the system noted as G(r). 
The pair distribution function is the directly calculated quantity from a powder diffraction
experiments. It is obtained from the experimentally determined total-scattering structure 
function S(Q), by a Sine Fourier transform. pdf tells the probability of finding 
atomic pairs separated by the real space distance r.
The mathematical definition of the G(r) is:</p>
<div class="math">
<p><img src="_images/math/bdebad9420b9cd265438895103cd32b994fd2b93.png" alt="G(r) = \frac{1}{\pi} \int_{0}^{\infty} Q [S(Q)-1]sin(Qr)dQ = 4 \pi [\rho(r) - \rho_{0}] 

G(r) = \frac{R(r)}{r} - 4 \pi r \rho_{0} 

R(r) = 4 \pi r^2 \rho(r) =\frac{1}{N} \sum \limits_{i}^{N} \sum \limits_{j \neq i}^{N} \frac{b_i b_j}{\langle b \rangle ^2} \delta ( r - r_{ij} )"/></p>
</div><p>Where:</p>
<p><img class="math" src="_images/math/7b1816c51f7d31275cd3ad400208fb7b3ce136a0.png" alt="Q"/> is the momentum transfer.</p>
<p><img class="math" src="_images/math/2ede365ad144ab396916ec60458da03860803078.png" alt="r"/> is the distance between two atoms.</p>
<p><img class="math" src="_images/math/3bf6612ed0f348b1de4d1d454612d74a0c9502f3.png" alt="\rho(r)"/> is the spherical average defined as <img class="math" src="_images/math/ca26f811e767fa1f6cdf22140539ff8cb9d55e5c.png" alt="\int n(r^{'}).n(r-r^{'}) dr"/>.</p>
<p><img class="math" src="_images/math/ed15f691d3f3c8cadde0d1b3df8b533bf40a4f83.png" alt="\rho_{0}"/> is the  average number density of the samples.</p>
<p><img class="math" src="_images/math/2afb3a5dd6b68b2d487f92dac2667b7b13fb7122.png" alt="R(r)"/> is the radial distribution function (rdf).</p>
<p><img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> is the total number of atoms.</p>
<p><img class="math" src="_images/math/5297a2c39c035905dc16f74a46fcb1b04743f8c5.png" alt="b_i"/> is the scattering length for atom i.</p>
<p><img class="math" src="_images/math/35bab58b40a77a2e24ecb9f58898f1813de64459.png" alt="r_{ij}"/> is the distance between atoms i and j.</p>
<p><img class="math" src="_images/math/e9cbc2b1fc662f26efdbd8a1bf32a806addee58e.png" alt="\langle b \rangle"/> is the average scattering length over all atoms</p>
<p><img class="math" src="_images/math/4eb5bf4923340e72f8623da2515fc38a1b184052.png" alt="\sum \limits_{j \neq i}^{N} \delta ( r - r_{ij} )"/> is the probability density 
of some atoms being r distant from each other.</p>
<p><strong>NB</strong>: pair distribution function G(r) and the pair correlation function g(r) are directly 
related as in the following <img class="math" src="_images/math/fb57218173f6c35c84bb51848ca2c0e9aa53fdf9.png" alt="G(r)=r(g(r)-1)"/></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>engine (None, fullrmc.Engine): The constraint RMC engine.</li>
<li>experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</li>
<li>weighting (string): The elements weighting.</li>
<li>scaleFactor (number): A normalization scale factor used to normalize the computed data to the experimental ones.</li>
<li>windowFunction (None, numpy.ndarray): The window function to convolute with the computed pair distribution function
of the system prior to comparing it with the experimental data. In general, the experimental pair
distribution function G(r) shows artificial wrinkles, among others the main reason is because G(r) is computed
by applying a sine Fourier transform to the experimental structure factor S(q). Therefore window function is
used to best imitate the numerical artefacts in the experimental data.</li>
<li>limits (None, tuple, list): The distance limits to compute the histograms.
If None, the limits will be automatically set the the min and max distance of the experimental data.
If not None, a tuple of exactly two items where the first is the minimum distance or None 
and the second is the maximum distance or None.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.accept_move">
<tt class="descname">accept_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.accept_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.bin">
<tt class="descname">bin</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances bin.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.check_experimental_data">
<tt class="descname">check_experimental_data</tt><big>(</big><em>experimentalData</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.check_experimental_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_after_move">
<tt class="descname">compute_after_move</tt><big>(</big><em>indexes</em>, <em>movedBoxCoordinates</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_after_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint after move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to.</li>
<li>movedBoxCoordinates (numpy.ndarray): The moved atoms new coordinates.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_and_set_squared_deviations">
<tt class="descname">compute_and_set_squared_deviations</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_and_set_squared_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes and sets the constraint&#8217;s squaredDeviations.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_before_move">
<tt class="descname">compute_before_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_before_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute constraint before move is executed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_data">
<tt class="descname">compute_data</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute data and update engine constraintsData dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_squared_deviations">
<tt class="descname">compute_squared_deviations</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.compute_squared_deviations" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the squared deviation between data and the experimental one.</p>
<div class="math">
<p><img src="_images/math/3144931b6c3bba42786cbddf6352db92ec295610.png" alt="SD = \sum \limits_{i}^{N} (Y(X_{i})-F(X_{i}))^{2}"/></p>
</div><p>Where:</p>
<p><img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> is the total number of experimental data points.</p>
<p><img class="math" src="_images/math/5f6090e8698bd077f6d1a356b318149c9f32b916.png" alt="Y(X_{i})"/> is the experimentation data point <img class="math" src="_images/math/2da327024eebb2840212e09881f755930856dbb4.png" alt="X_{i}"/>.</p>
<p><img class="math" src="_images/math/a7243988e8a55f9a798bb3f38b1de2294ecab23a.png" alt="F(X_{i})"/> is the computed from the model data  <img class="math" src="_images/math/2da327024eebb2840212e09881f755930856dbb4.png" alt="X_{i}"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>data (numpy.array): The data to compare with the experimental one and compute the squared deviation.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>squaredDeviations (number): The calculated squaredDeviations of the constraint.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.elementsPairs">
<tt class="descname">elementsPairs</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.elementsPairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements pairs</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.experimentalDistances">
<tt class="descname">experimentalDistances</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.experimentalDistances" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the experimental distances array</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.experimentalPDF">
<tt class="descname">experimentalPDF</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.experimentalPDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the experimental pdf</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.get_constraint_original_value">
<tt class="descname">get_constraint_original_value</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.get_constraint_original_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Pair Distribution Functions (PDFs).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>PDFs (dictionary): The PDFs dictionnary, where keys are the element wise intra and inter molecular PDFs and values are the computed PDFs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.get_constraint_value">
<tt class="descname">get_constraint_value</tt><big>(</big><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.get_constraint_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all partial Pair Distribution Functions (PDFs).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>PDFs (dictionary): The PDFs dictionnary, where keys are the element wise intra and inter molecular PDFs and values are the computed PDFs.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.histogramSize">
<tt class="descname">histogramSize</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.histogramSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the histogram size</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.limits">
<tt class="descname">limits</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.limits" title="Permalink to this definition">¶</a></dt>
<dd><p>The histogram computation limits.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.listen">
<tt class="descname">listen</tt><big>(</big><em>message</em>, <em>argument=None</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Listens to any message sent from the Broadcaster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>message (object): Any python object to send to constraint&#8217;s listen method.</li>
<li>argument (object): Any type of argument to pass to the listeners.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.maximumDistance">
<tt class="descname">maximumDistance</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.maximumDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances maximum.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.minimumDistance">
<tt class="descname">minimumDistance</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.minimumDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the experimental data distances minimum.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.reject_move">
<tt class="descname">reject_move</tt><big>(</big><em>indexes</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.reject_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject move</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>indexes (numpy.ndarray): Group atoms indexes the move will be applied to</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.scaleFactor">
<tt class="descname">scaleFactor</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.scaleFactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the scaleFactor.</p>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_experimental_data">
<tt class="descname">set_experimental_data</tt><big>(</big><em>experimentalData</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_experimental_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the constraint&#8217;s experimental data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>experimentalData (numpy.ndarray, string): The experimental data as numpy.ndarray or string path to load data using numpy.loadtxt.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_limits">
<tt class="descname">set_limits</tt><big>(</big><em>limits</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the histogram computation limits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>limits (None, tuple, list): The distance limits to compute the histograms and compute with the experimental data.
If None, the limits will be automatically set the the min and max distance recorded in the experimental data.
If not None, a tuple of minimum distance or None and maximum distance or None should be given.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_scale_factor">
<tt class="descname">set_scale_factor</tt><big>(</big><em>scaleFactor</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_scale_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the scale factor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>scaleFactor (string): A normalization scale factor used to normalize the computed data to the experimental ones.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_weighting">
<tt class="descname">set_weighting</tt><big>(</big><em>weighting</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_weighting" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets elements weighting. It must a valid entry of pdbParser atoms database</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>weighting (string): The elements weighting.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_window_function">
<tt class="descname">set_window_function</tt><big>(</big><em>windowFunction</em><big>)</big><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.set_window_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the window function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>windowFunction (None, numpy.ndarray): The window function to convolute with the computed pair distribution function
of the system prior to comparing it with the experimental data. In general, the experimental pair
distribution function G(r) shows artificial wrinkles, among others the main reason is because G(r) is computed
by applying a sine Fourier transform to the experimental structure factor S(q). Therefore window function is
used to best imitate the numerical artefacts in the experimental data.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shellsCenter">
<tt class="descname">shellsCenter</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shellsCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the shells center array</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shellsVolumes">
<tt class="descname">shellsVolumes</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.shellsVolumes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the shells volume array</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.weightingScheme">
<tt class="descname">weightingScheme</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.weightingScheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elements weighting scheme.</p>
</dd></dl>

<dl class="attribute">
<dt id="fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.windowFunction">
<tt class="descname">windowFunction</tt><a class="headerlink" href="#fullrmc.Constraints.PairDistributionConstraints.PairDistributionConstraint.windowFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the window function.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fullrmc.Generators.html" title="fullrmc.Generators package"
             >previous</a> |</li>
        <li><a href="index.html">fullrmc, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Bachir Aoun.
    </div>
  </body>
</html>