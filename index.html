<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fullrmc package &mdash; fullrmc 0.2.0, the Reverse Monte Carlo (RMC) package</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="fullrmc 0.2.0, the Reverse Monte Carlo (RMC) package" href="#" />
    <link rel="next" title="fullrmc.Core package" href="fullrmc.Core.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fullrmc.Core.html" title="fullrmc.Core package"
             accesskey="N">next</a> |</li>
        <li><a href="#">fullrmc 0.2.0, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">fullrmc package</a><ul>
<li><a class="reference internal" href="#inheritance-diagram">Inheritance diagram</a></li>
<li><a class="reference internal" href="#welcoming-videos">Welcoming videos</a></li>
<li><a class="reference internal" href="#brief-description">Brief Description</a></li>
<li><a class="reference internal" href="#tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point">Tetrahydrofuran simple example yet complete and straight to the point</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#sub-packages">Sub-packages</a></li>
<li><a class="reference internal" href="#sub-modules">Sub-modules</a></li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="fullrmc.Core.html"
                        title="next chapter">fullrmc.Core package</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-fullrmc">
<span id="fullrmc-package"></span><h1>fullrmc package<a class="headerlink" href="#module-fullrmc" title="Permalink to this headline">¶</a></h1>
<div class="section" id="inheritance-diagram">
<h2>Inheritance diagram<a class="headerlink" href="#inheritance-diagram" title="Permalink to this headline">¶</a></h2>
<p class="graphviz">
<img src="_images/inheritance-e6f0f32b5bb7b773416ad01bd220d093ddc457ee.png" alt="Inheritance diagram of fullrmc.Core.Group.Group" usemap="#inheritance3e1520e3a6" class="inheritance"/>
<map id="inheritance3e1520e3a6" name="inheritance3e1520e3a6">
<area shape="rect" id="node1" href="fullrmc.Core.html#fullrmc.Core.Group.Group" title="A Group is a set of atoms indexes container. " alt="" coords="5,5,175,31"/>
</map>
</p>
</div>
<div class="section" id="welcoming-videos">
<h2>Welcoming videos<a class="headerlink" href="#welcoming-videos" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="57%" />
<col width="43%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last"><iframe width="580" height="315"
src="https://www.youtube.com/embed/untepXVc3BQ"
frameborder="0" allowfullscreen>
</iframe></div></td>
<td>Molecular system full RMC
simulation. Groups are set to
molecules and smart moves are
applied. Translations along
symmetry axes, rotations
about symmetry axes, etc.</td>
</tr>
<tr class="row-even"><td><div class="first last"><iframe width="580" height="315"
src="https://www.youtube.com/embed/yTnCAw1DK3Q?rel=0"
frameborder="0" allowfullscreen>
</iframe></div></td>
<td>Atomic binary Nickel-Titanium shape memory
alloy system phase transformation RMC
simulation. Random atomic translations are
enough to reproduce short range ordering. But
swapping atoms is necessary to fit long range
atomic correlations.</td>
</tr>
<tr class="row-odd"><td><div class="first last"><iframe width="580" height="315"
src="https://www.youtube.com/embed/xnG0wnEfbJ8"
frameborder="0" allowfullscreen>
</iframe></div></td>
<td>Molecular system mere atomic
RMC simulation. Covalent bond
electron density polarization
is modelled by allowing
fullrmc to explore across
energy low correlation
barriers.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="brief-description">
<h2>Brief Description<a class="headerlink" href="#brief-description" title="Permalink to this headline">¶</a></h2>
<p>Reverse Monte Carlo (RMC) is probably best known for its applications in condensed matter physics and solid state chemistry.
fullrmc (<a class="reference external" href="https://github.com/bachiraoun/fullrmc">https://github.com/bachiraoun/fullrmc</a>) is a RMC modelling package to solve an inverse problem whereby an atomic/molecular 
model is adjusted until its atoms position have the greatest consistency with a set of experimental data.</p>
<p>fullrmc is a python package with its core and calculation modules optimized and compiled in Cython. 
fullrmc is not a standard RMC package but it is rather unique in its approach to solving an atomic or molecular structure. 
fullrmc&#8217;s Engine sub-module is the main module that contains the definition of &#8216;Engine&#8217; which 
is the main and only class used to launch an RMC calculation. Engine reads only Protein Data Bank formatted 
atomic configuration files &#8216;.pdb&#8217; (<a class="reference external" href="http://deposit.rcsb.org/adit/docs/pdb_atom_format.html">http://deposit.rcsb.org/adit/docs/pdb_atom_format.html</a>) and handles  
other definitions and attributes such as:</p>
<blockquote>
<div><ol class="arabic simple">
<li><strong>Group</strong>: Engine doesn&#8217;t understand atoms or molecules but group of atom indexes instead. 
A group is a set of atom indexes, allowing no indexes redundancy 
within the same group definition. A Group instance can contain any set of indexes and as many atom indexes as needed. 
Grouping atoms is essential to make clusters of atoms (residues, molecules, etc) evolve and move together. A group of 
a single atom index can be used to make a single atom move separately from the others. Engine&#8217;s &#8216;groups&#8217; attribute 
is a simple list of group instances containing all the desired and defined groups that one wants to move.</li>
<li><strong>Group selector</strong>: Engine requires a GroupSelector instance which is the artist that selects a group from the engine&#8217;s
groups list at every engine runtime step. Among other properties, depending on which group selector is used by the
engine, a GroupSelector can allow weighting which means selecting groups more or less frequently than the others, 
it can also allow selection recurrence and refinement of a single group, ordered and random selection is also possible.</li>
<li><strong>Move generator</strong>: Every group instance has its own MoveGenerator. Therefore every group of atoms when selected by 
the engine&#8217;s group selector at the engine&#8217;s runtime can perform a customizable and different kind of moves.</li>
<li><strong>Constraint</strong>: A constraint is a rule that controls certain aspect of the configuration upon moving groups. 
Engine&#8217;s &#8216;constraints&#8217; attribute is a list of all defined and used constraint instances, it is 
the judge that controls the evolution of the system by accepting or rejecting the move of a group. 
If engine&#8217;s constraints list is empty and contains no constraint definition, this will result
in accepting all the generated moves.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point">
<h2>Tetrahydrofuran simple example yet complete and straight to the point<a class="headerlink" href="#tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Tetrahydrofuran (THF) molecule sketch</span>
<span class="c">## </span>
<span class="c">##              O</span>
<span class="c">##   H41      /   \      H11</span>
<span class="c">##      \  /         \  /</span>
<span class="c">## H42-- C4    THF    C1 --H12</span>
<span class="c">##        \  MOLECULE /</span>
<span class="c">##         \         /</span>
<span class="c">##   H31-- C3-------C2 --H21</span>
<span class="c">##        /         \</span>
<span class="c">##     H32            H22 </span>
<span class="c">##</span>

<span class="c">## imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.PairDistributionConstraints</span> <span class="kn">import</span> <span class="n">PairDistributionConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.DistanceConstraints</span> <span class="kn">import</span> <span class="n">InterMolecularDistanceConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.BondConstraints</span> <span class="kn">import</span> <span class="n">BondConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.AngleConstraints</span> <span class="kn">import</span> <span class="n">BondsAngleConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.ImproperAngleConstraints</span> <span class="kn">import</span> <span class="n">ImproperAngleConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Core.MoveGenerator</span> <span class="kn">import</span> <span class="n">MoveGeneratorCollector</span>
<span class="kn">from</span> <span class="nn">fullrmc.Generators.Translations</span> <span class="kn">import</span> <span class="n">TranslationGenerator</span><span class="p">,</span> <span class="n">TranslationAlongSymmetryAxisGenerator</span>
<span class="kn">from</span> <span class="nn">fullrmc.Generators.Rotations</span> <span class="kn">import</span> <span class="n">RotationGenerator</span><span class="p">,</span> <span class="n">RotationAboutSymmetryAxisGenerator</span>

<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ############################# DECLARE USEFUL VARIABLES ##############################   #</span>
<span class="n">experimentalDataPath</span> <span class="o">=</span> <span class="s">&quot;thf_pdf.exp&quot;</span>
<span class="n">structurePdbPath</span>     <span class="o">=</span> <span class="s">&quot;thf.pdb&quot;</span>
<span class="n">engineSavePath</span>       <span class="o">=</span> <span class="s">&quot;thf_engine.rmc&quot;</span>

<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ################################# CREATE RMC SYSTEM #################################   #</span>
<span class="c">## create and initialize engine</span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">pdb</span><span class="o">=</span><span class="n">structurePdbFile</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="c">## set structure boundary conditions</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_boundary_conditions</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">48.860</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mf">48.860</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">48.860</span><span class="p">]))</span>
<span class="c">## create and add pair distribution constraint to the engine</span>
<span class="n">PDF_CONSTRAINT</span> <span class="o">=</span> <span class="n">PairDistributionConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">experimentalData</span><span class="o">=</span><span class="n">experimentalDataPath</span><span class="p">,</span> <span class="n">weighting</span><span class="o">=</span><span class="s">&quot;atomicNumber&quot;</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">PDF_CONSTRAINT</span><span class="p">])</span>
<span class="c">## create and add intermolecular distances constraint to the engine</span>
<span class="n">EMD_CONSTRAINT</span> <span class="o">=</span> <span class="n">InterMolecularDistanceConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">EMD_CONSTRAINT</span><span class="p">])</span>
<span class="c">## create and add bonds constraint to the engine</span>
<span class="n">B_CONSTRAINT</span> <span class="o">=</span> <span class="n">BondConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">B_CONSTRAINT</span><span class="p">])</span>
<span class="n">B_CONSTRAINT</span><span class="o">.</span><span class="n">create_bonds_by_definition</span><span class="p">(</span> <span class="n">bondsDefinition</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s">&#39;O&#39;</span> <span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span> <span class="mf">1.20</span><span class="p">,</span> <span class="mf">1.70</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;O&#39;</span> <span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mf">1.20</span><span class="p">,</span> <span class="mf">1.70</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C3&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;H11&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;H12&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span><span class="s">&#39;H21&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span><span class="s">&#39;H22&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C3&#39;</span><span class="p">,</span><span class="s">&#39;H31&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s">&#39;C3&#39;</span><span class="p">,</span><span class="s">&#39;H32&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">,</span><span class="s">&#39;H41&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s">&#39;C4&#39;</span><span class="p">,</span><span class="s">&#39;H42&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">)]</span> <span class="p">})</span>
<span class="c">## create and add angles constraint to the engine</span>
<span class="n">BA_CONSTRAINT</span> <span class="o">=</span> <span class="n">BondsAngleConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">BA_CONSTRAINT</span><span class="p">])</span>
<span class="n">BA_CONSTRAINT</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">125</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">95</span> <span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">95</span> <span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
                                                                      <span class="c"># H-C-H angle</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H11&#39;</span><span class="p">,</span><span class="s">&#39;H12&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H21&#39;</span><span class="p">,</span><span class="s">&#39;H22&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H31&#39;</span><span class="p">,</span><span class="s">&#39;H32&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H41&#39;</span><span class="p">,</span><span class="s">&#39;H42&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                      <span class="c"># H-C-O angle</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H11&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H12&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H41&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H42&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>                                                                           
                                                                      <span class="c"># H-C-C</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H11&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H12&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H21&#39;</span><span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H21&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H22&#39;</span><span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H22&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H31&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H31&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H32&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H32&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H41&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H42&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span> <span class="p">]</span> <span class="p">})</span>
<span class="c">## create and add improper angles constraint to the engine keeping THF molecules&#39; atoms in the plane</span>
<span class="n">IA_CONSTRAINT</span> <span class="o">=</span> <span class="n">ImproperAngleConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">IA_CONSTRAINT</span><span class="p">])</span>
<span class="n">IA_CONSTRAINT</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="p">]</span> <span class="p">})</span>
<span class="c">## initialize constraints data</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">initialize_used_constraints</span><span class="p">()</span>
<span class="c">## Uncomment in order not to use a constraint in the next engine run</span>
<span class="c">#PDF_CONSTRAINT.set_used(False)</span>
<span class="c">#EMD_CONSTRAINT.set_used(False)</span>
<span class="c">#B_CONSTRAINT.set_used(False)</span>
<span class="c">#BA_CONSTRAINT.set_used(False)</span>
<span class="c">#IA_CONSTRAINT.set_used(False)</span>
<span class="c">## initialize constraints data</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">initialize_used_constraints</span><span class="p">()</span>

<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ################################# RUN RMC ON ATOMS ##################################   #</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numberOfSteps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">saveFrequency</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">savePath</span><span class="o">=</span><span class="n">engineSavePath</span><span class="p">)</span>

<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ############################### RUN RMC ON MOLECULES ################################   #</span>
<span class="c">## set groups as molecules instead of atoms</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">reset_groups_as_molecules</span><span class="p">()</span>  
<span class="c"># set moves generators to all groups to a collection of random translations and rotations</span>
<span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
    <span class="n">mg</span> <span class="o">=</span> <span class="n">MoveGeneratorCollector</span><span class="p">(</span><span class="n">collection</span><span class="o">=</span><span class="p">[</span><span class="n">TranslationGenerator</span><span class="p">(),</span><span class="n">RotationGenerator</span><span class="p">()],</span> <span class="n">randomize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">set_move_generator</span><span class="p">(</span> <span class="n">mg</span> <span class="p">)</span>
<span class="c">## Uncomment to use any of the following moves generators</span>
<span class="c">## Also other moves generators can be used to achieve a better fit for instance:</span>
<span class="c">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=0)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=1)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=2)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=0)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=1)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=2)) for g in ENGINE.groups]</span>
<span class="c">## Molecular constraints are not necessary any more because groups are set to molecules.</span>
<span class="c">## At every engine step a whole molecule is rotate or translated therefore its internal</span>
<span class="c">## distances and properties are safe from any changes. At any time constraints can be </span>
<span class="c">## turn on again using the same method with a True flag. e.g. B_CONSTRAINT.set_used(True)</span>
<span class="n">B_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">BA_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">IA_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="c">## run engine and perform RMC on molecules</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numberOfSteps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">saveFrequency</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">savePath</span><span class="o">=</span><span class="n">engineSavePath</span><span class="p">)</span>


<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ################################### PLOT TOTAL GR ###################################   #</span>
<span class="n">totalGR</span> <span class="o">=</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_constraint_value</span><span class="p">()[</span><span class="s">&quot;pdf_total&quot;</span><span class="p">]</span>
<span class="n">expData</span> <span class="o">=</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">experimentalPDF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">experimentalDistances</span><span class="p">,</span> <span class="n">expData</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;experimental&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shellsCenter</span><span class="p">,</span> <span class="n">totalGR</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>  <span class="n">markevery</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;total&quot;</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
<p>The result shown in the figures herein is obtained by running fullrmc Engine for several hours on molecular groups.
Position optimization is achieved by using a RecursiveGroupSelector to refine every selected group position
and alternating groups moves generators. RotationAboutSymmetryAxisGenerator is used to fit the ring orientation, 
then TranslationAlongSymmetryAxisGenerator is used to translate molecules along meaningful directions. 
At the end, groups a reset to single atom index and RandomSelector is used to select groups randomly.
the Engine is run for additional several hours to refine atoms positions separately.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/thfBox.png"><img alt="_images/thfBox.png" src="_images/thfBox.png" style="width: 300px; height: 200px;" /></a>
<p class="caption">a) Structure containing 800
Tetrahydrofuran randomly generated.</p>
</div>
</td>
<td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/beforeFit.png"><img alt="_images/beforeFit.png" src="_images/beforeFit.png" style="width: 300px; height: 200px;" /></a>
<p class="caption">b) Initial pair distribution function
calculated before any fitting.</p>
</div>
</td>
<td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/afterFit.png"><img alt="_images/afterFit.png" src="_images/afterFit.png" style="width: 300px; height: 200px;" /></a>
<p class="caption">c) pair distribution function
calculated after about 20 hours of
Engine runtime.</p>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>fullrmc requires:
#. Python (&gt;= 2.6 or &lt; 3),
#. NumPy (lower version tested is 1.7.1),
#. cython (lower version tested is 0.21.1),
#. matplotlib (lower version tested is 1.4),
#. pdbParser (lower version tested is 0.1.2),
#. pysimplelog (lower version tested is 0.1.7).</p>
<p><strong>Installation using pip:</strong></p>
<p>numpy and cython must be installed and updated manually.</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>pip install -U <span class="s2">&quot;numpy&gt;=1.7.1&quot;</span>
pip install -U <span class="s2">&quot;cython&gt;=0.21.1&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p>When you already have a working installation of numpy and cython.</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>pip install fullrmc
</pre></div>
</div>
</div></blockquote>
<p><strong>Installation by cloning github repository:</strong></p>
<blockquote>
<div><ul class="simple">
<li>Ensure all fullrmc required packages are installed.</li>
</ul>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="c"># check whether all packages are already installed</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="k">assert</span> <span class="n">numpy</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s">&#39;1.7.1&#39;</span><span class="p">,</span> <span class="s">&#39;numpy installation must be upgraded&#39;</span>
<span class="kn">import</span> <span class="nn">cython</span>
<span class="k">assert</span> <span class="n">cython</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s">&#39;0.21.1&#39;</span><span class="p">,</span> <span class="s">&#39;cython installation must be upgraded&#39;</span>
<span class="kn">import</span> <span class="nn">pdbParser</span>
<span class="k">assert</span> <span class="n">pdbParser</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s">&#39;0.1.2&#39;</span><span class="p">,</span> <span class="s">&#39;pdbParser installation must be upgraded&#39;</span>
<span class="kn">import</span> <span class="nn">pysimplelog</span>
<span class="k">assert</span> <span class="n">pysimplelog</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s">&#39;0.1.7&#39;</span><span class="p">,</span> <span class="s">&#39;pysimplelog installation must be upgraded&#39;</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="k">assert</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s">&#39;1.4&#39;</span><span class="p">,</span> <span class="s">&#39;matplotlib installation must be upgraded&#39;</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p class="first">Locate python&#8217;s site-packages using:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">site</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">__file__</span><span class="p">),</span> <span class="s">&#39;site_packages&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Navigate to site_packages folder and clone git repository:</p>
</li>
</ul>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>git clone https://github.com/bachiraoun/fullrmc.git   
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Compile fullrmc Extension files. Change directory to .../site_packages/fullrmc/Extensions:</li>
</ul>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>python setup.py build_ext --inplace 
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="sub-packages">
<h2>Sub-packages<a class="headerlink" href="#sub-packages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Core.html">fullrmc.Core package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Collection">Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Constraint">Constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Group">Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.GroupSelector">GroupSelector</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.MoveGenerator">MoveGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#angles">angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#bonds">bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#distances">distances</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#get-reciprocal-basis">get_reciprocal_basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#improper-angles">improper_angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#pair-distribution-histogram">pair_distribution_histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#atomic-coordination-number">atomic_coordination_number</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#transform-coordinates">transform_coordinates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Selectors.html">fullrmc.Selectors package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Selectors.html#module-fullrmc.Selectors.OrderedSelectors">OrderedSelectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Selectors.html#module-fullrmc.Selectors.RandomSelectors">RandomSelectors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Generators.html">fullrmc.Generators package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Rotations">Rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Translations">Translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Agitations">Agitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Swaps">Swap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Constraints.html">fullrmc.Constraints package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#angleconstraints">AngleConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#bondconstraints">BondConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#distanceconstraints">DistanceConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#improperangleconstraints">ImproperAngleConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#paircorrelationconstraints">PairCorrelationConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#pairdistributionconstraints">PairDistributionConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#coordinationnumberconstraints">CoordinationNumberConstraints</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="sub-modules">
<h2>Sub-modules<a class="headerlink" href="#sub-modules" title="Permalink to this headline">¶</a></h2>
<p>This module provides all the global types, variables and some general methods that fullrmc needs.</p>
<dl class="class">
<dt>
<em class="property">class </em><tt class="descclassname">fullrmc.Globals.</tt><tt class="descname">Logger</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">pysimplelog.SimpleLog.Logger</span></tt></p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fullrmc.Core.html" title="fullrmc.Core package"
             >next</a> |</li>
        <li><a href="#">fullrmc 0.2.0, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Bachir Aoun.
    </div>
  </body>
</html>