<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fullrmc package &mdash; fullrmc, the Reverse Monte Carlo (RMC) package</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="fullrmc, the Reverse Monte Carlo (RMC) package" href="#" />
    <link rel="next" title="fullrmc.Core package" href="fullrmc.Core.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fullrmc.Core.html" title="fullrmc.Core package"
             accesskey="N">next</a> |</li>
        <li><a href="#">fullrmc, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">fullrmc package</a><ul>
<li><a class="reference internal" href="#tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point">Tetrahydrofuran simple example yet complete and straight to the point</a></li>
<li><a class="reference internal" href="#sub-packages">Sub-packages</a></li>
<li><a class="reference internal" href="#sub-modules">Sub-modules</a></li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="fullrmc.Core.html"
                        title="next chapter">fullrmc.Core package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-fullrmc">
<span id="fullrmc-package"></span><h1>fullrmc package<a class="headerlink" href="#module-fullrmc" title="Permalink to this headline">¶</a></h1>
<p>Reverse Monte Carlo (RMC) is probably best known for its applications in condensed matter physics and solid state chemistry.
fullrmc (<a class="reference external" href="https://github.com/bachiraoun/fullrmc">https://github.com/bachiraoun/fullrmc</a>) is a RMC modelling package to solve an inverse problem whereby an atomic/molecular 
model is adjusted until its atoms position have the greatest consistency with a set of experimental data.</p>
<p>fullrmc is a python package with its core and calculation modules optimized and compiled in Cython. 
fullrmc is not a standard RMC package but it is rather unique in its approach to solving an atomic or molecular structure. 
fullrmc&#8217;s Engine sub-module is the main module that contains the definition of &#8216;Engine&#8217; which 
is the main and only class used to launch an RMC calculation. Engine reads only Protein Data Bank formatted 
atomic configuration files &#8216;.pdb&#8217; (<a class="reference external" href="http://deposit.rcsb.org/adit/docs/pdb_atom_format.html">http://deposit.rcsb.org/adit/docs/pdb_atom_format.html</a>) and handles  
other definitions and attributes such as:</p>
<blockquote>
<div><ol class="arabic simple">
<li><strong>Group</strong>: Engine doesn&#8217;t understand atoms or molecules but group of atom indexes instead. 
A group is a set of atom indexes, allowing no indexes redundancy 
within the same group definition. A Group instance can contain any set of indexes and as many atom indexes as needed. 
Grouping atoms is essential to make clusters of atoms (residues, molecules, etc) evolve and move together. A group of 
a single atom index can be used to make a single atom move separately from the others. Engine&#8217;s &#8216;groups&#8217; attribute 
is a simple list of group instances containing all the desired and defined groups that one wants to move.</li>
<li><strong>Group selector</strong>: Engine requires a GroupSelector instance which is the artist that selects a group from the engine&#8217;s
groups list at every engine runtime step. Among other properties, depending on which group selector is used by the
engine, a GroupSelector can allow weighting which means selecting groups more or less frequently than the others, 
it can also allow selection recurrence and refinement of a single group, ordered and random selection is also possible.</li>
<li><strong>Move generator</strong>: Every group instance has its own MoveGenerator. Therefore every group of atoms when selected by 
the engine&#8217;s group selector at the engine&#8217;s runtime can perform a customizable and different kind of moves.</li>
<li><strong>Constraint</strong>: A constraint is a rule that controls certain aspect of the configuration upon moving groups. 
Engine&#8217;s &#8216;constraints&#8217; attribute is a list of all defined and used constraint instances, it is 
the judge that controls the evolution of the system by accepting or rejecting the move of a group. 
If engine&#8217;s constraints list is empty and contains no constraint definition, this will result
in accepting all the generated moves.</li>
</ol>
</div></blockquote>
<div class="section" id="tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point">
<h2>Tetrahydrofuran simple example yet complete and straight to the point<a class="headerlink" href="#tetrahydrofuran-simple-example-yet-complete-and-straight-to-the-point" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## Tetrahydrofuran (THF) molecule sketch</span>
<span class="c">## </span>
<span class="c">##              O</span>
<span class="c">##   H41      /   \      H11</span>
<span class="c">##      \  /         \  /</span>
<span class="c">## H42-- C4    THF    C1 --H12</span>
<span class="c">##        \  MOLECULE /</span>
<span class="c">##         \         /</span>
<span class="c">##   H31-- C3-------C2 --H21</span>
<span class="c">##        /         \</span>
<span class="c">##     H32            H22 </span>
<span class="c">##</span>

<span class="c">## imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">fullrmc.Engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.PairDistributionConstraints</span> <span class="kn">import</span> <span class="n">PairDistributionConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.DistanceConstraints</span> <span class="kn">import</span> <span class="n">InterMolecularDistanceConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.BondConstraints</span> <span class="kn">import</span> <span class="n">BondConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.AngleConstraints</span> <span class="kn">import</span> <span class="n">BondsAngleConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Constraints.ImproperAngleConstraints</span> <span class="kn">import</span> <span class="n">ImproperAngleConstraint</span>
<span class="kn">from</span> <span class="nn">fullrmc.Core.MoveGenerator</span> <span class="kn">import</span> <span class="n">MoveGeneratorCollector</span>
<span class="kn">from</span> <span class="nn">fullrmc.Generators.Translations</span> <span class="kn">import</span> <span class="n">TranslationGenerator</span><span class="p">,</span> <span class="n">TranslationAlongSymmetryAxisGenerator</span>
<span class="kn">from</span> <span class="nn">fullrmc.Generators.Rotations</span> <span class="kn">import</span> <span class="n">RotationGenerator</span><span class="p">,</span> <span class="n">RotationAboutSymmetryAxisGenerator</span>

<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ############################# DECLARE USEFUL VARIABLES ##############################   #</span>
<span class="n">experimentalDataPath</span> <span class="o">=</span> <span class="s">&quot;thf_pdf.exp&quot;</span>
<span class="n">structurePdbPath</span>     <span class="o">=</span> <span class="s">&quot;thf.pdb&quot;</span>
<span class="n">engineSavePath</span>       <span class="o">=</span> <span class="s">&quot;thf_engine.rmc&quot;</span>

<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ################################# CREATE RMC SYSTEM #################################   #</span>
<span class="c">## create and initialize engine</span>
<span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">pdb</span><span class="o">=</span><span class="n">structurePdbFile</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="c">## set structure boundary conditions</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">set_boundary_conditions</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">48.860</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mf">48.860</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">48.860</span><span class="p">]))</span>
<span class="c">## create and add pair distribution constraint to the engine</span>
<span class="n">PDF_CONSTRAINT</span> <span class="o">=</span> <span class="n">PairDistributionConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">experimentalData</span><span class="o">=</span><span class="n">experimentalDataPath</span><span class="p">,</span> <span class="n">weighting</span><span class="o">=</span><span class="s">&quot;atomicNumber&quot;</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">PDF_CONSTRAINT</span><span class="p">])</span>
<span class="c">## create and add intermolecular distances constraint to the engine</span>
<span class="n">EMD_CONSTRAINT</span> <span class="o">=</span> <span class="n">InterMolecularDistanceConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">EMD_CONSTRAINT</span><span class="p">])</span>
<span class="c">## create and add bonds constraint to the engine</span>
<span class="n">B_CONSTRAINT</span> <span class="o">=</span> <span class="n">BondConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">B_CONSTRAINT</span><span class="p">])</span>
<span class="n">B_CONSTRAINT</span><span class="o">.</span><span class="n">create_bonds_by_definition</span><span class="p">(</span> <span class="n">bondsDefinition</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s">&#39;O&#39;</span> <span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span> <span class="mf">1.20</span><span class="p">,</span> <span class="mf">1.70</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;O&#39;</span> <span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mf">1.20</span><span class="p">,</span> <span class="mf">1.70</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C3&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;H11&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;H12&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span><span class="s">&#39;H21&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span><span class="s">&#39;H22&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C3&#39;</span><span class="p">,</span><span class="s">&#39;H31&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s">&#39;C3&#39;</span><span class="p">,</span><span class="s">&#39;H32&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),</span>
                                                                  <span class="p">(</span><span class="s">&#39;C4&#39;</span><span class="p">,</span><span class="s">&#39;H41&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">),(</span><span class="s">&#39;C4&#39;</span><span class="p">,</span><span class="s">&#39;H42&#39;</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">)]</span> <span class="p">})</span>
<span class="c">## create and add angles constraint to the engine</span>
<span class="n">BA_CONSTRAINT</span> <span class="o">=</span> <span class="n">BondsAngleConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">BA_CONSTRAINT</span><span class="p">])</span>
<span class="n">BA_CONSTRAINT</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">125</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">95</span> <span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">95</span> <span class="p">,</span> <span class="mi">115</span><span class="p">),</span>
                                                                      <span class="c"># H-C-H angle</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H11&#39;</span><span class="p">,</span><span class="s">&#39;H12&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H21&#39;</span><span class="p">,</span><span class="s">&#39;H22&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H31&#39;</span><span class="p">,</span><span class="s">&#39;H32&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H41&#39;</span><span class="p">,</span><span class="s">&#39;H42&#39;</span><span class="p">,</span> <span class="mi">98</span> <span class="p">,</span> <span class="mi">118</span><span class="p">),</span>
                                                                      <span class="c"># H-C-O angle</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H11&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H12&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H41&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H42&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>                                                                           
                                                                      <span class="c"># H-C-C</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H11&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span><span class="s">&#39;H12&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H21&#39;</span><span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H21&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H22&#39;</span><span class="p">,</span><span class="s">&#39;C1&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span><span class="s">&#39;H22&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H31&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H31&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H32&#39;</span><span class="p">,</span><span class="s">&#39;C2&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span><span class="s">&#39;H32&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H41&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C4&#39;</span> <span class="p">,</span><span class="s">&#39;H42&#39;</span><span class="p">,</span><span class="s">&#39;C3&#39;</span> <span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span> <span class="p">]</span> <span class="p">})</span>
<span class="c">## create and add improper angles constraint to the engine keeping THF molecules&#39; atoms in the plane</span>
<span class="n">IA_CONSTRAINT</span> <span class="o">=</span> <span class="n">ImproperAngleConstraint</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">([</span><span class="n">IA_CONSTRAINT</span><span class="p">])</span>
<span class="n">IA_CONSTRAINT</span><span class="o">.</span><span class="n">create_angles_by_definition</span><span class="p">(</span> <span class="n">anglesDefinition</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;THF&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
                                                                      <span class="p">(</span><span class="s">&#39;C3&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="s">&#39;C1&#39;</span><span class="p">,</span><span class="s">&#39;C4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="p">]</span> <span class="p">})</span>
<span class="c">## initialize constraints data</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">initialize_used_constraints</span><span class="p">()</span>
<span class="c">## Uncomment in order not to use a constraint in the next engine run</span>
<span class="c">#PDF_CONSTRAINT.set_used(False)</span>
<span class="c">#EMD_CONSTRAINT.set_used(False)</span>
<span class="c">#B_CONSTRAINT.set_used(False)</span>
<span class="c">#BA_CONSTRAINT.set_used(False)</span>
<span class="c">#IA_CONSTRAINT.set_used(False)</span>
<span class="c">## initialize constraints data</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">initialize_used_constraints</span><span class="p">()</span>

<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ################################# RUN RMC ON ATOMS ##################################   #</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numberOfSteps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">saveFrequency</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">savePath</span><span class="o">=</span><span class="n">engineSavePath</span><span class="p">)</span>

<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ############################### RUN RMC ON MOLECULES ################################   #</span>
<span class="c">## set groups as molecules instead of atoms</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">reset_groups_as_molecules</span><span class="p">()</span>  
<span class="c"># set moves generators to all groups to a collection of random translations and rotations</span>
<span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
    <span class="n">mg</span> <span class="o">=</span> <span class="n">MoveGeneratorCollector</span><span class="p">(</span><span class="n">collection</span><span class="o">=</span><span class="p">[</span><span class="n">TranslationGenerator</span><span class="p">(),</span><span class="n">RotationGenerator</span><span class="p">()],</span> <span class="n">randomize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">set_move_generator</span><span class="p">(</span> <span class="n">mg</span> <span class="p">)</span>
<span class="c">## Uncomment to use any of the following moves generators</span>
<span class="c">## Also other moves generators can be used to achieve a better fit for instance:</span>
<span class="c">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=0)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=1)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(TranslationAlongSymmetryAxisGenerator(axis=2)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=0)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=1)) for g in ENGINE.groups]</span>
<span class="c">#[g.set_move_generator(RotationAboutSymmetryAxisGenerator(axis=2)) for g in ENGINE.groups]</span>
<span class="c">## Molecular constraints are not necessary any more because groups are set to molecules.</span>
<span class="c">## At every engine step a whole molecule is rotate or translated therefore its internal</span>
<span class="c">## distances and properties are safe from any changes. At any time constraints can be </span>
<span class="c">## turn on again using the same method with a True flag. e.g. B_CONSTRAINT.set_used(True)</span>
<span class="n">B_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">BA_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">IA_CONSTRAINT</span><span class="o">.</span><span class="n">set_used</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="c">## run engine and perform RMC on molecules</span>
<span class="n">ENGINE</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numberOfSteps</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">saveFrequency</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">savePath</span><span class="o">=</span><span class="n">engineSavePath</span><span class="p">)</span>


<span class="c">#   #####################################################################################   #</span>
<span class="c">#   ################################### PLOT TOTAL GR ###################################   #</span>
<span class="n">totalGR</span> <span class="o">=</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_constraint_value</span><span class="p">()[</span><span class="s">&quot;pdf_total&quot;</span><span class="p">]</span>
<span class="n">expData</span> <span class="o">=</span> <span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">experimentalPDF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">experimentalDistances</span><span class="p">,</span> <span class="n">expData</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;experimental&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ENGINE</span><span class="o">.</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shellsCenter</span><span class="p">,</span> <span class="n">totalGR</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>  <span class="n">markevery</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;total&quot;</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
<p>The result shown in the figures herein is obtained by running fullrmc Engine for several hours on molecular groups.
Position optimization is achieved by using a RecursiveGroupSelector to refine every selected group position
and alternating groups moves generators. RotationAboutSymmetryAxisGenerator is used to fit the ring orientation, 
then TranslationAlongSymmetryAxisGenerator is used to translate molecules along meaningful directions. 
At the end, groups a reset to single atom index and RandomSelector is used to select groups randomly.
the Engine is run for additional several hours to refine atoms positions separately.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/thfBox.png"><img alt="_images/thfBox.png" src="_images/thfBox.png" style="width: 300px; height: 200px;" /></a>
<p class="caption">a) Structure containing 800
Tetrahydrofuran randomly generated.</p>
</div>
</td>
<td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/beforeFit.png"><img alt="_images/beforeFit.png" src="_images/beforeFit.png" style="width: 300px; height: 200px;" /></a>
<p class="caption">b) Initial pair distribution function
calculated before any fitting.</p>
</div>
</td>
<td><div class="first last figure align-left">
<a class="reference internal image-reference" href="_images/afterFit.png"><img alt="_images/afterFit.png" src="_images/afterFit.png" style="width: 300px; height: 200px;" /></a>
<p class="caption">c) pair distribution function
calculated after about 20 hours of
Engine runtime.</p>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sub-packages">
<h2>Sub-packages<a class="headerlink" href="#sub-packages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Core.html">fullrmc.Core package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Collection">Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Constraint">Constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.Group">Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.GroupSelector">GroupSelector</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.MoveGenerator">MoveGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.angles">angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.bonds">bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.distances">distances</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.get_reciprocal_basis">get_reciprocal_basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.improper_angles">improper_angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.pair_distribution_histogram">pair_distribution_histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Core.html#module-fullrmc.Core.transform_coordinates">transform_coordinates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Selectors.html">fullrmc.Selectors package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Selectors.html#module-fullrmc.Selectors.OrderedSelectors">OrderedSelectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Selectors.html#module-fullrmc.Selectors.RandomSelectors">RandomSelectors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Generators.html">fullrmc.Generators package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Rotations">Rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Translations">Translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Generators.html#module-fullrmc.Generators.Agitations">Agitations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fullrmc.Constraints.html">fullrmc.Constraints package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.AngleConstraints">AngleConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.BondConstraints">BondConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.DistanceConstraints">DistanceConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.ImproperAngleConstraints">ImproperAngleConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.PairCorrelationConstraints">PairCorrelationConstraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="fullrmc.Constraints.html#module-fullrmc.Constraints.PairDistributionConstraints">PairDistributionConstraints</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="sub-modules">
<h2>Sub-modules<a class="headerlink" href="#sub-modules" title="Permalink to this headline">¶</a></h2>
<p>Engine is the fullrmc main module. It contains &#8216;Engine&#8217; the main class of fullrmc which is the 
Reverse Monte Carlo artist. The engine class takes only Protein Data Bank formatted files &#8216;.pdb&#8217; 
(<a class="reference external" href="http://deposit.rcsb.org/adit/docs/pdb_atom_format.html">http://deposit.rcsb.org/adit/docs/pdb_atom_format.html</a>) as atomic/molecular input structure. 
It handles and fits simultaneously many experimental data while controlling the evolution of the 
system using user-defined molecular or atomistic constraints such as bond-length, bond-angles, 
inter-molecular-distances, etc.</p>
<dl class="class">
<dt>
<em class="property">class </em><tt class="descclassname">fullrmc.Engine.</tt><tt class="descname">Engine</tt><big>(</big><em>pdb</em>, <em>boundaryConditions=None</em>, <em>names=None</em>, <em>elements=None</em>, <em>moleculesIndexes=None</em>, <em>moleculesNames=None</em>, <em>groups=None</em>, <em>groupSelector=None</em>, <em>constraints=None</em>, <em>tolerance=0.0</em><big>)</big></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>The Reverse Monte Carlo (RMC) engine, used to launched an RMC simulation. 
It has the capability to use and fit simultaneously multiple sets of experimental data. 
One can also define other constraints such as distances, bonds length, angles and many others.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>pdb (pdbParser, string): The configuration pdb as a pdbParser instance or a path string to a pdb file.</li>
<li>boundaryConditions (None, InfiniteBoundaries, PeriodicBoundaries, numpy.ndarray, number): The configuration&#8217;s boundary conditions.
If None, boundaryConditions are set to InfiniteBoundaries with no periodic boundaries.
If numpy.ndarray is given, it must be pass-able to a PeriodicBoundaries. Normally any real numpy.ndarray of shape (1,), (3,1), (9,1), (3,3) is allowed.
If number is given, it&#8217;s like a numpy.ndarray of shape (1,), it is assumed as a cubic box of box length equal to number.</li>
<li>names (None, list): All pdb atoms names list. 
List length must be equal to the number of atoms in the pdbParser instance or pdb file.
If None names will be assigned automatically by parsing pdbParser instance.</li>
<li>elements (None, list): All pdb atoms elements list.
List length must be equal to the number of atoms in the pdbParser instance or pdb file.
If None elements will be assigned automatically by parsing pdbParser instance.</li>
<li>moleculesIndexes (None, list, numpy.ndarray): The molecules indexes list.
List length must be equal to the number of atoms in the pdbParser instance or pdb file.
If None moleculesIndexes will be assigned automatically by parsing pdbParser instance.</li>
<li>moleculesNames (None, list): The molecules names list. 
List length must be equal to the number of atoms in the pdbParser instance or pdb file.
If None, it is automatically generated as the pdb residues name.</li>
<li>groups (None, list): list of groups, where every group must be a numpy.ndarray of atoms indexes of type numpy.int32.
If None, single atom groups of all atoms will be all automatically created.</li>
<li>groupSelector (None, GroupSelector): The GroupSelector instance. 
If None, RandomGroupSelector is set automatically.</li>
<li>constraints (None, list): The list of constraints instances.</li>
<li>tolerance (number): The runtime tolerance parameters. 
It&#8217;s the percentage of allowed unsatisfactory &#8216;tried&#8217; moves.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<tt class="descname">accepted</tt></dt>
<dd><p>Get number of accepted moves.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">add_constraints</tt><big>(</big><em>constraints</em><big>)</big></dt>
<dd><p>Add constraints to the engine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>constraints (Constraint, list, set, tuple): A constraint instance or list of constraints instances</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">add_group</tt><big>(</big><em>g</em>, <em>broadcast=True</em><big>)</big></dt>
<dd><p>Add group to engine groups list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>g (Group, numpy.ndattay): Group instance or a numpy.ndarray of atoms indexes of type numpy.int32.</li>
<li>broadcast (boolean): Whether to broadcast &#8220;update groups&#8221;. Keep True unless you know what you are doing.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">allElements</tt></dt>
<dd><p>Get all atoms elements.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">allNames</tt></dt>
<dd><p>Get all atoms names.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">basisVectors</tt></dt>
<dd><p>Get the basis vectors in case of PeriodicBoundaries or None in case of InfiniteBoundaries.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">boundaryConditions</tt></dt>
<dd><p>Get boundaryConditions instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">boxCoordinates</tt></dt>
<dd><p>Get the box coordinates of the current configuration or None in case of InfiniteBoundaries..</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">chiSquare</tt></dt>
<dd><p>Get the last recorded chiSquare of the current configuration.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">clear_groups</tt><big>(</big><big>)</big></dt>
<dd><p>Clear all engine defined groups</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">compute_chi_square</tt><big>(</big><em>constraints</em>, <em>current=True</em><big>)</big></dt>
<dd><p>Computes the total chiSquare of the given constraints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>constraints (list): All constraints used to calculate total chiSquare.</li>
<li>current (bool): If True it uses constraints chiSquare argument, 
False it uses constraint&#8217;s afterMoveChiSquare argument.</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>totalChiSquare (list): The computed total chiSquare.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">constraints</tt></dt>
<dd><p>Get a list copy of all constraints instances.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">elements</tt></dt>
<dd><p>Get the defined elements set.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">elementsIndexes</tt></dt>
<dd><p>Get the defined elements indexes list.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">export_pdb</tt><big>(</big><em>path</em><big>)</big></dt>
<dd><p>Export a pdb file for the last configuration state</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>path (string): the pdb file path.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">generated</tt></dt>
<dd><p>Get number of generated moves.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">get_used_constraints</tt><big>(</big><big>)</big></dt>
<dd><p>Parses all engine constraints and returns different lists of the active ones.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>usedConstraints (list): All types of active constraints that will be used in engine runtime.</li>
<li>constraints (list): All active constraints instances among usedConstraints list that will contribute to the engine total chiSquare</li>
<li>EnhanceOnlyConstraint (list): All active EnhanceOnlyConstraint constraints instances among usedConstraints list that won&#8217;t contribute to the engine total chiSquare</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">groupSelector</tt></dt>
<dd><p>Get the group selector instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">groups</tt></dt>
<dd><p>Get engine&#8217;s defined groups.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">initialize_used_constraints</tt><big>(</big><big>)</big></dt>
<dd><p>Calls get_used_constraints method, re-initializes constraints when needed and return them all.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>usedConstraints (list): All types of active constraints that will be used in engine runtime.</li>
<li>constraints (list): All active constraints instances among usedConstraints list that will contribute to the engine total chiSquare</li>
<li>EnhanceOnlyConstraint (list): All active EnhanceOnlyConstraint constraints instances among usedConstraints list that won&#8217;t contribute to the engine total chiSquare</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">lastMovedAtomsIndexes</tt></dt>
<dd><p>Get the last moved atoms indexes.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">lastMovedGroup</tt></dt>
<dd><p>Get the last moved group instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">lastMovedGroupIndex</tt></dt>
<dd><p>Get the last moved group instance index in groups list.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">load</tt><big>(</big><em>path</em><big>)</big></dt>
<dd><p>Load and return engine instance. None of the current engine attribute will be updated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first arabic simple">
<li>path (string): the file path to save the engine</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ol class="first last arabic simple">
<li>engine (Engine): the engine instance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">moleculesIndexes</tt></dt>
<dd><p>Get all atoms molecules indexes.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">moleculesNames</tt></dt>
<dd><p>Get all atoms molecules names.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">names</tt></dt>
<dd><p>Get the defined atom names set.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">namesIndexes</tt></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">numberOfAtomsPerElement</tt></dt>
<dd><p>Get the number of atoms per element dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">numberOfAtomsPerName</tt></dt>
<dd><p>Get the number of atoms per name dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">numberOfElements</tt></dt>
<dd><p>Get the number of defined elements in the configuration.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">numberOfMolecules</tt></dt>
<dd><p>Get the defined number of molecules.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">numberOfNames</tt></dt>
<dd><p>Get the number of defined atom names set.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">pdb</tt></dt>
<dd><p>Get pdbParser instance.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">realCoordinates</tt></dt>
<dd><p>Get the real coordinates of the current configuration.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">reciprocalBasisVectors</tt></dt>
<dd><p>Get the basis vectors in case of PeriodicBoundaries or None in case of InfiniteBoundaries.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">remove_constraints</tt><big>(</big><em>constraints</em><big>)</big></dt>
<dd><p>Remove constraints from engine list of constraints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>constraints (Constraint, list, set, tuple): A constraint instance or list of constraints instances</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">reset_constraints</tt><big>(</big><big>)</big></dt>
<dd><p>Reset constraints flags.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">reset_engine</tt><big>(</big><big>)</big></dt>
<dd><p>Re-initialize engine and resets constraints flags and data.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">run</tt><big>(</big><em>numberOfSteps=100000</em>, <em>saveFrequency=1000</em>, <em>savePath='restart'</em><big>)</big></dt>
<dd><p>Run the Reverse Monte Carlo engine by performing random moves on engine groups.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>numberOfSteps (integer): The number of steps to run.</li>
<li>saveFrequency (integer): Save engine every saveFrequency steps.</li>
<li>savePath (string): Save engine file path.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">save</tt><big>(</big><em>path</em><big>)</big></dt>
<dd><p>Save engine to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>path (string): the file path to save the engine</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_boundary_conditions</tt><big>(</big><em>boundaryConditions</em><big>)</big></dt>
<dd><p>Sets the configuration boundary conditions. Any type of periodic boundary conditions are allowed and not restricted to cubic.
Engine and constraintsData will be automatically reset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>boundaryConditions (None, InfiniteBoundaries, PeriodicBoundaries, numpy.ndarray, number): The configuration&#8217;s boundary conditions.
If None, boundaryConditions are set to InfiniteBoundaries with no periodic boundaries.
If numpy.ndarray is given, it must be pass-able to a PeriodicBoundaries. Normally any real numpy.ndarray of shape (1,), (3,1), (9,1), (3,3) is allowed.
If number is given, it&#8217;s like a numpy.ndarray of shape (1,), it is assumed as a cubic box of box length equal to number.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_elements_indexes</tt><big>(</big><em>elements=None</em><big>)</big></dt>
<dd><p>Sets elements list, assigning a type element to each atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>elements (None, list): All pdb atoms elements list.
If None elements will be calculated automatically by parsing pdb instance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_group_selector</tt><big>(</big><em>selector</em><big>)</big></dt>
<dd><p>Sets the engine group selector instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>groups (None, GroupSelector): the GroupSelector instance. 
If None, RandomSelector is set automatically.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_groups</tt><big>(</big><em>groups</em><big>)</big></dt>
<dd><p>Sets the engine groups of indexes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>groups (None, list): list of groups, where every group must be a Group instance or a numpy.ndarray of atoms indexes of type numpy.int32.
If None, single atom groups of all atoms will be all automatically created.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_groups_as_molecules</tt><big>(</big><big>)</big></dt>
<dd><p>Automatically set engine groups indexes according to molecules indexes.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_molecules_indexes</tt><big>(</big><em>moleculesIndexes=None</em>, <em>moleculesNames=None</em><big>)</big></dt>
<dd><p>Sets moleculesIndexes list, assigning each atom to a molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>moleculesIndexes (None, list, numpy.ndarray): The molecules indexes list.
If None moleculesIndexes will be calculated automatically by parsing pdb instance.</li>
<li>moleculesNames (None, list): The molecules names list. Must have the length of the number of atoms.
If None, it is automatically generated as the pdb residues name.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_names_indexes</tt><big>(</big><em>names=None</em><big>)</big></dt>
<dd><p>Sets names list, assigning a name to each atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>names (None, list): The names indexes list.
If None names will be generated automatically by parsing pdbParser instance.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_pdb</tt><big>(</big><em>pdb</em>, <em>boundaryConditions=None</em>, <em>names=None</em>, <em>elements=None</em>, <em>moleculesIndexes=None</em>, <em>moleculesNames=None</em><big>)</big></dt>
<dd><p>Sets the configuration pdb. Engine and constraintsData will be automatically reset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>pdb (pdbParser, string): the configuration pdb as a pdbParser instance or a path string to a pdb file.</li>
<li>boundaryConditions (None, InfiniteBoundaries, PeriodicBoundaries, numpy.ndarray, number): The configuration&#8217;s boundary conditions.
If None, boundaryConditions are set to InfiniteBoundaries with no periodic boundaries.
If numpy.ndarray is given, it must be pass-able to a PeriodicBoundaries. Normally any real numpy.ndarray of shape (1,), (3,1), (9,1), (3,3) is allowed.
If number is given, it&#8217;s like a numpy.ndarray of shape (1,), it is assumed as a cubic box of box length equal to number.</li>
<li>names (None, list): All pdb atoms names list.
If None names will be calculated automatically by parsing pdb instance.</li>
<li>elements (None, list): All pdb atoms elements list.
If None elements will be calculated automatically by parsing pdb instance.</li>
<li>moleculesIndexes (None, list, numpy.ndarray): The molecules indexes list.
If None moleculesIndexes will be calculated automatically by parsing pdb instance.</li>
<li>moleculesNames (None, list): The molecules names list. Must have the length of the number of atoms.
If None, it is automatically generated as the pdb residues name.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">set_tolerance</tt><big>(</big><em>tolerance</em><big>)</big></dt>
<dd><p>Sets the runtime engine tolerance value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>tolerance (number): The runtime tolerance parameters. 
It&#8217;s the percentage of allowed unsatisfactory &#8216;tried&#8217; moves.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">state</tt></dt>
<dd><p>Get engine&#8217;s state.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">tolerance</tt></dt>
<dd><p>Get the tolerance in percent.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">tolerated</tt></dt>
<dd><p>Get the number of tolerated steps in spite of increasing total chiSquare</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">tried</tt></dt>
<dd><p>Get number of tried moves.</p>
</dd></dl>

<dl class="method">
<dt>
<tt class="descname">visualize</tt><big>(</big><big>)</big></dt>
<dd><p>Visualize the last configuration using pdbParser visualize method.</p>
</dd></dl>

<dl class="attribute">
<dt>
<tt class="descname">volume</tt></dt>
<dd><p>Get basis volume or None in case of InfiniteBoundaries.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">fullrmc.Engine.</tt><tt class="descname">generate_random_float</tt><big>(</big><big>)</big></dt>
<dd><p>random() -&gt; x in the interval [0, 1).</p>
</dd></dl>

<p>This module provides all the global types, variables and some general methods that fullrmc needs.</p>
<dl class="function">
<dt>
<tt class="descclassname">fullrmc.Globals.</tt><tt class="descname">generate_random_float</tt><big>(</big><big>)</big></dt>
<dd><p>random() -&gt; x in the interval [0, 1).</p>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><tt class="descclassname">fullrmc.log.</tt><tt class="descname">ColorFormatter</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">logging.Formatter</span></tt></p>
<dl class="method">
<dt>
<tt class="descname">format</tt><big>(</big><em>record</em><big>)</big></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><tt class="descclassname">fullrmc.log.</tt><tt class="descname">LocalLogger</tt><big>(</big><em>name=None</em>, <em>config_file=None</em><big>)</big></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>fullrmc logger with different levels of logging. 
A single instance of the logger is initialized when the module is imported for the first time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Levels:</th><td class="field-body"><ol class="first arabic simple">
<li>information: Must be used to log some useful information</li>
<li>warning: Must be used to log some useful warnings</li>
<li>debugging: Must be used to log for debugging purposes only</li>
<li>critical: Must be used to log some critical behaviour</li>
<li>error: Must be used to log errors</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Usage:</th><td class="field-body"><ol class="first last arabic simple">
<li>information: LocalLogger().logger.info(&#8220;some message&#8221;)</li>
<li>warning: LocalLogger().logger.warn(&#8220;some message&#8221;)</li>
<li>debugging: LocalLogger().logger.debug(&#8220;some message&#8221;)</li>
<li>critical: LocalLogger().logger.critical(&#8220;some message&#8221;)</li>
<li>error: LocalLogger().logger.error(&#8220;some message&#8221;)</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fullrmc.Core.html" title="fullrmc.Core package"
             >next</a> |</li>
        <li><a href="#">fullrmc, the Reverse Monte Carlo (RMC) package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Bachir Aoun.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>