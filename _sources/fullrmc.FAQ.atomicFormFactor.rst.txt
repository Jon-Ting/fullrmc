:orphan:

Atomic form factor 
==================
Atomic form factor :math:`f(Q)` is a measure of the scattering amplitude of a wave 
by an isolated atom. In the spherical symmetry approximation assumption of an atom,
the form factor is computed as the following

.. math::
    
    f(Q) = \int \rho(r) e^{iQr} d^{3}r`.
      
In particular, scattering of x-rays by an atom is calculated by considering scattering 
from the electron charge density of the atom :math:`\rho(r)`, in units of the electron 
charge. Also, the majority of x-rays scattering occurs in a material through interaction
with tightly bound core electrons. Itinerant electrons contribute weakly to the scattering 
of x-rays, as the atomic form factor decays rapidly with increasing :math:`|Q|`.       

Implementation
==============
It's very computationally expensive to compute Q dependent scattering form factors. 
For practical reasons, when computing scattering functions in fullrmc, atoms are 
considered as hard spheres of point charges. Atomic form factor is considered Q 
independent equal to atoms atomic Z number where :math:`Z=f^{0}(Q=0)`. 

At a first glance, it might seem like a terrible idea not to compute form factors 
explicitly. But actually for the same atomic configuration, calculating x-ray scattering 
functions using hard sphere point charge atom approximation performs equally good and 
sometimes better than when using atomic form factor approximation. Keep in mind that 
both approaches are approximations and atomic form factor model is built for isolated 
atoms. In reality we never collect data of isolated atoms but for atoms in a material. 
In addition, when modelling real space data such as :class:`.PairDistributionConstraint` 
or :class:`.PairCorrelationConstraint` the equivalent reciprocal Q space explored is 
close to Q=0 and therefore form factor approximation compares in results to hard spheres 
atoms one with point charge.
      

    
    
    
    

 